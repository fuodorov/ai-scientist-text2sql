SELECT      COUNT(CASE WHEN Currency='EUR' THEN 1 END) * 1.0 /     COUNT(CASE WHEN Currency='CZK' THEN 1 END) AS Ratio_EUR_to_CZK FROM customers;
SELECT      c.CustomerID, y.Consumption FROM      customers AS c JOIN      yearmonth AS y ON c.CustomerID = y.CustomerID WHERE      c.Segment = 'LAM' AND SUBSTR(y.Date, 1, 4) BETWEEN '2012' AND '2012' ORDER BY      y.Consumption ASC LIMIT 1;
SELECT      AVG(Consumption) AS avg_monthly_consumption FROM      yearmonth WHERE      CustomerID IN (         SELECT CustomerID          FROM customers          WHERE Segment='SME'     ) AND SUBSTR(Date, 1, 4)='2013';
SELECT      SUM(CASE WHEN c.Currency='CZK' THEN y.Consumption ELSE 0 END) AS CZK_consumption,     SUM(CASE WHEN c.Currency='EUR' THEN y.Consumption ELSE 0 END) AS EUR_consumption,     SUM(CASE WHEN c.Currency='CZK' THEN y.Consumption ELSE 0 END) -     SUM(CASE WHEN c.Currency='EUR' THEN y.Consumption ELSE 0 END) AS Consumption_difference FROM      yearmonth y JOIN      customers c ON y.CustomerID=c.CustomerID WHERE      SUBSTR(y.Date, 1, 4)='2012';
SELECT      SUBSTR(Date, 1, 4) AS Year,     SUM(Consumption) AS TotalConsumption FROM      yearmonth GROUP BY      SUBSTR(Date, 1, 4) ORDER BY      TotalConsumption DESC LIMIT 1;
SELECT      SUBSTR(Date, 5, 2) AS Month,     SUM(Consumption) AS TotalConsumption FROM      yearmonth WHERE      CustomerID IN (         SELECT CustomerID          FROM customers          WHERE Segment='SME'     ) AND      SUBSTR(Date, 1, 4)='2013'
WITH
WITH  segment_consumptions AS (     SELECT          c.Segment,         SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2012' THEN ym.Consumption ELSE 0 END) AS consumption_2012,         SUM(CASE WHEN SUBSTR(ym.Date, 1, 4) = '2013' THEN ym.Consumption ELSE 0 END) AS consumption_2013     FROM          customers c     JOIN          yearmonth ym ON c.CustomerID = ym.CustomerID     GROUP BY          c.Segment ), percent_increase AS (     SELECT          Segment,         ((consumption_2013 - consumption_2012) / consumption_2013) * 100 AS percent_change     FROM          segment_consumptions ) SELECT      Segment,      ROUND(percent_change, 2) AS Percent_Change FROM      percent_increase ORDER BY      ABS(percent_change) DESC;
SELECT SUM(Consumption) AS TotalConsumption  FROM yearmonth  WHERE CustomerID = 6 AND SUBSTR(Date, 1, 6) BETWEEN '201308' AND '201311';
SELECT      SUM(CASE WHEN Country='CZE' THEN 1 ELSE 0 END) -     SUM(CASE WHEN Country='SVK' THEN 1 ELSE 0 END) AS DifferenceInDiscountGasStations FROM gasstations WHERE Segment = 'Discount';
SELECT      SUM(CASE WHEN c.Currency='CZK' THEN 1 ELSE 0 END) AS total_sme_czk,     SUM(CASE WHEN c.Currency='EUR' THEN 1 ELSE 0 END) AS total_sme_eur,     (         SUM(CASE WHEN c.Currency='CZK' THEN 1 ELSE 0 END) -         SUM(CASE WHEN c.Currency='EUR' THEN 1 ELSE 0 END)     ) AS amount_of_more_smes FROM customers c WHERE c.Segment = 'SME';
SELECT      ROUND(         (             CAST(SUM(CASE WHEN y.Consumption > 46.73 THEN 1 ELSE 0 END) AS FLOAT) /             COUNT(*)         ) * 100,          2     ) AS percentage_consumed_more_than_46_73 FROM      customers c JOIN      yearmonth y ON c.CustomerID = y.CustomerID WHERE      c.Segment = 'LAM';
SELECT      ROUND((COUNT(*) * 100.0 / total_customers), 2) AS Percentage FROM (     SELECT *     FROM yearmonth     WHERE Date = '201202'       AND Consumption > 528.3 ) filtered_customers, (     SELECT COUNT(DISTINCT CustomerID) as total_customers     FROM yearmonth     WHERE Date = '201202' ) all_customers;
SELECT MAX(Consumption) AS HighestMonthlyConsumption  FROM yearmonth  WHERE SUBSTR(Date, 1, 4) = '2012';
SELECT DISTINCT p.Description  FROM products AS p JOIN transactions_1k AS t ON p.ProductID = t.ProductID WHERE SUBSTR(t.Date, 1, 4) || SUBSTR(t.Date, 6, 2) = '201309';
SELECT DISTINCT gs.Country  FROM gasstations gs JOIN transactions_1k t ON gs.GasStationID = t.GasStationID WHERE SUBSTR(t.Date, 1, 4) || SUBSTR(t.Date, 6, 2) = '201306';
SELECT COUNT(DISTINCT y.CustomerID) AS NumberOfCustomers FROM yearmonth y  JOIN customers c ON y.CustomerID = c.CustomerID WHERE c.Currency = 'EUR' AND y.Consumption > 1000;
SELECT DISTINCT p.Description  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID JOIN products p ON t.ProductID = p.ProductID WHERE g.Country = 'CZE';
SELECT DISTINCT Time  FROM transactions_1k  WHERE GasStationID IN (     SELECT GasStationID      FROM gasstations      WHERE ChainID = 11 );
SELECT COUNT(*)  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID WHERE g.Country = 'CZE' AND t.Date > '2012-01-01';
SELECT c.Currency  FROM transactions_1k t  JOIN customers c ON t.CustomerID = c.CustomerID  WHERE t.Date='2012-08-24' AND t.Time='16:25:00';
SELECT c.Segment  FROM customers AS c JOIN transactions_1k AS t ON c.CustomerID = t.CustomerID WHERE t.Date = '2012-08-23' AND t.Time = '21:20:00';
SELECT COUNT(*)  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID WHERE t.Date = '2012-08-26' AND t.Time BETWEEN '08:00:00' AND '09:00:00' AND g.Country = 'CZE';
SELECT c.Currency  FROM customers AS c JOIN transactions_1k AS t ON c.CustomerID = t.CustomerID WHERE t.Date = '2012-08-24' AND t.Price * t.Amount = 548.4;
SELECT      COUNT(DISTINCT CASE WHEN c.Currency='EUR' THEN t.CustomerID END) * 100.0 / COUNT(DISTINCT t.CustomerID) AS Percentage_EUR_Customers FROM transactions_1k t JOIN customers c ON t.CustomerID=c.CustomerID WHERE t.Date='2012-08-25';
WITH  customer_id AS (     SELECT CustomerID     FROM transactions_1k     WHERE Date='2012-08-25' AND ROUND(Price * Amount, 2)=634.8 ), consumptions AS (     SELECT ym.Date, ym.Consumption     FROM yearmonth ym     JOIN customer_id ci ON ym.CustomerID=ci.CustomerID     WHERE ym.Date IN ('2012','2013') ) SELECT ((c.consumption_2012-c.consumption_2013)/c.consumption_2012)*100 as consumption_decrease_rate FROM (     SELECT          MAX(CASE WHEN Date='2012' THEN Consumption END) as consumption_2012,         MAX(CASE WHEN Date='2013' THEN Consumption END) as consumption_2013     FROM consumptions ) c;
SELECT      ROUND((COUNT(CASE WHEN gs.Segment='Premium' THEN 1 END) * 100.0 / COUNT(*)), 2) AS PremiumPercentage FROM gasstations gs WHERE gs.Country = 'SVK';
SELECT SUM(Amount * Price) AS TotalSpent  FROM transactions_1k  WHERE CustomerID = 38508 AND strftime('%Y%m', Date) = '201201';
SELECT      c.CustomerID AS TopSpendingCustomer,     AVG(t.Price * t.Amount / t.Amount) AS AveragePricePerItem,     c.Currency FROM      transactions_1k t JOIN      customers c ON t.CustomerID = c.CustomerID GROUP BY      c.CustomerID, c.Currency ORDER BY      SUM(t.Price * t.Amount) DESC LIMIT 1;
SELECT      ym.Consumption AS Consumption_Status FROM      transactions_1k t JOIN      yearmonth ym ON t.CustomerID = ym.CustomerID AND ym.Date = '201208' WHERE      t.ProductID = 5 AND (t.Price / t.Amount) > 29.00;
SELECT m.major_name  FROM major AS m JOIN member AS mem ON m.major_id = mem.link_to_major WHERE mem.first_name = 'Angela' AND mem.last_name = 'Sanders';
SELECT COUNT(*)  FROM attendance  JOIN member ON attendance.link_to_member = member.member_id  WHERE attendance.link_to_event IN (     SELECT event.event_id      FROM event      WHERE event.event_name = 'Women''s Soccer' ) AND member.t_shirt_size = 'Medium';
SELECT COUNT(*) AS number_of_meetings FROM (     SELECT e.event_id, e.type      FROM event e     JOIN attendance a ON e.event_id = a.link_to_event     GROUP BY e.event_id, e.type     HAVING COUNT(a.link_to_event) > 10 AND e.type = 'Meeting' ) subquery;
SELECT e.event_name  FROM event e JOIN attendance a ON e.event_id = a.link_to_event WHERE e.type <> 'Fundraiser' GROUP BY e.event_id, e.event_name HAVING COUNT(a.link_to_event) > 20;
SELECT SUM(i.amount) AS total_funds_received FROM income i  JOIN member m ON i.link_to_member = m.member_id WHERE m.position = 'Vice President';
SELECT m.first_name, m.last_name  FROM member AS m JOIN zip_code AS z ON m.zip = z.zip_code WHERE z.state = 'Illinois';
SELECT      e.expense_id,      e.expense_description,      e.approved FROM      expense AS e JOIN      budget AS b ON e.link_to_budget = b.budget_id JOIN      event AS ev ON b.link_to_event = ev.event_id WHERE      ev.event_name = 'October Meeting' AND      ev.event_date = '2019-10-08';
SELECT AVG(cost) AS avg_cost  FROM expense  WHERE link_to_member IN (     SELECT member_id      FROM member      WHERE first_name='Elijah' AND last_name='Allen' ) AND SUBSTR(expense_date, 6, 2) IN ('09','10');
SELECT      SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2019' THEN b.spent ELSE 0 END) AS Total_Spent_2019,     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2020' THEN b.spent ELSE 0 END) AS Total_Spent_2020,     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2019' THEN b.spent ELSE 0 END) -     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2020' THEN b.spent ELSE 0 END) AS Difference FROM      budget b JOIN      event e ON b.link_to_event = e.event_id;
SELECT notes  FROM income  WHERE source = 'Fundraising' AND date_received = '2019-09-14';
SELECT phone  FROM member  WHERE first_name = 'Carlo' AND last_name = 'Jacobs';
SELECT e.status  FROM event e  JOIN budget b ON e.event_id = b.link_to_event  JOIN expense ex ON b.budget_id = ex.link_to_budget  WHERE ex.expense_description = 'Post Cards, Posters' AND ex.expense_date = '2019-08-20';
SELECT m.major_name  FROM major AS m JOIN member AS mem ON m.major_id = mem.link_to_major WHERE mem.first_name = 'Brent' AND mem.last_name = 'Thomason';
SELECT COUNT(*)  FROM member m JOIN major maj ON m.link_to_major = maj.major_id WHERE maj.major_name = 'Business' AND m.t_shirt_size = 'Medium';
SELECT m.department  FROM member AS mem JOIN major AS m ON mem.link_to_major = m.major_id WHERE mem.position = 'President';
SELECT i.date_received  FROM income AS i  JOIN member AS m ON i.link_to_member = m.member_id  WHERE m.first_name = 'Connor' AND m.last_name = 'Hilton' AND i.source = 'Dues';
SELECT      CASE WHEN (         SUM(CASE WHEN e.event_name = 'Yearly Kickoff' THEN b.amount ELSE 0 END) /         NULLIF(SUM(CASE WHEN e.event_name = 'October Meeting' THEN b.amount ELSE 0 END), 0)     ) > 1 THEN COUNT(*) ELSE 0 END AS count_of_times FROM budget b JOIN event e ON b.link_to_event = e.event_id WHERE b.category = 'Advertisement';
SELECT SUM(e.cost) AS total_pizza_cost  FROM expense e  WHERE e.expense_description = 'Pizza';
SELECT COUNT(DISTINCT city)  FROM zip_code  WHERE county = 'Orange County' AND state = 'Virginia';
SELECT mem.first_name, mem.last_name, maj.major_name   FROM member AS mem  JOIN major AS maj ON mem.link_to_major = maj.major_id  WHERE mem.phone = '809-555-3360';
SELECT COUNT(*)  FROM attendance a JOIN event e ON a.link_to_event = e.event_id WHERE e.event_name = 'Women''s Soccer';
SELECT m.first_name || ' ' || m.last_name AS full_name  FROM member m  JOIN major maj ON m.link_to_major = maj.major_id  WHERE maj.department = 'School of Applied Sciences, Technology and Education';
SELECT      e.event_name,      b.spent / b.amount AS spend_to_budget_ratio FROM      event e JOIN      budget b ON e.event_id = b.link_to_event WHERE      e.status = 'Closed' ORDER BY      spend_to_budget_ratio DESC LIMIT 1;
SELECT MAX(b.spent) AS max_spent_amount  FROM budget b;
SELECT SUM(spent) AS TotalSpentOnFood  FROM budget  WHERE category = 'Food';
SELECT m.first_name || ' ' || m.last_name AS full_name  FROM member m JOIN attendance a ON m.member_id = a.link_to_member GROUP BY m.member_id, m.first_name, m.last_name HAVING COUNT(a.link_to_event) > 7;
SELECT m.first_name || ' ' || m.last_name AS Full_Name   FROM member m  JOIN budget b ON m.member_id = b.budget_id  WHERE b.link_to_event IN (     SELECT e.event_id      FROM event e      WHERE e.event_name = 'Yearly Kickoff' );
SELECT e.event_name  FROM event e  JOIN budget b ON e.event_id = b.link_to_event  ORDER BY b.spent ASC  LIMIT 1;
SELECT      (SUM(CASE WHEN e.event_name = 'Yearly Kickoff' THEN ex.cost ELSE 0 END) / NULLIF(SUM(ex.cost), 0)) * 100 AS percentage_cost FROM      expense ex JOIN      budget b ON ex.link_to_budget = b.budget_id JOIN      event e ON b.link_to_event = e.event_id;
SELECT      source, SUM(amount) AS total_amount FROM      income WHERE      date_received BETWEEN '2019-09-01' AND '2019-09-30' GROUP BY      source ORDER BY      total_amount DESC LIMIT 1;
SELECT COUNT(*)  FROM member m JOIN major ma ON m.link_to_major = ma.major_id WHERE ma.major_name = 'Physics Teaching';
SELECT e.event_name  FROM event e  JOIN budget b ON e.event_id = b.link_to_event  WHERE b.category = 'Advertisement'  ORDER BY b.spent DESC  LIMIT 1;
SELECT      a.link_to_event, e.event_name FROM      attendance AS a JOIN      member AS m ON a.link_to_member = m.member_id JOIN      event AS e ON a.link_to_event = e.event_id WHERE      m.first_name = 'Maya' AND m.last_name = 'Mclean' AND      e.event_name = 'Women''s Soccer';
SELECT e.cost  FROM expense AS e JOIN budget AS b ON e.link_to_budget = b.budget_id JOIN event AS ev ON b.link_to_event = ev.event_id WHERE ev.event_name = 'September Speaker' AND e.expense_description = 'Posters';
SELECT e.event_name  FROM event AS e JOIN budget AS b ON e.event_id = b.link_to_event WHERE e.status = 'Closed' AND b.remaining < 0 ORDER BY b.remaining ASC LIMIT 1;
SELECT      e.expense_description AS Expense_Type,     SUM(e.cost) AS Total_Value FROM      expense e JOIN      budget b ON e.link_to_budget = b.budget_id JOIN      event ev ON b.link_to_event = ev.event_id WHERE      ev.event_name = 'October Meeting' AND      e.approved = 'true' GROUP BY      e.expense_description;
SELECT      category,      SUM(amount) AS total_amount_budgeted FROM      budget WHERE      link_to_event IN (         SELECT              event_id          FROM              event          WHERE              event_name = 'April Speaker'     ) GROUP BY      category ORDER BY      total_amount_budgeted ASC;
SELECT SUM(cost) AS total_expense  FROM expense  WHERE expense_date = '2019-08-20';
SELECT      m.first_name || ' ' || m.last_name AS full_name,     SUM(e.cost) AS total_cost FROM      expense e JOIN      member m ON e.link_to_member = m.member_id WHERE      m.member_id = 'rec4BLdZHS2Blfp4v' GROUP BY      m.first_name, m.last_name;
SELECT e.expense_description  FROM expense AS e JOIN member AS m ON e.link_to_member = m.member_id WHERE m.first_name || ' ' || m.last_name = 'Sacha Harrison';
SELECT DISTINCT type  FROM event  WHERE location = 'MU 215';
SELECT m.last_name, maj.department, maj.college  FROM member AS m JOIN major AS maj ON m.link_to_major = maj.major_id WHERE maj.major_name = 'Environmental Engineering';
SELECT DISTINCT b.category  FROM budget AS b JOIN event AS e ON b.link_to_event = e.event_id WHERE e.location = 'MU 215' AND e.type = 'Guest Speaker' AND b.spent = 0;
SELECT      (         COUNT(CASE WHEN i.amount = 50 THEN 1 ELSE NULL END) * 1.0 /         COUNT(m.member_id)     ) * 100 AS percentage  FROM      member m  LEFT JOIN      income i ON m.member_id = i.link_to_member  WHERE      m.t_shirt_size = 'Medium'  AND      m.position = 'Member';
SELECT event_name  FROM event  WHERE type = 'Game' AND status = 'Closed' AND event_date BETWEEN '2019-03-15' AND '2020-03-20';
SELECT m.first_name || ' ' || m.last_name AS full_name,         m.phone AS contact_number FROM member m JOIN expense e ON m.member_id = e.link_to_member WHERE e.cost > (     SELECT AVG(e2.cost)     FROM expense e2 ) GROUP BY m.member_id;
SELECT      m.first_name || ' ' || m.last_name AS full_name,     e.cost FROM      member m JOIN      expense e ON m.member_id = e.link_to_member WHERE      e.expense_description = 'Water, Veggie tray, supplies';
SELECT m.first_name || ' ' || m.last_name AS full_name, i.amount  FROM member m JOIN income i ON m.member_id = i.link_to_member WHERE i.date_received = '2019-09-09';
SELECT      SUM(CASE WHEN SEX='M' AND Admission='+' THEN 1 ELSE 0 END) AS InPatientCount,     SUM(CASE WHEN SEX='M' AND Admission='-' THEN 1 ELSE 0 END) AS OutPatientCount,     ROUND((SUM(CASE WHEN SEX='M' AND Admission='+' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN SEX='M' AND Admission='-' THEN 1 ELSE 0 END), 0)) * 100 - 100, 2) AS PercentageDeviation FROM Patient;
SELECT      ROUND((COUNT(CASE WHEN STRFTIME('%Y', Birthday) > '1930' AND SEX = 'F' THEN ID END) * 100.0) /           COUNT(CASE WHEN SEX = 'F' THEN ID END), 2) AS Female_Born_After_1930_Percentage FROM      Patient;
SELECT      SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END), 0) AS Ratio_Outpatient_To_Inpatient FROM Patient WHERE Diagnosis = 'SLE';
SELECT p.Diagnosis, l.Date  FROM Patient AS p  LEFT JOIN Laboratory AS l ON p.ID = l.ID  WHERE p.ID = '30609';
SELECT      p.ID AS "Patient ID",     p.SEX AS "Sex",     p.Birthday AS "Birthday" FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.LDH > 500;
SELECT      p.ID,      CASE          WHEN STRFTIME('%m-%d', CURRENT_TIMESTAMP) >= STRFTIME('%m-%d', p.Birthday) THEN              STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', p.Birthday)         ELSE              STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', p.Birthday) - 1     END AS Age FROM      Patient p JOIN      Examination e ON p.ID = e.ID WHERE      e.RVVT = '+';
SELECT      p.ID,      p.SEX,      e.Diagnosis FROM      Patient AS p JOIN      Examination AS e ON p.ID = e.ID WHERE      e.Thrombosis = 2;
SELECT COUNT(*) FROM Patient WHERE SEX = 'F' AND STRFTIME('%Y', Description) = '1997' AND Admission = '-';
SELECT COUNT(DISTINCT e.ID)  FROM Examination AS e JOIN Patient AS p ON e.ID = p.ID WHERE e.Thrombosis = '1' AND strftime('%Y', e.`Examination Date`) = '1997' AND p.SEX = 'F';
SELECT      e.Symptoms AS Observed_Symptoms,     p.Diagnosis AS Patient_Diagnosis FROM      Examination e JOIN      Patient p ON e.ID = p.ID WHERE      e.Symptoms IS NOT NULL AND     p.Birthday = (         SELECT MAX(Birthday)         FROM Patient         WHERE ID IN (SELECT DISTINCT ID FROM Examination)     );
SELECT      p.Birthday,      l.Date AS Lab_Date,      STRFTIME('%Y', p."First Date") - STRFTIME('%Y', p.Birthday) AS Age_On_Arrival  FROM      Patient p  JOIN      Laboratory l ON p.ID = l.ID  WHERE      p.Diagnosis = 'SJS'  ORDER BY      p.Birthday ASC  LIMIT 1;
SELECT      COUNT(CASE WHEN p.SEX = 'M' AND l.UA <= 8 THEN 1 END) /      NULLIF(COUNT(CASE WHEN p.SEX = 'F' AND l.UA <= 6.5 THEN 1 END), 0) AS Ratio FROM Patient p JOIN Laboratory l ON p.ID = l.ID;
SELECT COUNT(DISTINCT e.ID)  FROM Examination AS e JOIN Patient AS p ON e.ID = p.ID WHERE strftime('%Y', p.Birthday) >= strftime('%Y', e.`Examination Date`) - 18  AND strftime('%Y', e.`Examination Date`) BETWEEN '1990' AND '1993';
SELECT      STRFTIME('%Y', e.`Examination Date`) - STRFTIME('%Y', p.Birthday) AS AgeAtExamination,     p.Diagnosis FROM      Examination e JOIN      Patient p ON e.ID = p.ID JOIN      Laboratory l ON e.ID = l.ID AND e.`Examination Date` = l.Date WHERE      l.HGB = (         SELECT MAX(HGB)          FROM Laboratory     );
SELECT e.`aCL IgM` FROM Examination AS e  JOIN Patient AS p ON e.ID = p.ID WHERE p.Diagnosis = 'SLE' AND p.Description = '1994-02-19' AND e.`Examination Date` = '1993-11-12';
SELECT      ((SUM(CASE WHEN l.Date LIKE '1981-11-%' THEN l.`T-CHO` END)) -       (SUM(CASE WHEN l.Date LIKE '1981-12-%' THEN l.`T-CHO` END))) /      NULLIF((SUM(CASE WHEN l.Date LIKE '1981-12-%' THEN l.`T-CHO` END)), 0) AS DecreaseRate FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE p.Birthday = '1959-02-18';
SELECT DISTINCT p.ID  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.Date BETWEEN '1987-07-06' AND '1996-01-31' AND l.GPT > 30 AND l.ALB < 4;
SELECT COUNT(*) AS NumberOfPatients  FROM Examination E WHERE E.Thrombosis = 2 AND E.`ANA Pattern` = 'S' AND E.`aCL IgM` > ((SELECT AVG(E2.`aCL IgM`) FROM Examination E2)*1.2);
SELECT DISTINCT p.ID  FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE p.Admission = '-' AND l.Date LIKE '1991-10%' AND l.`T-BIL` < 2.0;
SELECT AVG(L.ALB) AS Average_Albumin_Level  FROM Patient P  JOIN Laboratory L ON P.ID = L.ID  WHERE P.SEX = 'F' AND L.PLT > 400 AND P.Diagnosis = 'SLE';
SELECT COUNT(*)  FROM Patient p JOIN Examination e ON p.ID = e.ID WHERE p.SEX = 'F' AND e.Diagnosis = 'APS';
SELECT      ROUND((SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT)) * 100, 2) AS PercentageWomen FROM Patient WHERE SUBSTR(Birthday, 1, 4) = '1980' AND Diagnosis = 'RA';
SELECT      CASE WHEN P.SEX = 'M' AND L.UA > 8.0 THEN 'Yes'          WHEN P.SEX = 'F' AND L.UA > 6.5 THEN 'Yes'          ELSE 'No' END AS Within_Normal_Range FROM      Patient P JOIN      Laboratory L ON P.ID = L.ID WHERE      P.ID = 57266;
SELECT DISTINCT p.ID  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.GPT >= 60;
SELECT p.Diagnosis  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.GPT > 60 ORDER BY p.Birthday ASC;
SELECT p.ID, p.SEX, p.Birthday  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.UN = 29;
SELECT      SEX,     STRING_AGG(CAST(Patient.ID AS TEXT), ', ' ORDER BY Patient.ID ASC) AS Patients FROM      Patient JOIN      Laboratory ON Patient.ID = Laboratory.ID WHERE      Laboratory."T-BIL" >= 2.0 GROUP BY      SEX;
SELECT AVG(STRFTIME('%Y', 'now') - STRFTIME('%Y', Patient.Birthday)) AS AverageAge FROM Patient  JOIN Laboratory ON Patient.ID = Laboratory.ID WHERE Patient.SEX = 'M' AND Laboratory.`T-CHO` >= 250 AND Patient.Birthday IS NOT NULL AND Laboratory.`T-CHO` IS NOT NULL;
SELECT COUNT(DISTINCT p.ID) AS CountOfPatients  FROM Patient p   JOIN Laboratory l ON p.ID = l.ID  WHERE l.TG >= 200  AND (strftime('%Y', CURRENT_TIMESTAMP) - strftime('%Y', p.Birthday)) > 50;
SELECT COUNT(DISTINCT p.ID)   FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE STRFTIME('%Y', p.Birthday) BETWEEN '1936' AND '1956'  AND p.SEX = 'M'  AND l.CPK >= 250;
SELECT DISTINCT     p.ID,      p.SEX,      ROUND((julianday('now') - julianday(p.Birthday)) / 365.25) AS Age FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.GLU >= 180 AND l.`T-CHO` < 250;
SELECT      p.ID,      p.Diagnosis,      YEAR(CURRENT_TIMESTAMP()) - YEAR(p.Birthday) AS Age FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.RBC < 3.5;
SELECT p.ID, p.SEX  FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE p.Diagnosis = 'SLE' AND l.HGB BETWEEN 10 AND 17  ORDER BY p.Birthday ASC  LIMIT 1;
SELECT      p.ID,      strftime('%Y', 'now') - strftime('%Y', p.Birthday) AS Age FROM      Patient p JOIN (     SELECT          l.ID     FROM          Laboratory l     WHERE          l.HCT >= 52     GROUP BY          l.ID     HAVING          COUNT(*) >= 2 ) sub ON p.ID = sub.ID;
SELECT      COUNT(CASE WHEN PLT < 100 THEN 1 END) AS LowerThanNormalRangeCount,     COUNT(CASE WHEN PLT > 400 THEN 1 END) AS HigherThanNormalRangeCount,     (         COUNT(CASE WHEN PLT < 100 THEN 1 END) -          COUNT(CASE WHEN PLT > 400 THEN 1 END)     ) AS Difference FROM Laboratory WHERE PLT IS NOT NULL AND (PLT <= 100 OR PLT >= 400);
SELECT DISTINCT p.ID   FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE STRFTIME('%Y', l.Date) = '1984'  AND (STRFTIME('%Y', 'now') - STRFTIME('%Y', p.Birthday)) < 50  AND l.PLT BETWEEN 100 AND 400;
SELECT      ROUND((SUM(CASE WHEN PT >= 14 AND SEX = 'F' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN PT >= 14 THEN 1 ELSE 0 END), 0)) * 100, 2) AS Percentage_Female_Abnormal_PT  FROM (     SELECT p.SEX, l.PT      FROM Patient p      JOIN Laboratory l ON p.ID = l.ID      WHERE STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', p.Birthday) > 55 ) AS subquery;
SELECT COUNT(DISTINCT p.ID)  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.WBC BETWEEN 3.5 AND 9.0 AND (l.FG <= 150 OR l.FG >= 450);
SELECT COUNT(DISTINCT p.ID)  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.IGG >= 2000;
SELECT COUNT(*) FROM Patient p  JOIN Laboratory l ON p.ID = l.ID  WHERE l.IGG BETWEEN 900 AND 2000  AND EXISTS (     SELECT 1      FROM Examination e      WHERE e.ID = p.ID      AND e.Symptoms IS NOT NULL );
SELECT COUNT(DISTINCT p.ID)   FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE l.IGA BETWEEN 80 AND 500  AND p.`First Date` >= '1990-01-01';
SELECT Diagnosis, COUNT(*) AS Frequency  FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE l.IGM <= 40 OR l.IGM >= 400 GROUP BY Diagnosis ORDER BY Frequency DESC LIMIT 1;
SELECT COUNT(*)  FROM Patient p WHERE p.Description IS NULL AND EXISTS (     SELECT *      FROM Laboratory l     WHERE l.ID = p.ID AND l.CRP = '+' );
SELECT COUNT(*)  FROM Patient p  JOIN Laboratory l ON p.ID = l.ID  WHERE l.CRE >= 1.5 AND (strftime('%Y', 'now') - strftime('%Y', p.Birthday)) < 70;
SELECT COUNT(DISTINCT p.ID)  FROM Patient p JOIN Laboratory l ON p.ID = l.ID WHERE l.RNP IN ('-', '+-') AND p.Admission = '+';
SELECT COUNT(*) FROM Laboratory l  JOIN Examination e ON l.ID = e.ID WHERE l.SM IN ('-', '+-') AND e.Thrombosis = 0;
SELECT COUNT(DISTINCT p.ID) FROM Patient AS p  JOIN Examination AS e ON p.ID = e.ID WHERE e.SC170 IN ('-', '0') AND p.SEX = 'F' AND e.Symptoms IS NULL;
SELECT COUNT(DISTINCT p.ID)  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.CENTROMEA IN ('-', '+-') AND l.SSB IN ('-', '+-') AND p.SEX = 'M';
SELECT MIN(Patient.Birthday) AS YoungestBirthday  FROM Patient  JOIN Laboratory ON Patient.ID = Laboratory.ID  WHERE Laboratory.GOT >= 60;
SELECT COUNT(DISTINCT e.ID) AS Positive_Coagulation_Count  FROM Examination e JOIN Laboratory l ON e.ID = l.ID WHERE l.CPK < 250 AND (e.KCT = '+' OR e.RVVT = '+' OR e.LAC = '+');
SELECT l.name AS league_name, SUM(m.home_team_goal  m.away_team_goal) AS total_goals FROM Match m JOIN League l ON m.league_id = l.id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY total_goals DESC LIMIT 1;
SELECT T.team_long_name FROM Match M JOIN Team T ON M.away_team_api_id = T.team_api_id WHERE M.league_id IN (     SELECT L.id     FROM League L     JOIN Country C ON L.country_id = C.id     WHERE L.name = 'Scotland Premier League' ) AND M.season = '2009/2010' AND M.away_team_goal > M.home_team_goal GROUP BY M.away_team_api_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT team_long_name, buildUpPlaySpeed AS Attack_Speed FROM Team_Attributes JOIN Team ON Team.id = Team_Attributes.team_api_id ORDER BY buildUpPlaySpeed DESC LIMIT 4;
SELECT l.name AS league_name FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY SUM(m.home_team_goal = m.away_team_goal) DESC LIMIT 1;
SELECT      p.player_name,     ROUND(STRFTIME('%Y', 'now') - STRFTIME('%Y', p.birthday)) AS current_age FROM      Player p JOIN      Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE      pa.sprint_speed >= 97  AND      SUBSTR(pa.date, 1, 4) BETWEEN '2013' AND '2015';
SELECT l.name AS league_name, COUNT(m.id) AS total_matches FROM League l JOIN Match m ON l.id = m.league_id GROUP BY l.id ORDER BY total_matches DESC LIMIT 1;
SELECT team_fifa_api_id FROM Team_Attributes WHERE buildUpPlaySpeed > 50 AND buildUpPlaySpeed < 60;
SELECT t.team_long_name  FROM Team AS t  JOIN Team_Attributes AS ta ON t.team_api_id = ta.team_api_id  WHERE ta.buildUpPlayPassing > (     SELECT AVG(ta_inner.buildUpPlayPassing)     FROM Team_Attributes AS ta_inner     WHERE ta_inner.buildUpPlayPassing IS NOT NULL AND strftime('%Y', ta_inner.date) = '2012' )  AND strftime('%Y', ta.date) = '2012';
SELECT ROUND(SUM(CASE WHEN pa.preferred_foot = 'left' THEN 1 ELSE 0 END) * 100.0 / COUNT(p.player_api_id), 2) AS percentage_left_foot_players FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE SUBSTR(p.birthday, 1, 4) BETWEEN '1987' AND '1992';
SELECT AVG(pa.long_shots) AS avg_long_shots FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Ahmed Samir Farag';
SELECT p.player_name, AVG(pa.heading_accuracy) AS avg_heading_accuracy FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.height > 180 GROUP BY p.player_name ORDER BY avg_heading_accuracy DESC LIMIT 10;
SELECT l.name AS league_name FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2009/2010' GROUP BY l.name HAVING AVG(m.home_team_goal) > AVG(m.away_team_goal) ORDER BY AVG(m.home_team_goal - m.away_team_goal) DESC;
SELECT * FROM Player WHERE SUBSTR(birthday, 1, 4) = '1970' AND SUBSTR(birthday, 6, 2) = '10';
SELECT pa.overall_rating FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Gabriel Tamas' AND strftime('%Y', pa.date) = '2011';
SELECT AVG(m.home_team_goal) AS avg_home_team_goal FROM Match m JOIN Country c ON m.country_id = c.id WHERE c.name = 'Poland' AND m.season = '2010/2011';
SELECT p.player_name, AVG(pa.finishing) AS avg_finishing FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.height IN ((SELECT MAX(height) FROM Player), (SELECT MIN(height) FROM Player)) GROUP BY p.player_api_id ORDER BY avg_finishing DESC LIMIT 1;
SELECT AVG(pa.overall_rating) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.height > 170  AND strftime('%Y', pa.date) BETWEEN '2010' AND '2015';
SELECT      AVG(CASE WHEN p.player_name = 'Abdou Diallo' THEN pa.ball_control ELSE NULL END)     - AVG(CASE WHEN p.player_name = 'Aaron Appindangoye' THEN pa.ball_control ELSE NULL END) AS avg_ball_control_difference FROM Player_Attributes pa JOIN Player p ON pa.player_api_id = p.player_api_id;
SELECT p.player_name, p.birthday FROM Player AS p WHERE p.player_name IN ('Aaron Lennon', 'Abdelaziz Barrada') ORDER BY p.birthday ASC;
SELECT player_name, height  FROM Player  ORDER BY height DESC  LIMIT 1;
SELECT COUNT(*)  FROM Player_Attributes WHERE preferred_foot = 'left' AND attacking_work_rate = 'low';
SELECT COUNT(DISTINCT pa.player_api_id) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE strftime('%Y', p.birthday) < '1986' AND pa.defensive_work_rate = 'high';
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.volleys > 70 AND pa.dribbling > 70;
SELECT COUNT(*) AS total_matches FROM Match m JOIN League l ON m.league_id = l.id WHERE l.name = 'Belgium Jupiler League' AND SUBSTR(m.date, 1, 7) = '2009-04';
SELECT l.name AS league_name, COUNT(m.id) AS number_of_matches FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2008/2009' GROUP BY l.name ORDER BY number_of_matches DESC LIMIT 1;
SELECT      ROUND((CAST(pa.overall_rating AS FLOAT) - pb.overall_rating) * 100 / pb.overall_rating, 2) FROM      Player_Attributes pa JOIN      Player p ON pa.player_api_id = p.player_api_id AND p.player_name = 'Ariel Borysiuk' CROSS JOIN      Player_Attributes pb JOIN      Player b ON pb.player_api_id = b.player_api_id AND b.player_name = 'Paulin Puel';
SELECT AVG(PA.overall_rating) AS avg_overall_rating FROM Player_attributes PA JOIN Player P ON PA.player_api_id = P.player_api_id WHERE P.player_name = 'Pietro Marino';
SELECT MAX(TA.chanceCreationPassing) AS Highest_Chance_Creation_Passing_Score, TA.chanceCreationPassingClass FROM Team T JOIN Team_Attributes TA ON T.team_api_id = TA.team_api_id WHERE T.team_long_name = 'Ajax';
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.overall_rating = 77 AND pa.date LIKE '2016-06-23%' ORDER BY p.birthday ASC LIMIT 1;
SELECT pa.overall_rating   FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Aaron Mooy' AND pa.date LIKE '2016-02-04%'
SELECT pa.attacking_work_rate FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Francesco Migliore' AND pa.date LIKE '2015-05-01%';
SELECT pa.date FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Kevin Constant' ORDER BY pa.crossing DESC LIMIT 1;
SELECT ta.buildUpPlayPassingClass FROM Team t JOIN Team_Attributes ta ON t.team_api_id = ta.team_api_id WHERE t.team_long_name = 'FC Lorient' AND ta.date LIKE '2010-02-22%';
SELECT ta.defenceAggressionClass FROM Team t JOIN Team_Attributes ta ON t.team_api_id = ta.team_api_id WHERE t.team_long_name = 'Hannover 96' AND ta.date LIKE '2015-09-10%';
SELECT AVG(pa.overall_rating) AS Average_Overall_Rating FROM Player_Attributes pa JOIN Player p ON pa.player_api_id = p.player_api_id WHERE p.player_name = 'Marko Arnautovic' AND SUBSTR(pa.date, 1, 10) BETWEEN '2007-02-22' AND '2016-04-21';
SELECT ROUND(((pa_ld.overall_rating - pa_jb.overall_rating) * 100.0 / pa_ld.overall_rating), 2) FROM Player_Attributes AS pa_ld JOIN Player AS p_ld ON pa_ld.player_api_id = p_ld.player_api_id AND p_ld.player_name = 'Landon Donovan' JOIN Player_Attributes AS pa_jb ON pa_jb.player_api_id = p_jb.player_api_id JOIN Player AS p_jb ON pa_jb.player_api_id = p_jb.player_api_id AND p_jb.player_name = 'Jordan Bowery' WHERE pa_ld.date = '2013-07-12' AND pa_jb.date = '2013-07-12';
SELECT player_name FROM Player WHERE height IN (     SELECT MAX(height)     FROM Player ) ORDER BY height DESC;
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.overall_rating = (SELECT MAX(pa2.overall_rating) FROM Player_Attributes AS pa2)
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.attacking_work_rate = 'high';
SELECT DISTINCT t.team_short_name FROM Team AS t JOIN Team_Attributes AS ta ON t.team_api_id = ta.team_api_id WHERE ta.chanceCreationPassingClass = 'Safe';
SELECT COUNT(*)  FROM Player  WHERE player_name LIKE 'Aaron%' AND birthday > '1990';
SELECT      pa1.jumping - pa2.jumping AS Jumping_Score_Difference FROM      Player_Attributes pa1 JOIN      Player_Attributes pa2 ON pa1.id <> pa2.id WHERE      pa1.id = 6 AND pa2.id = 23;
SELECT player_api_id FROM Player_Attributes WHERE preferred_foot = 'right' ORDER BY potential ASC LIMIT 4;
SELECT COUNT(*) AS count_of_players_with_highest_crossing_potential_and_left_preferred_foot FROM Player_Attributes WHERE crossing = (SELECT MAX(crossing) FROM Player_Attributes) AND preferred_foot = 'left';
SELECT      m.home_team_goal AS Home_Team_Goal,     m.away_team_goal AS Away_Team_Goal FROM      Match m JOIN      League l ON m.league_id = l.id WHERE      m.date LIKE '2008-09-24%' AND     l.name = 'Belgium Jupiler League';
SELECT ta.buildUpPlaySpeedClass FROM Team t JOIN Team_Attributes ta ON t.team_api_id = ta.team_api_id WHERE t.team_long_name = 'KSV Cercle Brugge';
SELECT pa.finishing, pa.curve FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.weight = (SELECT MAX(weight) FROM Player) LIMIT 1;
SELECT l.name AS league_name, COUNT(m.id) AS number_of_games FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY number_of_games DESC LIMIT 4;
SELECT T.team_long_name AS Full_Name_Away_Team FROM Match M JOIN Team T ON M.away_team_api_id = T.team_api_id WHERE M.away_team_goal = (SELECT MAX(away_team_goal) FROM Match) LIMIT 1;
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.overall_rating = (SELECT MAX(pa2.overall_rating) FROM Player_Attributes AS pa2) LIMIT 1;
SELECT ROUND((CAST(SUM(CASE WHEN height < 180 AND overall_rating > 70 THEN 1 ELSE 0 END) AS FLOAT)/COUNT(*))*100, 2) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id;
SELECT d.driverRef  FROM qualifying AS q  JOIN drivers AS d ON q.driverId = d.driverId  WHERE q.raceId = 20  ORDER BY q.q1 DESC  LIMIT 5;
SELECT d.surname  FROM drivers AS d  JOIN qualifying AS q ON d.driverId = q.driverId  WHERE q.raceId = 19 AND q.q2 = (     SELECT MIN(q2)      FROM qualifying      WHERE raceId = 19 );
SELECT r.name  FROM races AS r JOIN circuits AS c ON r.circuitId = c.circuitId WHERE c.country = 'Germany';
SELECT      c.lat,      c.lng FROM      circuits AS c JOIN      races AS r ON c.circuitId = r.circuitId WHERE      r.name = 'Australian Grand Prix';
SELECT      c.lat,      c.lng FROM      circuits AS c JOIN      races AS r ON c.circuitId = r.circuitId WHERE      r.name = 'Abu Dhabi Grand Prix';
SELECT q.q1  FROM qualifying AS q  JOIN drivers AS d ON q.driverId = d.driverId  WHERE q.raceId = 354 AND d.forename || ' ' || d.surname = 'Bruno Senna';
SELECT      q.driverId,     d.number FROM      qualifying AS q JOIN      drivers AS d ON q.driverId = d.driverId WHERE      q.raceId = 903 AND q.q3 LIKE '%0:01:54%';
SELECT COUNT(*)  FROM results r JOIN races ra ON r.raceId = ra.raceId WHERE ra.year = 2007 AND ra.name = 'Bahrain Grand Prix' AND r.time IS NULL;
SELECT d.driverId, d.forename, d.surname, d.dob  FROM results r  JOIN drivers d ON r.driverId = d.driverId  WHERE r.raceId = 592 AND r.time IS NOT NULL  ORDER BY d.dob ASC  LIMIT 1;
SELECT d.url  FROM drivers AS d  JOIN lapTimes AS lt ON d.driverId = lt.driverId  WHERE lt.raceId = 161 AND lt.time LIKE '%0:01:27%';
SELECT      c.lat,      c.lng  FROM      circuits AS c  JOIN      races AS r ON c.circuitId = r.circuitId  WHERE      r.name = 'Malaysian Grand Prix';
SELECT c.url  FROM constructors AS c  JOIN constructorResults AS cr ON c.constructorId = cr.constructorId  WHERE cr.raceId = 9 AND cr.points = (     SELECT MAX(points)      FROM constructorResults      WHERE raceId = 9 );
SELECT d.code  FROM drivers AS d  JOIN qualifying AS q ON d.driverId = q.driverId  WHERE q.raceId = 45 AND q.q3 LIKE '%0:01:33%';
SELECT s.url  FROM seasons AS s  JOIN races AS r ON s.year = r.year  WHERE r.raceId = 901;
SELECT      d.driverId,      d.forename || ' ' || d.surname AS full_name,      d.dob FROM      drivers d JOIN      results r ON d.driverId = r.driverId WHERE      r.raceId = 872 AND r.time IS NOT NULL ORDER BY      d.dob DESC LIMIT 1;
SELECT d.nationality  FROM drivers AS d  JOIN results AS r ON d.driverId = r.driverId  WHERE r.fastestLapSpeed = (     SELECT MAX(fastestLapSpeed)      FROM results );
SELECT      ((results.fastestLapSpeed - r2.fastestLapSpeed) / results.fastestLapSpeed) * 100 AS percentage_faster FROM      results JOIN      drivers ON results.driverId = drivers.driverId JOIN      races ON results.raceId = races.raceId LEFT JOIN      results AS r2 ON r2.raceId = 854 AND r2.driverId = results.driverId WHERE      drivers.forename = 'Paul'      AND drivers.surname = 'di Resta'     AND results.raceId = 853;
SELECT      ROUND((COUNT(CASE WHEN r.time IS NOT NULL THEN r.driverId END)*1.0 / COUNT(r.driverId))*100, 2) AS percentage FROM      results r JOIN      races ra ON r.raceId = ra.raceId WHERE      ra.date = '1983-07-16';
SELECT name  FROM races  WHERE STRFTIME('%Y-%m', date) = (     SELECT MIN(STRFTIME('%Y-%m', date))     FROM races );
SELECT      d.forename || ' ' || d.surname AS "Full Name",     MAX(ds.points) AS Points FROM      driverStandings ds JOIN      drivers d ON ds.driverId = d.driverId;
SELECT      d.forename || ' ' || d.surname AS DriverName,     r.name AS RaceName,     MIN(lt.milliseconds) AS BestLapTimeMilliseconds FROM      lapTimes lt JOIN      drivers d ON lt.driverId = d.driverId JOIN      races r ON lt.raceId = r.raceId GROUP BY      d.driverId, r.raceId ORDER BY      BestLapTimeMilliseconds ASC LIMIT 1;
SELECT AVG(lt.milliseconds) AS avg_lap_time  FROM lapTimes lt  JOIN drivers d ON lt.driverId = d.driverId  JOIN races r ON lt.raceId = r.raceId  WHERE d.forename || ' ' || d.surname = 'Lewis Hamilton' AND r.year = 2009 AND r.name = 'Malaysian Grand Prix';
SELECT      ROUND((CAST(SUM(CASE WHEN r.position > 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(r.resultId)) * 100, 2) as Percentage  FROM      results r  JOIN      drivers d ON r.driverId = d.driverId  WHERE      d.surname = 'Hamilton'  AND      r.raceId IN (         SELECT raceId          FROM races          WHERE year >= 2010     );
SELECT      d.forename || ' ' || d.surname AS full_name,     d.nationality,     ds.points AS max_points FROM      drivers d JOIN (     SELECT          driverId, COUNT(*) as total_wins     FROM          driverStandings     GROUP BY          driverId     ORDER BY          total_wins DESC     LIMIT 1 ) w ON d.driverId = w.driverId JOIN (     SELECT          driverId, MAX(points) AS points     FROM          driverStandings     GROUP BY          driverId ) ds ON d.driverId = ds.driverId;
SELECT      MIN(strftime('%Y', 'now') - strftime('%Y', dob)) AS Age,     forename || ' ' || surname AS Name FROM      drivers WHERE      nationality = 'Japanese';
SELECT      r.name AS Race_Name, c.name AS Circuit_Name, c.location AS Location FROM      races r JOIN      circuits c ON r.circuitId = c.circuitId WHERE      STRFTIME('%m', r.date) = '09' AND STRFTIME('%Y', r.date) = '2005';
SELECT r.name  FROM races AS r  JOIN results AS res ON r.raceId = res.raceId  JOIN drivers AS d ON res.driverId = d.driverId  WHERE d.forename || ' ' || d.surname = 'Alex Yoong' AND res.position < 20;
SELECT r.name AS RaceName,         r.year AS YearOfRace FROM results res JOIN races r ON res.raceId = r.raceId JOIN drivers d ON res.driverId = d.driverId WHERE d.forename || ' ' || d.surname = 'Michael Schumacher' ORDER BY res.milliseconds ASC LIMIT 1;
SELECT      r.year AS "First Race Year",     r.name AS "Race Name",     res.points AS "Points" FROM      races r JOIN      results res ON r.raceId = res.raceId JOIN      drivers d ON res.driverId = d.driverId WHERE      d.forename || ' ' || d.surname = 'Lewis Hamilton' ORDER BY      r.year ASC LIMIT 1;
SELECT      ROUND((COUNT(CASE WHEN c.country = 'Germany' THEN r.raceId ELSE NULL END) * 1.0 / COUNT(r.raceId)) * 100, 2) AS percentage FROM      races r  JOIN      circuits c ON r.circuitId = c.circuitId WHERE      r.name = 'European Grand Prix';
SELECT lat, lng  FROM circuits  WHERE name = 'Silverstone Circuit';
SELECT circuitRef  FROM circuits  WHERE name = 'Marina Bay Street Circuit';
SELECT nationality  FROM drivers  ORDER BY dob ASC  LIMIT 1;
SELECT d.driverRef  FROM results r  JOIN drivers d ON r.driverId = d.driverId  WHERE r.position = '1' AND r.raceId IN (     SELECT raceId      FROM races      WHERE name = 'Canadian Grand Prix' AND year = 2007 );
SELECT r.name AS RaceName  FROM results res  JOIN drivers d ON res.driverId = d.driverId  JOIN races r ON res.raceId = r.raceId  WHERE d.forename || ' ' || d.surname = 'Lewis Hamilton'  ORDER BY res.rank ASC  LIMIT 1;
SELECT MAX(results.fastestLapSpeed)  FROM results  JOIN races ON results.raceId = races.raceId  WHERE races.year = 2009 AND races.name = 'Spanish Grand Prix';
SELECT r.positionOrder  FROM results AS r  JOIN drivers AS d ON r.driverId = d.driverId  JOIN races AS rc ON r.raceId = rc.raceId  WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton' AND rc.year = 2008 AND rc.name = 'Chinese Grand Prix';
SELECT r.time  FROM results AS r  JOIN races AS rc ON r.raceId = rc.raceId  WHERE rc.year = 2008 AND rc.name = 'Chinese Grand Prix' AND r.positionOrder = 2;
SELECT COUNT(DISTINCT d.driverId) AS total_drivers_with_races  FROM drivers d JOIN results r ON d.driverId = r.driverId WHERE r.time IS NOT NULL AND r.raceId IN (     SELECT raceId      FROM races      WHERE name='Chinese Grand Prix' AND year=2008 );
WITH Champion AS (     SELECT          r.time as champ_time     FROM          results r     JOIN          races ra ON r.raceId = ra.raceId     WHERE          ra.year = 2008 AND ra.name LIKE '%Australian%' AND r.position = 1 ), LastDriver AS (     SELECT          r.time as last_time     FROM          results r     JOIN          races ra ON r.raceId = ra.raceId     WHERE          ra.year = 2008 AND ra.name LIKE '%Australian%'     ORDER BY          r.position DESC     LIMIT 1 ) SELECT      ((strftime('%s.%f', LastDriver.last_time) - strftime('%s.%f', Champion.champ_time)) / strftime('%s.%f', LastDriver.last_time)) * 100 AS PercentageFaster FROM      Champion, LastDriver;
SELECT COUNT(*)  FROM circuits  WHERE location = 'Adelaide' AND country = 'Australia';
SELECT MAX(points)  FROM constructorStandings  WHERE constructorId IN (     SELECT constructorId      FROM constructors      WHERE nationality='British' );
SELECT constructors.name  FROM constructors  JOIN constructorResults ON constructors.constructorId = constructorResults.constructorId  WHERE constructorResults.points = 0 AND constructorResults.raceId = 291;
SELECT COUNT(*)  FROM constructors c JOIN constructorStandings cs ON c.constructorId = cs.constructorId WHERE c.nationality = 'Japanese' AND cs.points = 0 GROUP BY c.constructorId HAVING COUNT(DISTINCT cs.raceId) = 2;
SELECT      ROUND((SUM(CASE WHEN r.time IS NOT NULL THEN 1 ELSE 0 END) * 1.0 / COUNT(r.driverId)) * 100, 2) AS CompletionPercentage   FROM      results r  JOIN      drivers d ON r.driverId = d.driverId  JOIN      races ra ON r.raceId = ra.raceId  WHERE      d.nationality = 'Japanese'  AND      ra.year BETWEEN 2007 AND 2009;
SELECT      ra.year AS Year,              AVG(strftime('%s', r.time)) AS Average_Time_in_Seconds  FROM        results r  JOIN        races ra ON r.raceId = ra.raceId  WHERE       ra.year < 1975  AND         r.position = 1  AND         r.time IS NOT NULL  GROUP BY    ra.year;
SELECT r.fastestLap, r.fastestLapTime  FROM results AS r  JOIN races AS rc ON r.raceId = rc.raceId  WHERE rc.year = 2009 AND r.positionOrder = 1;
SELECT AVG(results.fastestLapSpeed)  FROM results  JOIN races ON results.raceId = races.raceId  WHERE races.name = 'Spanish Grand Prix' AND races.year = 2009;
SELECT      ROUND((COUNT(CASE WHEN strftime('%Y', drivers.dob) < '1985' AND results.laps > 50 THEN drivers.driverId END) / CAST(COUNT(*) AS FLOAT)) * 100, 2) AS Percentage  FROM      results  JOIN      drivers ON results.driverId = drivers.driverId  WHERE      results.raceId IN (         SELECT raceId          FROM races          WHERE year BETWEEN 2000 AND 2005     );
SELECT COUNT(DISTINCT d.driverId) FROM drivers AS d  JOIN lapTimes AS lt ON d.driverId = lt.driverId WHERE d.nationality = 'French' AND lt.milliseconds / 1000 < 120;
SELECT code  FROM drivers  WHERE nationality = 'American';
SELECT COUNT(*) AS netherlands_drivers_count  FROM (     SELECT *      FROM drivers      ORDER BY dob DESC      LIMIT 3 ) AS young_drivers  WHERE nationality = 'Dutch';
SELECT driverRef  FROM drivers  WHERE nationality = 'German'  ORDER BY dob ASC  LIMIT 1;
SELECT DISTINCT d.driverId, d.code  FROM drivers AS d  JOIN results AS r ON d.driverId = r.driverId  WHERE STRFTIME('%Y', d.dob) = '1971' AND r.fastestLapTime IS NOT NULL;
SELECT COUNT(*)  FROM results  WHERE raceId BETWEEN 50 AND 100  AND statusId = 2  AND time IS NOT NULL;
SELECT      COUNT(*) AS total_races_in_austria,     c.location,     c.lat,     c.lng FROM      circuits c JOIN      races r ON c.circuitId = r.circuitId WHERE      c.country = 'Austria' GROUP BY      c.location, c.lat, c.lng;
SELECT      ra.year AS "Year",     dr.forename || ' ' || dr.surname AS "Driver Name",     ra.name AS "Race Name",      ra.date AS "Date",      ra.time AS "Time" FROM      qualifying qu JOIN      races ra ON qu.raceId = ra.raceId JOIN      drivers dr ON qu.driverId = dr.driverId WHERE      dr.dob = (         SELECT MAX(dob)         FROM drivers d         JOIN qualifying q ON d.driverId = q.driverId     ) ORDER BY      ra.date ASC LIMIT 1;
SELECT      d.forename || ' ' || d.surname AS full_name,     AVG(p.duration) AS avg_pit_stop_duration FROM      drivers d JOIN      pitStops p ON d.driverId = p.driverId WHERE      d.nationality = 'German' AND      STRFTIME('%Y', d.dob) BETWEEN '1980' AND '1985' GROUP BY      d.driverId ORDER BY      avg_pit_stop_duration ASC LIMIT 3;
SELECT      d.forename || ' ' || d.surname AS ChampionName,     r.time AS FinishTime FROM      results r JOIN      drivers d ON r.driverId = d.driverId WHERE      r.position = 1 AND r.raceId IN (         SELECT raceId          FROM races          WHERE name LIKE '%Canadian%' AND year = 2008     );
SELECT c.constructorRef AS ConstructorReferenceName,         c.url AS Website FROM results r JOIN constructors c ON r.constructorId = c.constructorId WHERE r.raceId IN (     SELECT raceId      FROM races      WHERE name='Singapore Grand Prix' AND year=2009 ) AND r.positionOrder = 1;
SELECT sp.power_name  FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.superhero_name = '3-D Man';
SELECT      c.name AS ConstructorName,     c.nationality AS Nationality,     SUM(cr.points) AS TotalPoints FROM      constructorResults cr JOIN      constructors c ON cr.constructorId = c.constructorId JOIN      races r ON cr.raceId = r.raceId WHERE      r.year BETWEEN 1980 AND 2010 AND      r.circuitId IN (         SELECT circuitId          FROM circuits          WHERE name LIKE '%Monaco%'     ) GROUP BY      cr.constructorId ORDER BY      TotalPoints DESC LIMIT 1;
SELECT d.forename || ' ' || d.surname AS FullName  FROM qualifying q  JOIN drivers d ON q.driverId = d.driverId  WHERE q.position = 1 AND q.q3 = (     SELECT MIN(q3)      FROM qualifying      WHERE raceId IN (         SELECT r.raceId          FROM races r          JOIN circuits c ON r.circuitId = c.circuitId          WHERE r.year = 2008 AND c.name = 'Marina Bay Street Circuit'     ) );
SELECT      d.forename || ' ' || d.surname AS FullName,     d.nationality,     r.name AS FirstRace FROM      drivers d JOIN      results res ON d.driverId = res.driverId JOIN      races r ON res.raceId = r.raceId WHERE      d.dob = (         SELECT MAX(dob)          FROM drivers     ) ORDER BY      r.year ASC LIMIT 1;
SELECT COUNT(*) AS accident_count  FROM results  WHERE statusId = 3 AND raceId IN (     SELECT raceId      FROM races      WHERE name LIKE '%Canadian Grand Prix%' ) AND driverId = (     SELECT driverId      FROM results      WHERE statusId = 3 AND raceId IN (         SELECT raceId          FROM races          WHERE name LIKE '%Canadian Grand Prix%'     )      GROUP BY driverId      ORDER BY COUNT(*) DESC LIMIT 1 );
SELECT      d.forename || ' ' || d.surname AS FullName,     MIN(lt.time) AS ShortestLapTime FROM      lapTimes lt JOIN      drivers d ON lt.driverId = d.driverId GROUP BY      d.driverId ORDER BY      ShortestLapTime ASC LIMIT 20;
SELECT      c.name AS circuit_name,     lt.lap,     MIN(lt.time) AS fastest_lap_time FROM      lapTimes lt JOIN      races r ON lt.raceId = r.raceId JOIN      circuits c ON r.circuitId = c.circuitId WHERE      c.country = 'Italy' GROUP BY      c.name, lt.lap;
SELECT COUNT(*)  FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Super Strength' AND s.height_cm > 200;
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id AND c.colour = 'Blue' JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id AND sp.power_name = 'Agility';
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c_eyes ON s.eye_colour_id = c_eyes.id AND c_eyes.colour = 'Blue' JOIN colour AS c_hair ON s.hair_colour_id = c_hair.id AND c_hair.colour = 'Blond';
SELECT      s.superhero_name AS name,     s.height_cm AS height FROM      superhero s JOIN      publisher p ON s.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics' ORDER BY      s.height_cm DESC;
SELECT c.colour AS eye_color, COUNT(s.id) AS count  FROM superhero s  JOIN colour c ON s.eye_colour_id = c.id  WHERE s.publisher_id IN (     SELECT p.id      FROM publisher p      WHERE p.publisher_name = 'Marvel Comics' ) GROUP BY c.colour  ORDER BY count DESC;
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id JOIN publisher AS p ON s.publisher_id = p.id WHERE p.publisher_name = 'Marvel Comics' AND sp.power_name = 'Super Strength';
SELECT p.publisher_name  FROM publisher AS p JOIN superhero AS s ON p.id = s.publisher_id JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Speed' ) ORDER BY ha.attribute_value ASC LIMIT 1;
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id JOIN publisher p ON s.publisher_id = p.id WHERE c.colour = 'Gold' AND p.publisher_name = 'Marvel Comics';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id JOIN attribute AS at ON ha.attribute_id = at.id WHERE at.attribute_name = 'Intelligence' ORDER BY ha.attribute_value ASC LIMIT 1;
SELECT r.race  FROM superhero s  JOIN race r ON s.race_id = r.id  WHERE s.superhero_name = 'Copycat';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Durability' ) AND ha.attribute_value < 50;
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Death Touch';
SELECT COUNT(*)  FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE s.gender_id IN (     SELECT g.id      FROM gender g      WHERE g.gender = 'Female' ) AND a.attribute_name = 'Strength' AND ha.attribute_value = 100;
SELECT      COUNT(CASE WHEN s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END) AS bad_superheroes_count,     ROUND(COUNT(CASE WHEN s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END)*100.0 / COUNT(s.id), 2) AS percentage_of_bad_superheroes,     COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' AND s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END) AS marvel_bad_superheroes_count FROM      superhero s JOIN      alignment a ON s.alignment_id = a.id LEFT JOIN      publisher p ON s.publisher_id = p.id;
SELECT      (         COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) -          COUNT(CASE WHEN p.publisher_name = 'DC Comics' THEN s.id END)     ) AS Difference_in_Superheroes FROM superhero s JOIN publisher p ON s.publisher_id = p.id;
SELECT id  FROM publisher  WHERE publisher_name = 'Star Trek';
SELECT COUNT(*)  FROM superhero  WHERE full_name IS NULL;
SELECT AVG(s.weight_kg) AS avg_weight  FROM superhero s  JOIN gender g ON s.gender_id = g.id  WHERE g.gender = 'Female';
SELECT DISTINCT sp.power_name  FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.gender_id IN (     SELECT g.id      FROM gender g      WHERE g.gender = 'Male' ) LIMIT 5;
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c ON s.eye_colour_id = c.id WHERE s.height_cm BETWEEN 170 AND 190 AND c.colour = 'No Colour';
SELECT c.colour AS hair_colour  FROM superhero s JOIN colour c ON s.hair_colour_id = c.id WHERE s.height_cm = 185 AND s.race_id IN (     SELECT r.id      FROM race r      WHERE r.race = 'Human' );
SELECT      ROUND((COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) * 100.0 / COUNT(s.id)), 2) AS percentage FROM      superhero s JOIN      publisher p ON s.publisher_id = p.id WHERE      s.height_cm BETWEEN 150 AND 180;
SELECT s.superhero_name  FROM superhero AS s JOIN gender AS g ON s.gender_id = g.id WHERE g.gender = 'Male' AND s.weight_kg > (     SELECT AVG(s2.weight_kg)*0.79      FROM superhero AS s2 )
SELECT sp.power_name  FROM hero_power hp JOIN superpower sp ON hp.power_id = sp.id WHERE hp.hero_id = 1;
SELECT COUNT(DISTINCT hp.hero_id) FROM hero_power AS hp  JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Stealth';
SELECT s.full_name  FROM superhero AS s  JOIN hero_attribute AS ha ON s.id = ha.hero_id  WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Strength' ) AND ha.attribute_value = (     SELECT MAX(ha2.attribute_value)      FROM hero_attribute AS ha2      JOIN attribute AS at ON ha2.attribute_id = at.id      WHERE at.attribute_name = 'Strength' );
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id JOIN attribute AS at ON ha.attribute_id = at.id JOIN publisher AS p ON s.publisher_id = p.id WHERE at.attribute_name = 'Durability' AND p.publisher_name = 'Dark Horse Comics' ORDER BY ha.attribute_value DESC LIMIT 1;
SELECT      c1.colour AS eye_color,     c2.colour AS hair_color,     c3.colour AS skin_color FROM      superhero s JOIN      gender g ON s.gender_id = g.id AND g.gender = 'Female' JOIN      publisher p ON s.publisher_id = p.id AND p.publisher_name = 'Dark Horse Comics' LEFT JOIN      colour c1 ON s.eye_colour_id = c1.id LEFT JOIN      colour c2 ON s.hair_colour_id = c2.id LEFT JOIN      colour c3 ON s.skin_colour_id = c3.id;
SELECT      s.superhero_name,     p.publisher_name FROM      superhero AS s JOIN      publisher AS p ON s.publisher_id = p.id WHERE      s.hair_colour_id = s.skin_colour_id  AND      s.hair_colour_id = s.eye_colour_id;
SELECT      ROUND((COUNT(s.id) * 100.0 / (         SELECT COUNT(*)         FROM superhero sh         JOIN gender g ON sh.gender_id = g.id         WHERE g.gender = 'Female'     ))::NUMERIC, 2) AS percentage FROM      superhero s JOIN      gender g ON s.gender_id = g.id JOIN      colour c ON s.skin_colour_id = c.id WHERE      g.gender = 'Female' AND c.colour = 'Blue';
SELECT COUNT(hp.power_id) FROM hero_power hp  JOIN superhero s ON hp.hero_id = s.id WHERE s.superhero_name = 'Amazo';
SELECT s.height_cm  FROM superhero s  JOIN colour c ON s.eye_colour_id = c.id  WHERE c.colour = 'Amber';
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c ON s.eye_colour_id = c.id AND s.hair_colour_id = c.id WHERE c.colour = 'Black';
SELECT s.superhero_name  FROM superhero AS s JOIN alignment AS a ON s.alignment_id = a.id WHERE a.alignment = 'Neutral';
SELECT COUNT(*)  FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Strength' AND ha.attribute_value = (     SELECT MAX(ha_inner.attribute_value)     FROM hero_attribute ha_inner     JOIN attribute a_inner ON ha_inner.attribute_id = a_inner.id     WHERE a_inner.attribute_name = 'Strength' );
SELECT      ROUND((COUNT(CASE WHEN g.gender = 'Female' THEN s.id END) * 1.0 / COUNT(s.id)) * 100, 2) AS percentage_female_heroes FROM      superhero s JOIN      gender g ON s.gender_id = g.id JOIN      publisher p ON s.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics';
SELECT      (         COALESCE((SELECT weight_kg FROM superhero WHERE full_name = 'Emil Blonsky'), 0) -          COALESCE((SELECT weight_kg FROM superhero WHERE full_name = 'Charles Chandler'), 0)     ) AS weight_difference;
SELECT AVG(height_cm) AS average_height  FROM superhero;
SELECT sp.power_name  FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.superhero_name = 'Abomination';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Speed' ) ORDER BY ha.attribute_value DESC LIMIT 1;
SELECT      attribute.attribute_name AS Attribute_Name,     hero_attribute.attribute_value AS Attribute_Value FROM      hero_attribute JOIN      attribute ON hero_attribute.attribute_id = attribute.id JOIN      superhero ON hero_attribute.hero_id = superhero.id WHERE      superhero.superhero_name = '3-D Man';
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c_eyes ON s.eye_colour_id = c_eyes.id AND c_eyes.colour = 'Blue' JOIN colour AS c_hair ON s.hair_colour_id = c_hair.id AND c_hair.colour = 'Brown';
SELECT      s.superhero_name, p.publisher_name FROM      superhero AS s JOIN      publisher AS p ON s.publisher_id = p.id WHERE      s.superhero_name IN ('Hawkman', 'Karate Kid', 'Speedy');
SELECT      ROUND(COUNT(s.superhero_name) * 100.0 / (SELECT COUNT(*) FROM superhero), 2) AS percentage FROM      superhero s JOIN      colour c ON s.eye_colour_id = c.id WHERE      c.colour = 'Blue';
SELECT
SELECT c.colour AS eye_colour  FROM superhero s  JOIN colour c ON s.eye_colour_id = c.id  WHERE s.full_name = 'Karen Beecher-Duncan';
SELECT      SUM(CASE WHEN s.eye_colour_id = 7 THEN 1 ELSE 0 END) -      SUM(CASE WHEN s.eye_colour_id = 1 THEN 1 ELSE 0 END) AS difference FROM superhero s WHERE (s.weight_kg IS NULL OR s.weight_kg = 0);
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.skin_colour_id = c.id WHERE c.colour = 'Green' AND s.alignment_id IN (     SELECT id FROM alignment WHERE alignment = 'Bad' );
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Wind Control' ORDER BY s.superhero_name ASC;
SELECT g.gender  FROM superhero s JOIN gender g ON s.gender_id = g.id JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Phoenix Force';
SELECT      (         SELECT COUNT(*)          FROM superhero s          JOIN publisher p ON s.publisher_id = p.id          WHERE p.publisher_name = 'DC Comics'     ) -      (         SELECT COUNT(*)          FROM superhero s          JOIN publisher p ON s.publisher_id = p.id          WHERE p.publisher_name = 'Marvel Comics'     ) AS Difference;
SELECT MAX(Users.Reputation), Users.DisplayName  FROM Users  WHERE Users.DisplayName IN ('Harlan', 'Jarrod Dixon')  GROUP BY Users.DisplayName;
SELECT DisplayName  FROM users  WHERE STRFTIME('%Y', CreationDate) = '2011';
SELECT COUNT(*)  FROM users  WHERE LastAccessDate > '2014-09-01';
SELECT p.OwnerDisplayName  FROM posts p  WHERE p.Title = 'Eliciting priors from experts';
SELECT COUNT(*)  FROM posts  WHERE OwnerDisplayName = 'csgillespie';
SELECT u.DisplayName  FROM posts p  JOIN users u ON p.LastEditorUserId = u.Id  WHERE p.Title = 'Examples for teaching: Correlation does not mean causation';
SELECT COUNT(*)  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.Age > 65 AND p.Score >= 20;
SELECT p.Body  FROM posts AS p  JOIN tags AS t ON p.Id = t.ExcerptPostId  WHERE t.TagName = 'bayesian';
SELECT AVG(p.Score)  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE u.DisplayName = 'csgillespie';
SELECT      ROUND((COUNT(CASE WHEN u.Age > 65 THEN p.Id END) * 1.0 / NULLIF(COUNT(p.Id), 0)) * 100, 2) AS ElderOwnershipPercentage  FROM      posts p  JOIN      users u ON p.OwnerUserId = u.Id  WHERE      p.Score > 5;
SELECT p.FavoriteCount  FROM posts AS p  JOIN comments AS c ON p.Id = c.PostId  WHERE c.UserId = '3025' AND c.CreationDate = '2014-04-23 20:29:39';
SELECT      p.ClosedDate IS NOT NULL AS IsWellFinished FROM      comments c JOIN      posts p ON c.PostId = p.Id WHERE      c.UserId = '23853' AND c.CreationDate = '2013-07-12 09:08:18';
SELECT COUNT(*)  FROM posts  WHERE OwnerDisplayName = 'Tiago Pasqualini';
SELECT u.DisplayName  FROM users AS u  JOIN votes AS v ON u.Id = v.UserId  WHERE v.Id = '6347';
SELECT      COUNT(p.Id) / CAST(COUNT(v.Id) AS FLOAT) AS PostsToVotesRatio FROM      posts p LEFT JOIN      votes v ON p.Id = v.PostId AND v.UserId = 24 WHERE      p.OwnerUserId = 24;
SELECT ViewCount  FROM posts  WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer';
SELECT Text  FROM comments  WHERE Score = 17;
SELECT u.DisplayName  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Text = 'thank you user93!';
SELECT      p.Title AS PostTitle,     u.DisplayName AS Username,     u.Reputation AS UserReputation FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      p.Title = 'Understanding what Dassault iSight is doing?'
SELECT u.DisplayName  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE p.Title = 'Open source tools for visualizing multi-dimensional data';
SELECT c.Text  FROM comments AS c JOIN posts AS p ON c.PostId = p.Id WHERE p.Title = 'Why square the difference instead of taking the absolute value in standard deviation?' AND EXISTS (     SELECT 1      FROM postHistory AS ph      WHERE ph.UserId = c.UserId AND ph.PostId = p.Id );
SELECT u.DisplayName  FROM users AS u  JOIN votes AS v ON u.Id = v.UserId  JOIN posts AS p ON v.PostId = p.Id  WHERE v.BountyAmount = 50 AND p.Title LIKE '%variance%';
SELECT      p.Title AS PostTitle,     c.Text AS CommentText,     AVG(p.ViewCount) AS AverageViewCount FROM      posts p JOIN      comments c ON p.Id = c.PostId WHERE      p.Tags LIKE '%<humor>%' GROUP BY      p.Title, c.Text;
SELECT COUNT(*)  FROM (     SELECT UserId     FROM badges     GROUP BY UserId     HAVING COUNT(Name) > 5 ) AS BadgeCounts;
SELECT ph.UserId   FROM postHistory AS ph  JOIN posts AS p ON ph.PostId = p.Id  WHERE p.ViewCount >= 1000  GROUP BY ph.UserId, ph.PostId  HAVING COUNT(*) = 1;
SELECT      ROUND(         (             ((COUNT(CASE WHEN strftime('%Y', b.Date) = '2010' AND b.Name = 'Student' THEN 1 END)::REAL /                COUNT(CASE WHEN b.Name = 'Student' THEN 1 END)) * 100) -                          ((COUNT(CASE WHEN strftime('%Y', b.Date) = '2011' AND b.Name = 'Student' THEN 1 END)::REAL /                COUNT(CASE WHEN b.Name = 'Student' THEN 1 END)) * 100)         ),         2     ) AS PercentageDifference FROM badges b;
SELECT      AVG(u.UpVotes) AS Average_Up_Votes,     AVG(u.Age) AS Average_Age FROM      users u JOIN (     SELECT          OwnerUserId, COUNT(*) AS NumPosts     FROM          posts p     GROUP BY          OwnerUserId     HAVING          COUNT(*) > 10 ) AS post_counts ON u.Id = post_counts.OwnerUserId;
SELECT      CAST(SUM(CASE WHEN STRFTIME('%Y', CreationDate) = '2010' THEN 1 ELSE 0 END) AS FLOAT) /     SUM(CASE WHEN STRFTIME('%Y', CreationDate) = '2011' THEN 1 ELSE 0 END) AS Ratio FROM votes;
SELECT p.Id  FROM posts AS p JOIN users AS u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'slashnick' ORDER BY p.AnswerCount DESC LIMIT 1;
SELECT      p.OwnerDisplayName AS Author,     SUM(p.ViewCount) AS TotalViews FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      u.DisplayName IN ('Harvey Motulsky', 'Noah Snyder') GROUP BY      p.OwnerDisplayName;
SELECT DISTINCT p.Tags  FROM posts AS p JOIN users AS u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Mark Meckes' AND p.CommentCount = 0;
SELECT      ROUND(CAST(SUM(CASE WHEN p.Tags LIKE '%<r>%' THEN 1 ELSE 0 END) AS FLOAT) / NULLIF(COUNT(*), 0) * 100, 2) AS percentage FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Community';
SELECT      (         SELECT SUM(p.ViewCount)          FROM posts p          JOIN users u ON p.OwnerUserId = u.Id          WHERE u.DisplayName = 'Mornington'     ) - (         SELECT SUM(p.ViewCount)          FROM posts p          JOIN users u ON p.OwnerUserId = u.Id          WHERE u.DisplayName = 'Amos'     ) AS DifferenceInViewCount;
SELECT AVG(monthly_links) AS avg_monthly_links   FROM (     SELECT COUNT(*) / 12.0 AS monthly_links      FROM postLinks pl      JOIN posts p ON pl.PostId = p.Id      WHERE strftime('%Y', pl.CreationDate) = '2010' AND p.AnswerCount <= 2 ) subquery;
SELECT MIN(votes.CreationDate) AS FirstVoteDate  FROM votes  JOIN users ON votes.UserId = users.Id  WHERE users.DisplayName = 'chl';
SELECT u.DisplayName  FROM users AS u  JOIN badges AS b ON u.Id = b.UserId  WHERE b.Name = 'Autobiographer'  ORDER BY b.Date ASC  LIMIT 1;
SELECT COUNT(DISTINCT u.Id)  FROM users AS u JOIN posts AS p ON u.Id = p.OwnerUserId WHERE u.Location = 'United Kingdom' AND p.FavoriteCount >= 4;
SELECT p.Id, p.Title  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE u.DisplayName = 'Harvey Motulsky'  ORDER BY p.ViewCount DESC  LIMIT 1;
SELECT p.Id AS PostID, u.DisplayName  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE strftime('%Y', p.CreaionDate) = '2010'  ORDER BY p.FavoriteCount DESC  LIMIT 1;
SELECT      ROUND(         (             CAST(SUM(CASE WHEN strftime('%Y', p.CreaionDate) = '2011' AND u.Reputation > 1000 THEN 1 ELSE 0 END) AS REAL) /             CASE WHEN COUNT(*) = 0 THEN NULL ELSE COUNT(*) END         ) * 100,          2     ) AS Percentage FROM posts p JOIN users u ON p.OwnerUserId = u.Id;
SELECT p.ViewCount AS TotalViews, u.DisplayName  FROM posts p JOIN users u ON p.LastEditorUserId = u.Id WHERE p.Title = 'Computer Game Datasets';
SELECT COUNT(*)  FROM comments  WHERE PostId = (     SELECT Id      FROM posts      ORDER BY Score DESC      LIMIT 1 );
SELECT c.Text AS CommentText, u.DisplayName  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.PostId IN (     SELECT p.Id      FROM posts p      WHERE p.Title = 'Analysing wind data with R' ) ORDER BY c.CreationDate DESC LIMIT 10;
SELECT      ROUND((SUM(CASE WHEN p.Score > 50 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(p.Id), 0)), 2) AS PercentageAbove50Score FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      u.Reputation = (         SELECT MAX(Reputation)          FROM users     );
SELECT      ExcerptPostId, WikiPostId FROM      tags WHERE      TagName = 'sample';
SELECT u.Reputation, u.UpVotes  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Text = 'fine, you win :)';
SELECT c.Text  FROM comments AS c  JOIN posts AS p ON c.PostId = p.Id  WHERE p.ViewCount BETWEEN 100 AND 150  ORDER BY c.Score DESC  LIMIT 1;
SELECT COUNT(*)  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.CommentCount = 1 AND c.Score = 0;
SELECT      COUNT(CASE WHEN u.UpVotes = 0 THEN c.UserId END)*100.0 / COUNT(c.UserId) AS Percentage FROM      comments c JOIN      users u ON c.UserId = u.Id WHERE      c.Score >= 5 AND c.Score <= 10;
SELECT * FROM cards WHERE cardKingdomFoilId IS NOT NULL  AND cardKingdomId IS NOT NULL;
SELECT * FROM cards  WHERE borderColor = 'borderless' AND (     cardKingdomFoilId IS NULL OR      cardKingdomId IS NULL )  AND NOT (cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL);
SELECT DISTINCT cards.name  FROM cards  JOIN legalities ON cards.uuid = legalities.uuid  WHERE cards.rarity = 'mythic' AND legalities.status = 'Banned' AND legalities.format = 'gladiator';
SELECT      cards.name AS card_name,     legalities.status AS legal_status FROM      cards JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.types = 'Artifact' AND      cards.side IS NULL AND      legalities.format = 'vintage';
SELECT c.id, c.artist  FROM cards AS c  JOIN legalities AS l ON c.uuid = l.uuid  WHERE (c.power = '*' OR c.power IS NULL) AND l.format = 'commander' AND l.status = 'Legal';
SELECT      c.id AS card_id,     c.text AS ruling_text,     CASE WHEN c.hasContentWarning = 1 THEN 'Yes' ELSE 'No' END AS has_missing_or_degraded_properties FROM      cards c WHERE      c.artist = 'Stephen Daniel';
SELECT      cards.name AS card_name,     cards.artist AS artist_name,     COUNT(rulings.uuid) AS ruling_count,     cards.isPromo AS is_promotional_printing FROM      cards JOIN      rulings ON cards.uuid = rulings.uuid GROUP BY      cards.uuid ORDER BY      ruling_count DESC LIMIT 1;
SELECT      ROUND((COUNT(foreign_data.id) / CAST(COUNT(DISTINCT cards.id) AS FLOAT)) * 100, 2) AS percentage FROM      cards  LEFT JOIN      foreign_data  ON      cards.uuid = foreign_data.uuid  WHERE      foreign_data.language = 'Chinese Simplified';
SELECT COUNT(*)  FROM cards  WHERE power='*';
SELECT borderColor  FROM cards  WHERE name = 'Ancestor''s Chosen';
SELECT      l.format AS RuleOfPlayingFormat FROM      cards c JOIN      legalities l ON c.uuid = l.uuid WHERE      c.name = 'Benalish Knight';
SELECT      ROUND((COUNT(CASE WHEN borderColor='borderless' THEN id END)*1.0 / COUNT(id))*100, 2) AS PercentageBorderless FROM cards;
SELECT      ROUND((COUNT(CASE WHEN fd.language = 'French' THEN cd.id ELSE NULL END) * 1.0 / COUNT(cd.id)) * 100, 2) AS percentage_french_story_spotlight_cards FROM      cards cd LEFT JOIN      foreign_data fd ON cd.uuid = fd.uuid WHERE      cd.isStorySpotlight = 1;
SELECT COUNT(*)  FROM cards  WHERE originalType = 'Summon - Angel' AND subtypes != 'Angel';
SELECT id  FROM cards  WHERE duelDeck = 'a';
SELECT COUNT(*)  FROM cards  WHERE uuid IN (     SELECT uuid      FROM legalities      WHERE status = 'Banned' ) AND borderColor = 'white';
SELECT      c.name AS card_name,     fd.language AS translated_language FROM      cards c JOIN      foreign_data fd ON c.uuid = fd.uuid WHERE      c.originalType = 'Artifact' AND      c.colors LIKE '%B%' AND      fd.language IS NOT NULL;
SELECT manaCost  FROM cards  WHERE layout='normal' AND frameVersion='2003' AND borderColor='black' AND availability='mtgo,paper';
SELECT      ROUND((SUM(CASE WHEN isStorySpotlight = 1 AND isTextless = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) AS percentage_without_text_box FROM cards WHERE isStorySpotlight = 1;
SELECT COUNT(*)  FROM set_translations st JOIN sets s ON st.setCode = s.code WHERE st.language = 'Portuguese (Brasil)' AND s.block = 'Commander';
SELECT DISTINCT      cd.subtypes AS Subtypes,     cd.supertypes AS Supertypes FROM      cards cd JOIN      foreign_data fd ON cd.uuid = fd.uuid WHERE      fd.language = 'German' AND      cd.subtypes IS NOT NULL AND      cd.supertypes IS NOT NULL;
SELECT COUNT(*)  FROM cards  WHERE (power IS NULL OR power = '*') AND text LIKE '%triggered ability%';
SELECT COUNT(*)  FROM cards  WHERE EXISTS (     SELECT 1      FROM rulings      WHERE rulings.uuid = cards.uuid AND rulings.text LIKE '%This is a triggered mana ability.%' )  AND side IS NULL  AND EXISTS (     SELECT 1      FROM legalities      WHERE legalities.uuid = cards.uuid AND legalities.format = 'premodern' );
SELECT fd.name  FROM cards AS c  JOIN foreign_data AS fd ON c.uuid = fd.uuid  WHERE fd.language = 'French'  AND c.type LIKE '%Creature%'  AND c.layout = 'normal'  AND c.borderColor = 'black'  AND c.artist = 'Matthew D. Wilson';
SELECT st.language  FROM set_translations AS st  JOIN sets AS s ON st.setCode = s.code  WHERE s.baseSetSize = 180 AND s.block = 'Ravnica';
SELECT      ROUND((SUM(CASE WHEN cards.hasContentWarning = 0 THEN 1 ELSE 0 END) * 1.0 / COUNT(cards.id)) * 100, 2) AS Percentage  FROM      cards  JOIN      legalities ON cards.uuid = legalities.uuid  WHERE      legalities.format = 'commander'  AND      legalities.status = 'legal';
SELECT      ROUND((COUNT(CASE WHEN fd.language = 'French' AND (c.power IS NULL OR c.power = '*') THEN 1 END) /             CAST(COUNT(CASE WHEN c.power IS NULL OR c.power = '*' THEN 1 END) AS FLOAT)) * 100, 2) AS percentage FROM cards c JOIN foreign_data fd ON c.uuid = fd.uuid WHERE fd.language IN ('French');
SELECT fd.language  FROM foreign_data AS fd  WHERE fd.multiverseid = 149934;
SELECT      ROUND((CAST(SUM(CASE WHEN isTextless = 1 AND layout = 'normal' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*) * 100), 2) AS Proportion FROM cards;
SELECT DISTINCT st.language  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE s.mcmName = 'Archenemy' AND s.code = 'ARC';
SELECT fd.language  FROM foreign_data AS fd  JOIN cards AS c ON fd.uuid = c.uuid  WHERE c.name = 'A Pedra Fellwar';
SELECT      CASE WHEN ca.convertedManaCost > ck.convertedManaCost THEN 'Serra Angel'          ELSE 'Shrine Keeper' END AS MoreExpensiveCard FROM (     SELECT convertedManaCost      FROM cards      WHERE name = 'Serra Angel' ) ca CROSS JOIN (     SELECT convertedManaCost      FROM cards      WHERE name = 'Shrine Keeper' ) ck;
SELECT st.translation  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE st.language = 'Italian' AND EXISTS (     SELECT 1      FROM cards      WHERE cards.name = 'Ancestor''s Chosen' AND cards.setCode = s.code );
SELECT      fd.name AS korean_name FROM      cards c JOIN      foreign_data fd ON c.uuid = fd.uuid WHERE      c.name = 'Ancestor''s Chosen' AND      fd.language = 'Korean';
SELECT COUNT(*)  FROM cards  WHERE artist = 'Adam Rex' AND setCode IN (     SELECT setCode      FROM set_translations      WHERE translation = 'Hauptset Zehnte Edition' );
SELECT st.translation  FROM set_translations AS st  JOIN sets AS s ON st.setCode = s.code  WHERE s.name = 'Eighth Edition' AND st.language = 'Chinese Simplified';
SELECT      s.mtgoCode IS NOT NULL AS appeared_on_mtgo FROM      cards c JOIN      sets s ON c.setCode = s.code WHERE      c.name = 'Angel of Mercy';
SELECT COUNT(DISTINCT s.code) FROM sets AS s  JOIN set_translations AS st ON s.code = st.setCode WHERE s.block = 'Ice Age' AND st.language = 'Italian' AND st.translation IS NOT NULL;
SELECT      CASE WHEN EXISTS (         SELECT 1          FROM cards          JOIN sets ON cards.setCode = sets.code          WHERE cards.name = 'Adarkar Valkyrie' AND sets.isForeignOnly = 1     ) THEN 'Yes' ELSE 'No' END AS result;
SELECT COUNT(*)  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.language = 'Italian' AND st.translation IS NOT NULL AND s.baseSetSize < 100;
SELECT DISTINCT artist  FROM cards  WHERE setCode='CNS' AND artist IN ('Jeremy Jarvis', 'Aaron Miller', 'Chippy');
SELECT COUNT(*)  FROM cards AS T1 JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.name = 'Coldsnap' AND T1.convertedManaCost > 5 AND (T1.power = '*' OR T1.power IS NULL);
SELECT fd.flavorText  FROM foreign_data AS fd  JOIN cards AS c ON fd.uuid = c.uuid  WHERE fd.language = 'Italian' AND c.name = 'Ancestor''s Chosen';
SELECT fd.text  FROM foreign_data AS fd JOIN cards AS c ON fd.uuid = c.uuid WHERE c.setCode = 'CS' AND fd.language = 'Italian';
SELECT fd.name  FROM cards AS c JOIN foreign_data AS fd ON c.uuid = fd.uuid WHERE fd.language = 'Italian' AND c.setCode = 'CSA' AND c.convertedManaCost = (     SELECT MAX(c2.convertedManaCost)      FROM cards AS c2      WHERE c2.setCode = 'CSA' )
SELECT      ROUND((COUNT(CASE WHEN c.convertedManaCost = 7 THEN 1 END) * 100.0 / COUNT(*)), 2) AS Percentage FROM      cards c JOIN      sets s ON c.setCode = s.code WHERE      s.name = 'Coldsnap';
SELECT      ROUND(         (             CAST(SUM(CASE WHEN cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) /             CAST(COUNT(*) AS FLOAT)         ) * 100,          2     ) AS percentage_of_powerful_cards  FROM cards  WHERE setCode = 'CNS';
SELECT      format AS Play_Format,     GROUP_CONCAT(c.name) AS Banned_Cards FROM      legalities l JOIN      cards c ON l.uuid = c.uuid WHERE      status = 'Banned' GROUP BY      format ORDER BY      COUNT(*) DESC LIMIT 1;
SELECT      cards.name AS card_name,     legalities.format AS banned_format FROM      cards JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.edhrecRank = 1 AND legalities.status = 'Banned';
SELECT      c.name AS card_name,     l.format AS legal_format FROM      cards c JOIN      sets s ON c.setCode = s.code JOIN      legalities l ON c.uuid = l.uuid WHERE      s.name = 'Hour of Devastation' AND l.status = 'Legal';
SELECT DISTINCT s.name  FROM sets AS s JOIN set_translations AS st ON s.code = st.setCode WHERE st.language = 'Korean' AND NOT EXISTS (     SELECT 1      FROM set_translations AS st_jap      WHERE st_jap.setCode = s.code AND st_jap.language LIKE '%Japanese%' );
SELECT DISTINCT      cards.frameVersion AS FrameStyle,     cards.name AS CardName,     legalities.status AS LegalStatus FROM      cards LEFT JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.artist = 'Allen Williams' ORDER BY      FrameStyle;
SELECT bond_type, COUNT(*) AS frequency  FROM bond  GROUP BY bond_type  ORDER BY frequency DESC  LIMIT 1;
SELECT      AVG(oxygen_count) AS avg_oxygen_atoms FROM (     SELECT          a.molecule_id,         COUNT(*) AS oxygen_count     FROM          atom a     JOIN          bond b ON a.molecule_id = b.molecule_id AND b.bond_type = '-'     WHERE          a.element = 'o'     GROUP BY          a.molecule_id ) subquery;
SELECT AVG(single_bonds_per_molecule) AS avg_single_bonded_carcinogens  FROM (     SELECT m.molecule_id, COUNT(*) as single_bonds_per_molecule     FROM bond b     JOIN molecule m ON b.molecule_id = m.molecule_id     WHERE m.label = '+' AND b.bond_type = '-'     GROUP BY m.molecule_id ) subquery;
SELECT DISTINCT m.molecule_id  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '#' AND m.label = '+';
SELECT      (COUNT(a.atom_id) * 100.0 / total_atoms.total) AS percentage_of_carbon_in_double_bonds FROM      atom a JOIN      connected con ON a.atom_id = con.atom_id OR a.atom_id = con.atom_id2 JOIN      bond b ON con.bond_id = b.bond_id AND b.bond_type = '=' CROSS JOIN      (SELECT COUNT(*) AS total FROM atom) AS total_atoms WHERE      a.element = 'c';
SELECT DISTINCT a.element  FROM connected AS con  JOIN atom AS a ON (con.atom_id = a.atom_id OR con.atom_id2 = a.atom_id)  WHERE con.bond_id = 'TR004_8_9';
SELECT DISTINCT a.element  FROM atom AS a JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond AS b ON c.bond_id = b.bond_id AND b.bond_type = '=';
SELECT a.element, m.label, COUNT(*) AS count  FROM atom a  JOIN molecule m ON a.molecule_id = m.molecule_id  WHERE a.element = 'h'  GROUP BY a.element, m.label  ORDER BY count DESC  LIMIT 1;
SELECT a.element  FROM atom AS a JOIN molecule AS m ON a.molecule_id = m.molecule_id WHERE m.label = '-' GROUP BY a.element ORDER BY COUNT(a.atom_id) ASC LIMIT 1;
SELECT bond.bond_type  FROM connected  JOIN bond ON connected.bond_id = bond.bond_id  WHERE (connected.atom_id = 'TR004_8' AND connected.atom_id2 = 'TR004_20')     OR (connected.atom_id = 'TR004_20' AND connected.atom_id2 = 'TR004_8');
SELECT COUNT(DISTINCT a.atom_id) AS num_atoms FROM atom a  JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE (a.element = 'i' OR a.element = 's') AND b.bond_type = '-';
SELECT      (COUNT(DISTINCT CASE WHEN a.element != 'f' THEN m.molecule_id END) * 100.0 /      COUNT(DISTINCT m.molecule_id)) AS percentage_without_fluorine FROM      molecule m JOIN      atom a ON m.molecule_id = a.molecule_id WHERE      m.label = '+';
SELECT      (COUNT(CASE WHEN bond.bond_type = '#' THEN 1 END) * 100.0 / COUNT(bond.bond_id)) AS percent FROM      bond JOIN      molecule ON bond.molecule_id = molecule.molecule_id WHERE      molecule.label = '+';
SELECT element  FROM atom  WHERE molecule_id = 'TR000'  ORDER BY element ASC  LIMIT 3;
SELECT      ROUND(         (COUNT(CASE WHEN bond.bond_type = '=' THEN 1 END) * 100.0 /          COUNT(bond.bond_id)),          5     ) AS percent_double_bonds FROM      bond WHERE      bond.molecule_id = 'TR008';
SELECT      ROUND(         (COUNT(CASE WHEN m.label = '+' THEN 1 END) * 100.0 / COUNT(*)),          3     ) AS percent FROM molecule m;
SELECT      ROUND(COUNT(CASE WHEN element = 'h' THEN 1 END) * 100.0 / COUNT(*), 4) AS percent_hydrogen FROM      atom WHERE      molecule_id = 'TR206';
SELECT a.element, m.label  FROM atom AS a  JOIN molecule AS m ON a.molecule_id = m.molecule_id  WHERE m.molecule_id = 'TR060';
SELECT      bond.bond_type AS BondType,     COUNT(*) AS CountOfBonds,     molecule.label AS Carcinogenicity FROM      bond JOIN      molecule ON bond.molecule_id = molecule.molecule_id WHERE      bond.molecule_id = 'TR010' GROUP BY      bond.bond_type ORDER BY      CountOfBonds DESC LIMIT 1;
SELECT DISTINCT m.molecule_id  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '-' AND m.label = '-' ORDER BY m.molecule_id ASC LIMIT 3;
SELECT COUNT(*)  FROM connected  WHERE (atom_id = 'TR009_12' OR atom_id2 = 'TR009_12') AND bond_id IN (     SELECT bond_id      FROM bond      WHERE molecule_id = 'TR009' )
SELECT      bond.bond_type AS Bond_Type,     connected.atom_id AS Atom_ID1,     connected.atom_id2 AS Atom_ID2 FROM      bond JOIN      connected ON bond.bond_id = connected.bond_id WHERE      bond.bond_id = 'TR001_6_9';
SELECT COUNT(*)  FROM connected  WHERE atom_id = 'TR%_19' OR atom_id2 = 'TR%_19';
SELECT DISTINCT a.element  FROM atom AS a  WHERE a.molecule_id = 'TR004';
SELECT DISTINCT m.molecule_id  FROM atom a  JOIN molecule m ON a.molecule_id = m.molecule_id  WHERE SUBSTR(a.atom_id, 7, 2) BETWEEN '21' AND '25'  AND m.label = '+';
SELECT DISTINCT bond.bond_id  FROM bond JOIN connected ON bond.bond_id = connected.bond_id JOIN atom AS a1 ON connected.atom_id = a1.atom_id AND a1.element IN ('p','n') JOIN atom AS a2 ON connected.atom_id2 = a2.atom_id AND a2.element IN ('p','n');
SELECT m.label  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '=' GROUP BY m.molecule_id ORDER BY COUNT(b.bond_id) DESC LIMIT 1;
SELECT AVG(num_bonds) AS avg_num_bonds  FROM (     SELECT a.atom_id, COUNT(c.bond_id) as num_bonds     FROM atom a     LEFT JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2     WHERE a.element = 'i'     GROUP BY a.atom_id ) subquery;
SELECT DISTINCT a.element  FROM atom AS a  WHERE a.atom_id NOT IN (SELECT atom_id FROM connected)    OR a.atom_id NOT IN (SELECT atom_id2 FROM connected);
SELECT a.atom_id  FROM atom AS a JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond AS b ON c.bond_id = b.bond_id AND b.molecule_id = 'TR041' WHERE b.bond_type = '#';
SELECT a.element  FROM atom AS a  JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2  WHERE c.bond_id = 'TR144_8_19';
SELECT DISTINCT a.element  FROM atom AS a JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond AS b ON c.bond_id = b.bond_id AND b.bond_type = '#';
SELECT      ROUND(         SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) * 100.0 /         COUNT(b.bond_id),          5     ) AS carcinogenic_proportion_percentage FROM      bond b JOIN      molecule m ON b.molecule_id = m.molecule_id WHERE      b.bond_type = '-';
SELECT COUNT(DISTINCT a.atom_id) AS total_atoms  FROM atom a JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE (a.element = 'p' OR a.element = 'br') AND b.bond_type = '#';
SELECT      (COUNT(CASE WHEN a.element = 'cl' THEN 1 END) * 100.0 / COUNT(a.atom_id)) AS percent_cl_in_single_bonds FROM      atom a JOIN      connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN      bond b ON c.bond_id = b.bond_id WHERE      b.bond_type = '-';
SELECT a.element AS atom1_element,         a2.element AS atom2_element FROM connected c JOIN atom a ON c.atom_id = a.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR001_10_11';
WITH total_atoms_per_mol AS (     SELECT          molecule_id,          COUNT(*) AS total_atoms     FROM          atom     GROUP BY          molecule_id ) SELECT      SUM(CASE WHEN a.element = 'cl' THEN 1 ELSE 0 END) * 100.0 /     SUM(total_atoms_per_mol.total_atoms) AS percentage FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id JOIN      total_atoms_per_mol ON a.molecule_id = total_atoms_per_mol.molecule_id WHERE      m.label = '+';
SELECT      a.element AS Toxicology_Element,     COUNT(*) AS Count_of_Molecules FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id WHERE      m.label = '+' AND SUBSTR(a.atom_id, 7, 1) = '4' GROUP BY      a.element;
SELECT      m.label AS Label,     SUM(CASE WHEN a.element = 'h' THEN 1 ELSE 0 END) * 1.0 / COUNT(a.atom_id) AS Ratio FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id WHERE      a.molecule_id = 'TR006' GROUP BY      m.label;
SELECT m.molecule_id  FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '-' GROUP BY m.molecule_id HAVING COUNT(a.atom_id) > 5;
SELECT COUNT(s.CDSCode) FROM schools AS s  JOIN satscores AS ss ON s.CDSCode = ss.cds WHERE ss.AvgScrMath > 400 AND s.Virtual = 'F';
SELECT DISTINCT f.CDSCode AS School_Code FROM frpm f WHERE (f.`Enrollment (K-12)`  f.`Enrollment (Ages 5-17)`) > 500;
SELECT MAX(f.`Percent (%) Eligible Free (Ages 5-17)`) AS max_eligible_free_rate_ages_5_to_17 FROM satscores s JOIN frpm f ON s.cds = f.CDSCode WHERE (CAST(s.NumGE1500 AS FLOAT)/CAST(s.NumTstTakr AS FLOAT)) > 0.3;
SELECT      satscores.sname AS "School Name",      schools.CharterNum AS "Charter Number",     satscores.AvgScrWrite AS "Average Score in Writing" FROM      satscores JOIN      schools ON satscores.cds = schools.CDSCode WHERE      satscores.AvgScrWrite > 499 AND schools.CharterNum IS NOT NULL ORDER BY      satscores.AvgScrWrite DESC;
SELECT      f.`School Name`,      s.Street || ', ' || s.City AS Full_Street_Address FROM      frpm f JOIN      schools s ON f.CDSCode = s.CDSCode WHERE      ABS(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30;
SELECT      f."School Name"  FROM        frpm f  JOIN        satscores s  ON          f.CDSCode = s.cds  WHERE       (f."Free Meal Count (K-12)" / f."Enrollment (K-12)") > 0.1  AND         s.NumGE1500 >= 1;
SELECT      schools.School AS "School Name",      schools.FundingType AS "Funding Type" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.County = 'Riverside' AND      satscores.AvgScrMath > 400 GROUP BY      schools.School, schools.FundingType;
SELECT      frpm.`School Name`,      schools.Street,      schools.City,      schools.State,      schools.Zip FROM      frpm JOIN      schools ON frpm.CDSCode = schools.CDSCode WHERE      frpm.`County Name` = 'Monterey' AND      frpm.`School Type` LIKE '%High%' AND      frpm.`Free Meal Count (Ages 5-17)` > 800;
SELECT      schools.School AS "School Name",     satscores.AvgScrWrite AS "Average Writing Score",     schools.Phone AS "Communication Number" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.OpenDate > '1991-12-31' OR schools.ClosedDate < '2000-01-01';
SELECT      f."School Name",      s.DOCTYPE FROM      frpm AS f  JOIN      schools AS s ON f.CDSCode = s.CDSCode WHERE      s.FundingType = 'Locally funded' AND      ABS(f."Enrollment (K-12)" - f."Enrollment (Ages 5-17)") >     (         SELECT AVG(ABS("Enrollment (K-12)" - "Enrollment (Ages 5-17)"))         FROM frpm         JOIN schools ON frpm.CDSCode = schools.CDSCode         WHERE schools.FundingType = 'Locally funded'     );
SELECT      "School Name" AS "School",             ROUND(("Free Meal Count (K-12)" / "Enrollment (K-12)"), 4) AS "Eligible_Free_Rate" FROM (     SELECT          "School Name",                     "Enrollment (K-12)",                     "Free Meal Count (K-12)",                     ROW_NUMBER() OVER(ORDER BY "Enrollment (K-12)" DESC) AS rn     FROM frpm ) ranked_schools WHERE rn IN (10, 11);
SELECT      f.`School Name`,      f.`FRPM Count (K-12)` / f.`Enrollment (K-12)` AS `Eligible FRPM Rate` FROM      frpm f JOIN      schools s ON f.CDSCode = s.CDSCode WHERE      s.SOC = '66' ORDER BY      f.`FRPM Count (K-12)` DESC LIMIT 5;
SELECT      schools.Street AS Street,     schools.City AS City,     schools.State AS State,     schools.Zip AS Zip FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds ORDER BY      CAST(satscores.NumGE1500 AS FLOAT) / satscores.NumTstTakr ASC LIMIT 1;
SELECT      COALESCE(AdmFName1 || ' ' || AdmLName1, '') AS FullName1,     COALESCE(AdmFName2 || ' ' || AdmLName2, '') AS FullName2,     COALESCE(AdmFName3 || ' ' || AdmLName3, '') AS FullName3 FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      satscores.NumGE1500 = (         SELECT MAX(NumGE1500)          FROM satscores     );
SELECT AVG(satscores.NumTstTakr) AS AverageTestTakers  FROM satscores  JOIN schools ON satscores.cds = schools.CDSCode  WHERE schools.County = 'Fresno'  AND schools.OpenDate BETWEEN '1980-01-01' AND '1980-12-31';
SELECT      sch.Phone AS "Telephone Number" FROM      schools AS sch JOIN      satscores AS ss ON sch.CDSCode = ss.cds WHERE      sch.District = 'Fresno Unified' ORDER BY      ss.AvgScrRead ASC LIMIT 1;
SELECT      s.School AS "School Name",     sc.AvgScrRead AS "Average Reading Score" FROM      schools s JOIN      satscores sc ON s.CDSCode = sc.cds WHERE      s.Virtual = 'F' ORDER BY      s.County, sc.AvgScrRead DESC LIMIT (     SELECT COUNT(DISTINCT(school))      FROM schools      GROUP BY County      ORDER BY COUNT(*) ASC LIMIT 1 ) * 5;
SELECT      schools.School AS "School",     AVG(satscores.AvgScrWrite) AS "Average Writing Score" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.AdmFName1 = 'Ricci' AND schools.AdmLName1 = 'Ulrich' GROUP BY      schools.School;
SELECT schools.School AS "School Name", MAX(frpm.`Enrollment (K-12)`) AS "Max Enrollment" FROM schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE schools.DOC = '31' GROUP BY schools.School ORDER BY "Max Enrollment" DESC LIMIT 1;
SELECT COUNT(*) * 1.0 / 12 AS avg_monthly_openings  FROM schools  WHERE County='Alameda' AND DOC='52' AND strftime('%Y', OpenDate)='1980';
SELECT      SUM(CASE WHEN doc = '54' THEN 1 ELSE 0 END) AS unified_school_district_count,     SUM(CASE WHEN doc = '52' THEN 1 ELSE 0 END) AS elementary_school_district_count,     CAST(SUM(CASE WHEN doc = '54' THEN 1 ELSE 0 END) AS FLOAT) /         NULLIF(SUM(CASE WHEN doc = '52' THEN 1 ELSE 0 END), 0) AS ratio_unified_to_elementary FROM schools WHERE county = 'Orange';
SELECT      schools.School AS "School Name",      schools.Street AS "Postal Street Address" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds ORDER BY      satscores.AvgScrMath DESC LIMIT 1 OFFSET 6;
SELECT COUNT(*)  FROM frpm  WHERE      "County Name" = 'Los Angeles' AND      "Charter School (Y/N)" = 0 AND      ("Free Meal Count (K-12)" * 100 / "Enrollment (K-12)") < 0.18;
SELECT "Enrollment (Ages 5-17)" AS total_enrolled_students_ages_5_to_17 FROM frpm WHERE "EdOpsCode" = 'SSS' AND "City" = 'Fremont' AND "Academic Year" = '2014-2015';
SELECT      f.`School Name`,      ROUND((f.`FRPM Count (Ages 5-17)` / f.`Enrollment (Ages 5-17)`) * 100, 2) AS "Percent (%) Eligible FRPM (Ages 5-17)" FROM      frpm f JOIN      schools s ON f.CDSCode = s.CDSCode WHERE      s.County = 'Los Angeles' AND      s.GSserved = 'K-9';
SELECT      County AS "County",     COUNT(*) AS "Number of Schools" FROM      schools WHERE      County IN ('San Diego', 'Santa Barbara') AND Virtual = 'F' GROUP BY      County ORDER BY      COUNT(*) DESC LIMIT 1;
SELECT      GSoffered FROM      schools WHERE      ABS(Longitude) = (         SELECT MAX(ABS(Longitude))          FROM schools     );
SELECT COUNT(DISTINCT City) AS num_cities_with_K_8_and_multiple_provisions,        City,        COUNT(*) AS num_schools_per_city FROM schools WHERE Magnet = 1 AND GSserved = 'K-8' AND EXISTS (     SELECT *     FROM frpm     WHERE schools.CDSCode = frpm.CDSCode     AND frpm.`NSLP Provision Status` = 'Multiple Provision Types' ) GROUP BY City;
SELECT      f.`Percent (%) Eligible Free (K-12)`,     s.District AS "District Code" FROM      frpm f  JOIN      schools s ON f.CDSCode = s.CDSCode  WHERE      s.AdmFName1 = 'Alusine';
SELECT DISTINCT AdmEmail1  FROM schools  WHERE County='San Bernardino'  AND District='San Bernardino City Unified'  AND (SOC='62' OR DOC='54')  AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31' AND AdmEmail1 IS NOT NULL;
SELECT COUNT(DISTINCT account.account_id) FROM account  JOIN district ON account.district_id = district.district_id WHERE account.frequency = 'POPLATEK PO OBRATU' AND district.A3 = 'East Bohemia';
SELECT COUNT(DISTINCT d.district_id) FROM district AS d JOIN client AS c ON d.district_id = c.district_id WHERE c.gender = 'F' AND d.A11 > 6000 AND d.A11 < 10000;
SELECT COUNT(*) AS count_male_customers FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M' AND d.A3 = 'North Bohemia' AND d.A11 > 8000;
WITH OldestFemaleClients AS (     SELECT *     FROM client     WHERE gender = 'F'     AND birth_date = (SELECT MIN(birth_date) FROM client WHERE gender = 'F') ), AverageSalaryGap AS (     SELECT MAX(d.A11) - MIN(d.A11) AS Salary_Gap     FROM district d ) SELECT DISTINCT a.account_id AS Account_Number, asg.Salary_Gap FROM client c JOIN disp d ON c.client_id = d.client_id JOIN account a ON d.account_id = a.account_id CROSS JOIN AverageSalaryGap asg WHERE c.gender = 'F' AND c.birth_date IN (SELECT birth_date FROM OldestFemaleClients) ORDER BY (SELECT d.A11 FROM district d WHERE d.district_id = c.district_id) ASC LIMIT 1;
SELECT a.account_id FROM account AS a JOIN disp AS d ON a.account_id = d.account_id JOIN client AS c ON d.client_id = c.client_id WHERE c.birth_date = (     SELECT MAX(birth_date)     FROM client ) AND c.district_id IN (     SELECT district_id     FROM district     ORDER BY A11 DESC     LIMIT 1 );
SELECT l.account_id, MIN(l.amount) AS min_amount FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date LIKE '1997%' AND a.frequency = 'POPLATEK TYDNE' GROUP BY l.account_id ORDER BY min_amount ASC;
SELECT l.account_id, MAX(l.amount) AS max_amount FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.duration > 12 AND STRFTIME('%Y', a.date) = '1993' GROUP BY l.account_id ORDER BY max_amount DESC;
SELECT COUNT(DISTINCT c.client_id) FROM client AS c JOIN district AS d ON c.district_id = d.district_id WHERE c.gender = 'F' AND c.birth_date < '1950-01-01' AND d.A2 = 'Sokolov';
SELECT d.A2 AS District_Name FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.account_id IN (     SELECT acc.account_id     FROM disp acc     JOIN client c ON acc.client_id = c.client_id     WHERE c.gender = 'F' AND c.birth_date = '1976-01-29' );
SELECT      ROUND((SUM(CASE WHEN c.gender = 'M' THEN 1 ELSE 0 END) / COUNT(*)) * 100, 2) AS male_percentage FROM      client c JOIN      district d ON c.district_id = d.district_id WHERE      d.A3 = 'south Bohemia' ORDER BY      CAST(d.A4 AS INT) DESC LIMIT 1;
WITH FirstLoanClient AS (     SELECT l.account_id, c.client_id     FROM loan l     JOIN account a ON l.account_id = a.account_id     JOIN disp d ON a.account_id = d.account_id     JOIN client c ON d.client_id = c.client_id     WHERE l.date = '1993-07-05' ), BalanceDates AS (     SELECT t.balance, t.date     FROM trans t     JOIN FirstLoanClient f ON t.account_id = f.account_id     WHERE t.date IN ('1993-03-22', '1998-12-27') ) SELECT ((CASE WHEN MAX(date)='1998-12-27' THEN balance END)-(CASE WHEN MIN(date)='1993-03-22' THEN balance END))/(CASE WHEN MIN(date)='1993-03-22' THEN balance END)*100 AS increase_rate FROM BalanceDates;
SELECT      ROUND((SUM(CASE WHEN status='A' THEN amount ELSE 0 END)/SUM(amount)) * 100, 2) AS percentage_paid_no_issue FROM loan;
SELECT      ROUND((COUNT(CASE WHEN l.amount < 100000 AND l.status = 'C' THEN 1 ELSE NULL END) * 1.0 / COUNT(*)) * 100, 2)      AS percentage_running_no_issue  FROM loan l;
SELECT d.A2 AS district,         ((d.A13 - d.A12) / d.A12) * 100 AS unemployment_increment_rate_percentage FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp dp ON a.account_id = dp.account_id JOIN client c ON dp.client_id = c.client_id JOIN district d ON c.district_id = d.district_id WHERE l.status = 'D';
SELECT d.A2 AS District_Name, COUNT(c.client_id) AS Number_of_Female_Account_Holders FROM district d JOIN client c ON d.district_id = c.district_id WHERE c.gender = 'F' GROUP BY d.A2 ORDER BY Number_of_Female_Account_Holders DESC LIMIT 9;
SELECT COUNT(DISTINCT l.loan_id) FROM loan AS l JOIN account AS a ON l.account_id = a.account_id WHERE l.amount >= 250000 AND l.date BETWEEN '1995-01-01' AND '1997-12-31' AND a.frequency = 'POPLATEK MESICNE';
SELECT d.A2 AS district_name, t.amount FROM trans t JOIN account a ON t.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE t.type = 'VYDAJ' AND t.date LIKE '1996-01%' ORDER BY t.amount DESC LIMIT 10;
SELECT COUNT(DISTINCT l.account_id) AS num_accounts_with_running_contracts FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.status IN ('C', 'D') AND a.district_id = 1;
SELECT COUNT(*) AS num_male_clients FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M' AND d.district_id IN (     SELECT district_id     FROM district     ORDER BY A15 DESC     LIMIT 1 OFFSET 1 );
SELECT DISTINCT d.client_id AS Account_Holder_ID FROM disp d JOIN card c ON d.disp_id = c.disp_id JOIN trans t ON c.card_id = t.account AND t.operation = 'VYBER KARTOU' WHERE t.date >= '1998-01-01' AND t.date <= '1998-12-31' AND t.amount < (     SELECT AVG(amount)     FROM trans     WHERE operation = 'VYBER KARTOU'       AND date BETWEEN '1998-01-01' AND '1998-12-31' );
SELECT DISTINCT d.A3 AS Region, a.frequency AS Account_Type FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.account_id NOT IN (     SELECT l.account_id     FROM loan l ) AND d.A11 BETWEEN 8000 AND 9000 AND a.frequency <> 'OWNER';
SELECT AVG(district.A15) AS avg_crimes_1995 FROM district JOIN account ON district.district_id = account.district_id WHERE district.A15 > 4000 AND SUBSTR(account.date, 1, 4) >= '1997';
SELECT t.trans_id, t.date, t.amount, t.balance FROM trans AS t JOIN disp ON t.account_id = disp.account_id WHERE disp.client_id = 3356 AND t.operation = 'VYBER';
SELECT ROUND(COUNT(CASE WHEN c.gender='F' THEN 1 END)*100/COUNT(*), 2) AS percentage_of_female_clients FROM client c JOIN account a ON c.client_id = (     SELECT d.client_id      FROM disp d      WHERE d.account_id=a.account_id AND d.type='OWNER' ) JOIN district d ON a.district_id=d.district_id WHERE d.A11 > 10000;
SELECT ((SUM(CASE WHEN l.date >= '1997-01-01' AND l.date < '1998-01-01' THEN l.amount ELSE 0 END) -          SUM(CASE WHEN l.date >= '1996-01-01' AND l.date < '1997-01-01' THEN l.amount ELSE 0 END)) /         NULLIF(SUM(CASE WHEN l.date >= '1996-01-01' AND l.date < '1997-01-01' THEN l.amount ELSE 0 END), 0)) * 100 AS growth_rate FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE c.gender = 'M';
SELECT      COUNT(*) AS Frequency_Of_Statements_Request,     t.k_symbol AS Purpose_of_Payment FROM      trans t WHERE      t.account_id = 3 AND      t.amount = 3539;
SELECT ROUND(CAST(SUM(CASE WHEN c.gender = 'M' THEN 1 ELSE 0 END) AS FLOAT) * 100 / COUNT(*), 2) AS percentage_male_clients   FROM account a   JOIN disp d ON a.account_id = d.account_id   JOIN client c ON d.client_id = c.client_id   WHERE a.frequency = 'POPLATEK TYDNE';
SELECT DISTINCT account.account_id  FROM account  JOIN disp ON account.account_id = disp.account_id  JOIN client ON disp.client_id = client.client_id  WHERE client.gender = 'F'  AND client.district_id IN (     SELECT district_id      FROM district      ORDER BY A11 ASC      LIMIT 1 )  ORDER BY client.birth_date ASC  LIMIT 1;
SELECT AVG(amount) AS avg_loan_amount FROM loan WHERE status IN ('C','D') AND account_id IN (     SELECT DISTINCT account_id     FROM trans     WHERE k_symbol = 'POPLATEK PO OBRATU' );
SELECT c.client_id,         CAST((strftime('%Y', 'now') - strftime('%Y', c.birth_date)) -             ((strftime('%m-%d', 'now') < strftime('%m-%d', c.birth_date))) AS INT) AS age FROM client c JOIN disp d ON c.client_id = d.client_id AND d.type = 'OWNER' JOIN card crd ON d.disp_id = crd.disp_id AND crd.type = 'gold';
SELECT DISTINCT acc.account_id, dis.A2 AS district_name, dis.A3 AS district_region FROM account acc JOIN district dis ON acc.district_id = dis.district_id WHERE acc.date >= '1993-01-01' AND acc.date <= '1993-12-31' AND acc.frequency = 'POPLATEK PO OBRATU';
SELECT DISTINCT account.account_id, account.frequency FROM account JOIN district ON account.district_id = district.district_id WHERE district.A3 = 'East Bohemia' AND account.date BETWEEN '1995-01-01' AND '2000-12-31';
