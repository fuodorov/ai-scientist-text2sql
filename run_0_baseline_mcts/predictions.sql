SELECT      COUNT(CASE WHEN Currency = 'EUR' THEN 1 END) * 1.0 /     COUNT(CASE WHEN Currency = 'CZK' THEN 1 END) AS Ratio_EUR_to_CZK FROM customers;
SELECT      CustomerID, MIN(Consumption) AS MinConsumption FROM      yearmonth WHERE      SUBSTR(Date, 1, 4) BETWEEN '2012' AND '2012' AND      CustomerID IN (         SELECT CustomerID          FROM customers          WHERE Segment='LAM'     ) GROUP BY      CustomerID;
SELECT AVG(Consumption) AS avg_monthly_consumption  FROM yearmonth  WHERE SUBSTR(Date, 1, 4) = '2013' AND CustomerID IN (     SELECT CustomerID      FROM customers      WHERE Segment='SME' );
SELECT      SUM(CASE WHEN c.Currency='CZK' THEN y.Consumption ELSE 0 END) AS CZK_consumption,     SUM(CASE WHEN c.Currency='EUR' THEN y.Consumption ELSE 0 END) AS EUR_consumption,     SUM(CASE WHEN c.Currency='CZK' THEN y.Consumption ELSE 0 END) -     SUM(CASE WHEN c.Currency='EUR' THEN y.Consumption ELSE 0 END) AS Consumption_difference FROM yearmonth y JOIN customers c ON y.CustomerID=c.CustomerID WHERE SUBSTR(y.Date, 1, 4)='2012';
SELECT      SUBSTR(Date, 1, 4) AS Year,     SUM(Consumption) AS TotalConsumption FROM      yearmonth GROUP BY      Year ORDER BY      TotalConsumption DESC LIMIT 1;
SELECT      SUBSTR(Date, 5, 2) AS Month,     SUM(Consumption) AS TotalConsumption FROM      yearmonth WHERE      CustomerID IN (         SELECT CustomerID          FROM customers          WHERE Segment='SME'     ) AND      SUBSTR(Date, 1, 4)='2013' GROUP BY      SUBSTR(Date, 5, 2) ORDER BY      TotalConsumption DESC LIMIT 1;
WITH
WITH  segment_consumptions AS (     SELECT          c.Segment,         SUM(CASE WHEN SUBSTR(y.Date, 1, 4) = '2012' THEN y.Consumption ELSE 0 END) AS consumption_2012,         SUM(CASE WHEN SUBSTR(y.Date, 1, 4) = '2013' THEN y.Consumption ELSE 0 END) AS consumption_2013     FROM          yearmonth y     JOIN          customers c ON y.CustomerID = c.CustomerID     GROUP BY          c.Segment ), percentage_increase AS (     SELECT          Segment,         consumption_2013 - consumption_2012 AS increase_or_decrease,         CASE              WHEN consumption_2013 <> 0 THEN ((consumption_2013 - consumption_2012) / consumption_2013) * 100              ELSE NULL          END AS percentage_of_increase     FROM          segment_consumptions ) SELECT * FROM percentage_increase ORDER BY percentage_of_increase DESC;
SELECT SUM(Consumption) AS TotalConsumption  FROM yearmonth  WHERE CustomerID = 6 AND SUBSTR(Date, 1, 6) BETWEEN '201308' AND '201311';
SELECT      SUM(CASE WHEN Country='CZE' THEN 1 ELSE 0 END) -     SUM(CASE WHEN Country='SVK' THEN 1 ELSE 0 END) AS DifferenceInDiscountGasStations FROM gasstations WHERE Segment = 'Value for money';
SELECT      SUM(CASE WHEN c.Currency='CZK' THEN 1 ELSE 0 END) AS total_sme_czk,     SUM(CASE WHEN c.Currency='EUR' THEN 1 ELSE 0 END) AS total_sme_eur,     (         SUM(CASE WHEN c.Currency='CZK' THEN 1 ELSE 0 END) -         SUM(CASE WHEN c.Currency='EUR' THEN 1 ELSE 0 END)     ) AS amount_of_more_smes FROM customers c WHERE c.Segment = 'SME';
SELECT      ROUND((SUM(CASE WHEN Consumption > 46.73 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) AS percentage_consumed_more_than_46_73 FROM      yearmonth WHERE      CustomerID IN (         SELECT CustomerID         FROM customers         WHERE Segment = 'LAM'     );
SELECT      ROUND((COUNT(*) * 100.0 / total_customers), 2) AS Percentage FROM (     SELECT *     FROM yearmonth     WHERE Date = '201202'       AND Consumption > 528.3 ) filtered_customers, (     SELECT COUNT(DISTINCT CustomerID) as total_customers     FROM yearmonth     WHERE Date = '201202' ) total;
SELECT MAX(Consumption)  FROM yearmonth  WHERE SUBSTR(Date, 1, 4) = '2012';
SELECT DISTINCT p.Description  FROM products AS p JOIN transactions_1k AS t ON p.ProductID = t.ProductID WHERE EXISTS (     SELECT *      FROM yearmonth AS ym      WHERE ym.CustomerID = t.CustomerID AND SUBSTR(ym.Date, 1, 6) = '201309' );
SELECT DISTINCT gs.Country  FROM gasstations gs JOIN transactions_1k t ON gs.GasStationID = t.GasStationID WHERE SUBSTR(t.Date, 1, 6) = '201306';
SELECT COUNT(DISTINCT y.CustomerID)  FROM yearmonth AS y JOIN customers AS c ON y.CustomerID = c.CustomerID WHERE c.Currency = 'EUR' AND y.Consumption > 1000;
SELECT DISTINCT p.Description  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID JOIN products p ON t.ProductID = p.ProductID WHERE g.Country = 'CZE';
SELECT DISTINCT Time  FROM transactions_1k  WHERE GasStationID IN (     SELECT GasStationID      FROM gasstations      WHERE ChainID = 11 );
SELECT COUNT(*)  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID WHERE g.Country = 'CZE' AND t.Date > '2012-01-01';
SELECT c.Currency  FROM transactions_1k t  JOIN customers c ON t.CustomerID = c.CustomerID  WHERE t.Date='2012-08-24' AND t.Time='16:25:00';
SELECT c.Segment  FROM customers AS c JOIN transactions_1k AS t ON c.CustomerID = t.CustomerID WHERE t.Date = '2012-08-23' AND t.Time <= '21:20:00';
SELECT COUNT(*)  FROM transactions_1k t JOIN gasstations g ON t.GasStationID = g.GasStationID WHERE t.Date = '2012-08-26' AND t.Time BETWEEN '08:00:00' AND '09:00:00' AND g.Country = 'CZE';
SELECT c.Currency  FROM customers AS c JOIN transactions_1k AS t ON c.CustomerID = t.CustomerID WHERE t.Date = '2012-08-24' AND t.Price = 548.4;
SELECT      COUNT(CASE WHEN c.Currency='EUR' THEN 1 END) * 100.0 / COUNT(*) AS Percentage_EUR_Customers FROM transactions_1k t JOIN customers c ON t.CustomerID=c.CustomerID WHERE t.Date='2012-08-25';
SELECT      ((ym2012.Consumption - ym2013.Consumption) / ym2012.Consumption) AS DecreaseRate FROM (     SELECT *      FROM yearmonth      WHERE Date LIKE '2012%' ) ym2012 JOIN (     SELECT *     FROM yearmonth      WHERE Date LIKE '2013%' ) ym2013 ON ym2012.CustomerID = ym2013.CustomerID WHERE ym2012.CustomerID IN (     SELECT t.CustomerID     FROM transactions_1k t     WHERE t.Date = '2012-08-25'       AND t.Price = 634.8 );
SELECT      COUNT(CASE WHEN gs.Segment='Premium' THEN 1 END) * 100.0 / COUNT(*) AS PremiumPercentage FROM gasstations gs WHERE gs.Country = 'SVK';
SELECT SUM(t.Amount * t.Price) AS TotalSpent  FROM transactions_1k t WHERE t.CustomerID = 38508 AND t.Date = '2012-01';
SELECT      c.CustomerID AS TopSpendingCustomer,     AVG(t.Price * t.Amount / t.Amount) AS AveragePricePerItem,     c.Currency FROM      transactions_1k t JOIN      customers c ON t.CustomerID = c.CustomerID GROUP BY      c.CustomerID, c.Currency ORDER BY      SUM(t.Price * t.Amount) DESC LIMIT 1;
SELECT      y.Consumption AS Consumption_Status_August_2012 FROM      transactions_1k t JOIN      yearmonth y ON t.CustomerID = y.CustomerID AND y.Date = '201208' WHERE      t.ProductID = 5 AND (t.Price / t.Amount) > 29.00;
SELECT m.major_name  FROM major AS m JOIN member AS mem ON m.major_id = mem.link_to_major WHERE mem.first_name = 'Angela' AND mem.last_name = 'Sanders';
SELECT COUNT(*)  FROM attendance  JOIN member ON attendance.link_to_member = member.member_id  WHERE attendance.link_to_event IN (     SELECT event_id      FROM event      WHERE event_name = 'Women''s Soccer' ) AND member.t_shirt_size = 'Medium';
SELECT COUNT(*)  FROM (     SELECT e.event_id, e.type     FROM event e     JOIN attendance a ON e.event_id = a.link_to_event     GROUP BY e.event_id     HAVING COUNT(a.link_to_event) > 10 AND e.type = 'Meeting' ) AS subquery;
SELECT e.event_name  FROM event e JOIN attendance a ON e.event_id = a.link_to_event WHERE e.type <> 'Fundraiser' GROUP BY e.event_id, e.event_name HAVING COUNT(a.link_to_event) > 20;
SELECT SUM(i.amount) AS total_funds_received FROM income i  JOIN member m ON i.link_to_member = m.member_id WHERE m.position = 'Vice President';
SELECT m.first_name || ' ' || m.last_name AS full_name  FROM member m JOIN zip_code z ON m.zip = z.zip_code WHERE z.state = 'Illinois';
SELECT      e.expense_id,      e.expense_description,      e.approved FROM      expense AS e JOIN      budget AS b ON e.link_to_budget = b.budget_id JOIN      event AS ev ON b.link_to_event = ev.event_id WHERE      ev.event_name = 'October Meeting' AND      ev.event_date = '2019-10-08';
SELECT AVG(e.cost) AS avg_cost  FROM expense e JOIN member m ON e.link_to_member = m.member_id WHERE m.first_name = 'Elijah' AND m.last_name = 'Allen' AND SUBSTR(e.expense_date, 6, 2) IN ('09','10');
SELECT      SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2019' THEN b.spent ELSE 0 END) AS Total_Spent_2019,     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2020' THEN b.spent ELSE 0 END) AS Total_Spent_2020,     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2019' THEN b.spent ELSE 0 END) -     SUM(CASE WHEN SUBSTR(e.event_date, 1, 4) = '2020' THEN b.spent ELSE 0 END) AS Difference FROM      budget b JOIN      event e ON b.link_to_event = e.event_id;
SELECT notes  FROM income  WHERE source = 'Fundraising' AND date_received = '2019-09-14';
SELECT phone  FROM member  WHERE first_name = 'Carlo' AND last_name = 'Jacobs';
SELECT e.status  FROM event e  JOIN budget b ON e.event_id = b.link_to_event  JOIN expense ex ON b.budget_id = ex.link_to_budget  WHERE ex.expense_description = 'Post Cards, Posters'  AND ex.expense_date = '2019-08-20';
SELECT m.major_name  FROM major AS m JOIN member AS mem ON m.major_id = mem.link_to_major WHERE mem.first_name = 'Brent' AND mem.last_name = 'Thomason';
SELECT COUNT(*)  FROM member  WHERE link_to_major IN (     SELECT major_id      FROM major      WHERE major_name = 'Business' ) AND t_shirt_size = 'Medium';
SELECT m.department  FROM member AS mem JOIN major AS m ON mem.link_to_major = m.major_id WHERE mem.position = 'President';
SELECT i.date_received  FROM income AS i JOIN member AS m ON i.link_to_member = m.member_id WHERE m.first_name = 'Connor' AND m.last_name = 'Hilton' AND i.source = 'Dues';
SELECT      CASE WHEN SUM(CASE WHEN e.event_name = 'Yearly Kickoff' THEN b.amount ELSE 0 END) > SUM(CASE WHEN e.event_name = 'October Meeting' THEN b.amount ELSE 0 END) THEN COUNT(*) ELSE 0 END AS count_of_times FROM      budget b JOIN      event e ON b.link_to_event = e.event_id WHERE      b.category = 'Advertisement';
SELECT SUM(e.cost) AS total_pizza_cost  FROM expense e  WHERE e.expense_description = 'Pizza';
SELECT COUNT(DISTINCT city)  FROM zip_code  WHERE county = 'Orange County' AND state = 'Virginia';
SELECT mem.first_name, mem.last_name, maj.major_name   FROM member AS mem  JOIN major AS maj ON mem.link_to_major = maj.major_id  WHERE mem.phone = '809-555-3360';
SELECT COUNT(*)  FROM attendance a JOIN event e ON a.link_to_event = e.event_id WHERE e.event_name = 'Women''s Soccer';
SELECT m.first_name || ' ' || m.last_name AS full_name  FROM member m JOIN major maj ON m.link_to_major = maj.major_id WHERE maj.department = 'School of Applied Sciences, Technology and Education';
SELECT      e.event_name,      b.spent / b.amount AS spend_to_budget_ratio FROM      event e JOIN      budget b ON e.event_id = b.link_to_event WHERE      e.status = 'Closed' ORDER BY      spend_to_budget_ratio DESC LIMIT 1;
SELECT MAX(spent)  FROM budget;
SELECT SUM(spent)  FROM budget  WHERE category = 'Food';
SELECT      m.first_name || ' ' || m.last_name AS full_name FROM      member m JOIN      attendance a ON m.member_id = a.link_to_member GROUP BY      m.member_id, m.first_name, m.last_name HAVING      COUNT(a.link_to_event) > 7;
SELECT m.first_name || ' ' || m.last_name AS full_name  FROM member m JOIN budget b ON b.link_to_event = (     SELECT e.event_id      FROM event e      WHERE e.event_name = 'Yearly Kickoff' ) WHERE EXISTS (     SELECT 1      FROM expense ex      WHERE ex.link_to_member = m.member_id AND ex.link_to_budget = b.budget_id );
SELECT e.event_name  FROM event e  JOIN budget b ON e.event_id = b.link_to_event  ORDER BY b.spent ASC  LIMIT 1;
SELECT      (SUM(CASE WHEN e.event_name = 'Yearly Kickoff' THEN ex.cost ELSE 0 END) / NULLIF(SUM(ex.cost), 0)) * 100 AS Percentage FROM      expense ex JOIN      budget b ON ex.link_to_budget = b.budget_id JOIN      event e ON b.link_to_event = e.event_id;
SELECT      source, SUM(amount) AS total_amount FROM      income WHERE      date_received BETWEEN '2019-09-01' AND '2019-09-30' GROUP BY      source ORDER BY      total_amount DESC LIMIT 1;
SELECT COUNT(*)  FROM member m JOIN major ma ON m.link_to_major = ma.major_id WHERE ma.major_name = 'Physics Teaching';
SELECT e.event_name  FROM event e JOIN budget b ON e.event_id = b.link_to_event WHERE b.category = 'Advertisement' ORDER BY b.spent DESC LIMIT 1;
SELECT      a.link_to_event AS attended_event FROM      attendance a JOIN      member m ON a.link_to_member = m.member_id JOIN      event e ON a.link_to_event = e.event_id WHERE      m.first_name || ' ' || m.last_name = 'Maya Mclean' AND      e.event_name = 'Women''s Soccer';
SELECT e.cost  FROM expense AS e JOIN budget AS b ON e.link_to_budget = b.budget_id JOIN event AS ev ON b.link_to_event = ev.event_id WHERE ev.event_name = 'September Speaker' AND e.expense_description = 'Posters';
SELECT e.event_name  FROM event AS e JOIN budget AS b ON e.event_id = b.link_to_event WHERE e.status = 'Closed' AND b.remaining < 0 ORDER BY b.remaining ASC LIMIT 1;
SELECT      e.expense_description AS Type_of_Expense,     SUM(e.cost) AS Total_Value FROM      expense e JOIN      budget b ON e.link_to_budget = b.budget_id JOIN      event ev ON b.link_to_event = ev.event_id WHERE      ev.event_name = 'October Meeting' GROUP BY      e.expense_description;
SELECT      category,      SUM(amount) AS total_amount FROM      budget WHERE      link_to_event IN (         SELECT              event_id          FROM              event          WHERE              event_name = 'April Speaker'     ) GROUP BY      category ORDER BY      total_amount ASC;
SELECT SUM(cost) AS total_expense  FROM expense  WHERE expense_date = '2019-08-20';
SELECT      m.first_name || ' ' || m.last_name AS full_name,     SUM(e.cost) AS total_cost FROM      member m JOIN      expense e ON m.member_id = e.link_to_member WHERE      m.member_id = 'rec4BLdZHS2Blfp4v' GROUP BY      m.first_name, m.last_name;
SELECT e.expense_description  FROM expense AS e JOIN member AS m ON e.link_to_member = m.member_id WHERE m.first_name = 'Sacha' AND m.last_name = 'Harrison';
SELECT DISTINCT type  FROM event  WHERE location = 'MU 215';
SELECT m.last_name, maj.department, maj.college  FROM member AS m JOIN major AS maj ON m.link_to_major = maj.major_id WHERE maj.major_name = 'Environmental Engineering';
SELECT DISTINCT b.category  FROM budget AS b JOIN event AS e ON b.link_to_event = e.event_id WHERE e.location = 'MU 215' AND e.type = 'Guest Speaker' AND b.spent = 0;
SELECT      ROUND((COUNT(CASE WHEN i.amount = 50 THEN 1 ELSE NULL END) * 1.0 / COUNT(m.member_id)) * 100, 2) AS percentage  FROM      member m  LEFT JOIN      income i ON m.member_id = i.link_to_member  WHERE      m.t_shirt_size = 'Medium'  AND      m.position = 'Member';
SELECT event_name  FROM event  WHERE type = 'Game' AND status = 'Closed' AND event_date BETWEEN '2019-03-15' AND '2020-03-20';
SELECT m.first_name || ' ' || m.last_name AS full_name,         m.phone AS contact_number FROM member m JOIN expense e ON m.member_id = e.link_to_member WHERE e.cost > (     SELECT AVG(e2.cost)     FROM expense e2 ) GROUP BY m.member_id;
SELECT m.first_name || ' ' || m.last_name AS full_name, e.cost  FROM member m JOIN expense e ON m.member_id = e.link_to_member WHERE e.expense_description = 'Water, Veggie tray, supplies';
SELECT      m.first_name || ' ' || m.last_name AS full_name,     i.amount FROM      member m JOIN      income i ON m.member_id = i.link_to_member WHERE      i.date_received = '2019-09-09';
SELECT      SUM(CASE WHEN SEX='M' AND Admission='+' THEN 1 ELSE 0 END) AS InPatientCount,     SUM(CASE WHEN SEX='M' AND Admission='-' THEN 1 ELSE 0 END) AS OutPatientCount,     ROUND((SUM(CASE WHEN SEX='M' AND Admission='+' THEN 1 ELSE 0 END)*1.0 / NULLIF(SUM(CASE WHEN SEX='M' AND Admission='-' THEN 1 ELSE 0 END),0)-1)*100,2) AS PercentageDeviation FROM Patient;
SELECT      COUNT(CASE WHEN strftime('%Y', P.Birthday) > '1930' THEN P.ID END) * 100.0 / COUNT(*) AS Percentage FROM      Patient P WHERE      P.SEX = 'F';
SELECT      SUM(CASE WHEN Admission = '+' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN Admission = '-' THEN 1 ELSE 0 END), 0) AS Ratio_Outpatient_to_Inpatient FROM Patient WHERE Diagnosis = 'SLE';
SELECT p.Diagnosis, l.Date  FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE p.ID = 30609;
SELECT      p.ID,      p.SEX,      p.Birthday FROM      Patient AS p JOIN      Laboratory AS l ON p.ID = l.ID WHERE      l.LDH > 500;
SELECT      p.ID,      strftime('%Y', CURRENT_TIMESTAMP) - strftime('%Y', p.Birthday) AS Age FROM      Patient p JOIN      Examination e ON p.ID = e.ID WHERE      e.RVVT = '+';
SELECT      p.ID,      p.SEX,      e.Diagnosis FROM      Patient AS p JOIN      Examination AS e ON p.ID = e.ID WHERE      e.Thrombosis = 2;
SELECT COUNT(*) FROM Patient WHERE SEX = 'F' AND strftime('%Y', First_Date) = '1997' AND Admission = '-';
SELECT COUNT(*)  FROM Examination e JOIN Patient p ON e.ID = p.ID WHERE e.`Examination Date` >= '1997-01-01' AND e.`Examination Date` <= '1997-12-31' AND e.Thrombosis = 1 AND p.SEX = 'F';
SELECT      e.Symptoms AS Observed_Symptoms,     p.Diagnosis AS Patient_Diagnosis FROM      Examination e JOIN      Patient p ON e.ID = p.ID WHERE      e.Symptoms IS NOT NULL ORDER BY      p.Birthday DESC LIMIT 1;
SELECT      MIN(p.Birthday) AS OldestPatientBirthday,     l.Date AS LabWorkCompletionDate,     STRFTIME('%Y', p."First Date") - STRFTIME('%Y', p.Birthday) AS AgeAtHospitalArrival FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      p.Diagnosis LIKE '%SJS%' ORDER BY      p.Birthday ASC LIMIT 1;
SELECT      COUNT(CASE WHEN p.SEX = 'M' AND l.UA <= 8.0 THEN 1 END) /      CAST(COUNT(CASE WHEN p.SEX = 'F' AND l.UA <= 6.5 THEN 1 END) AS FLOAT) AS Ratio FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID;
SELECT COUNT(DISTINCT e.ID)   FROM Examination AS e  JOIN Patient AS p ON e.ID = p.ID  WHERE strftime('%Y', p.Birthday) <= strftime('%Y', e."Examination Date") - 18  AND strftime('%Y', e."Examination Date") BETWEEN '1990' AND '1993';
SELECT      strftime('%Y', Lab.Date) - strftime('%Y', Pat.Birthday) AS AgeAtExamination,     Pat.Diagnosis FROM      Laboratory Lab JOIN      Patient Pat ON Lab.ID = Pat.ID WHERE      Lab.HGB = (         SELECT MAX(HGB)          FROM Laboratory     );
SELECT e.`aCL IgM` FROM Examination AS e  JOIN Patient AS p ON e.ID = p.ID WHERE p.Diagnosis = 'SLE' AND p.Description = '1994-02-19' AND e.`Examination Date` = '1993-11-12';
SELECT      ((SUM(CASE WHEN l.Date LIKE '1981-11%' THEN l.`T-CHO` END) -        SUM(CASE WHEN l.Date LIKE '1981-12%' THEN l.`T-CHO` END)) /       NULLIF(SUM(CASE WHEN l.Date LIKE '1981-12%' THEN l.`T-CHO` END), 0)) FROM Laboratory AS l JOIN Patient AS p ON l.ID = p.ID WHERE p.Birthday = '1959-02-18';
SELECT DISTINCT p.ID  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.Date BETWEEN '1987-07-06' AND '1996-01-31' AND l.GPT > 30 AND l.ALB < 4;
SELECT COUNT(*)  FROM Examination E WHERE E.Thrombosis = 2 AND E.`ANA Pattern` = 'S' AND E.`aCL IgM` > (     SELECT AVG(E2.`aCL IgM`) * 1.2      FROM Examination E2 );
SELECT DISTINCT p.ID  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE p.Admission = '-' AND l.Date LIKE '1991-10%' AND l.`T-BIL` < 2.0;
SELECT AVG(l.ALB)  FROM Patient p  JOIN Laboratory l ON p.ID = l.ID  WHERE p.SEX = 'F' AND l.PLT > 400 AND p.Diagnosis = 'SLE';
SELECT COUNT(*)  FROM Patient p JOIN Examination e ON p.ID = e.ID WHERE p.SEX = 'F' AND e.Diagnosis = 'APS';
SELECT      ROUND((SUM(CASE WHEN SEX = 'F' THEN 1 ELSE 0 END) / CAST(COUNT(*) AS FLOAT)) * 100, 2) AS PercentageWomen FROM Patient WHERE strftime('%Y', Birthday) = '1980' AND Diagnosis = 'RA';
SELECT      CASE WHEN ((UA > 8.0 AND SEX = 'M') OR (UA > 6.5 AND SEX = 'F')) THEN 'Yes'          ELSE 'No' END AS Within_Normal_Range FROM Laboratory l JOIN Patient p ON l.ID = p.ID WHERE l.ID = 57266;
SELECT DISTINCT p.ID  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.GPT >= 60;
SELECT p.Diagnosis  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.GPT > 60 ORDER BY p.Birthday ASC;
SELECT p.ID, p.SEX, p.Birthday  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.UN = 29;
SELECT      SEX,      GROUP_CONCAT(DISTINCT Patient.ID) AS Patients FROM      Patient JOIN      Laboratory ON Patient.ID = Laboratory.ID WHERE      Laboratory.`T-BIL` >= 2.0 GROUP BY      SEX;
SELECT AVG((strftime('%Y', 'now') - strftime('%Y', p.Birthday))) AS AverageAge  FROM Patient p  JOIN Laboratory l ON p.ID = l.ID  WHERE p.SEX = 'M' AND l.`T-CHO` >= 250;
SELECT COUNT(DISTINCT p.ID)  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.TG >= 200 AND (     CAST(strftime('%Y', CURRENT_TIMESTAMP) AS INT) -     CAST(strftime('%Y', p.Birthday) AS INT) > 50 );
SELECT COUNT(DISTINCT p.ID)  FROM Patient p   JOIN Laboratory l ON p.ID = l.ID  WHERE STRFTIME('%Y', p.Birthday) BETWEEN '1936' AND '1956'  AND p.SEX = 'M'  AND l.CPK >= 250;
SELECT DISTINCT     p.ID,      p.SEX,      strftime('%Y', 'now') - strftime('%Y', p.Birthday) AS Age FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.GLU >= 180 AND l.`T-CHO` < 250;
SELECT      p.ID,      p.Diagnosis,      EXTRACT(YEAR FROM CURRENT_TIMESTAMP) - EXTRACT(YEAR FROM p.Birthday) AS Age FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.RBC < 3.5;
SELECT p.ID, p.SEX  FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE p.Diagnosis = 'SLE' AND l.HGB > 10 AND l.HGB < 17  ORDER BY p.Birthday ASC  LIMIT 1;
SELECT      p.ID,      CASE          WHEN p.Birthday IS NOT NULL THEN              strftime('%Y', CURRENT_TIMESTAMP) - strftime('%Y', p.Birthday)          ELSE NULL      END AS Age FROM      Patient p WHERE EXISTS (     SELECT 1     FROM Laboratory l     WHERE l.ID = p.ID AND l.HCT >= 52     GROUP BY l.ID     HAVING COUNT(DISTINCT l.Date) >= 2 );
SELECT      COUNT(CASE WHEN PLT < 100 THEN 1 END) AS LowerThanNormalRangeCount,     COUNT(CASE WHEN PLT > 400 THEN 1 END) AS HigherThanNormalRangeCount,     COUNT(CASE WHEN PLT < 100 THEN 1 END) - COUNT(CASE WHEN PLT > 400 THEN 1 END) AS Difference FROM Laboratory WHERE PLT IS NOT NULL AND (PLT <= 100 OR PLT >= 400);
SELECT DISTINCT p.ID   FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID  WHERE strftime('%Y', l.Date) = '1984'  AND (strftime('%Y', 'now') - strftime('%Y', p.Birthday)) < 50  AND l.PLT BETWEEN 100 AND 400;
SELECT      ROUND((SUM(CASE WHEN PT >= 14 AND SEX = 'F' THEN 1 ELSE 0 END) / NULLIF(SUM(CASE WHEN PT >= 14 THEN 1 ELSE 0 END), 0)) * 100, 2) AS Percentage_Female_Abnormal_PT  FROM (     SELECT p.SEX, l.PT      FROM Patient p      JOIN Laboratory l ON p.ID = l.ID      WHERE STRFTIME('%Y', CURRENT_TIMESTAMP) - STRFTIME('%Y', p.Birthday) > 55 ) subquery;
SELECT COUNT(DISTINCT p.ID) FROM Patient AS p  JOIN Laboratory AS l ON p.ID = l.ID WHERE p.SEX = 'M' AND l.WBC BETWEEN 3.5 AND 9.0 AND (l.FG <= 150 OR l.FG >= 450);
SELECT COUNT(DISTINCT ID)  FROM Laboratory  WHERE IGG >= 2000;
SELECT COUNT(*)  FROM Patient p JOIN Laboratory l ON p.ID = l.ID JOIN Examination e ON p.ID = e.ID WHERE l.IGG BETWEEN 900 AND 2000 AND e.Symptoms IS NOT NULL;
SELECT COUNT(DISTINCT p.ID)  FROM Patient p   JOIN Laboratory l ON p.ID = l.ID  WHERE l.IGA BETWEEN 80 AND 500   AND p."First Date" >= '1990-01-01';
SELECT      Diagnosis, COUNT(*) AS Frequency FROM      Patient p JOIN      Laboratory l ON p.ID = l.ID WHERE      l.IGM <= 40 OR l.IGM >= 400 GROUP BY      Diagnosis ORDER BY      Frequency DESC LIMIT 1;
SELECT COUNT(*)  FROM Patient p WHERE p.Description IS NULL AND EXISTS (     SELECT *      FROM Laboratory l     WHERE l.ID = p.ID AND l.CRP = '+' );
SELECT COUNT(*) FROM Patient p  JOIN Laboratory l ON p.ID = l.ID  WHERE l.CRE >= 1.5  AND ((strftime('%Y', 'now') - strftime('%Y', p.Birthday)) < 70);
SELECT COUNT(DISTINCT p.ID) FROM Patient p  JOIN Laboratory l ON p.ID = l.ID WHERE l.RNP IN ('-', '+-') AND p.Admission = '+';
SELECT COUNT(*) FROM Examination e  JOIN Laboratory l ON e.ID = l.ID WHERE l.SM IN ('-', '+-') AND e.Thrombosis = 0;
SELECT COUNT(DISTINCT p.ID) FROM Patient AS p  JOIN Examination AS e ON p.ID = e.ID JOIN Laboratory AS l ON p.ID = l.ID WHERE l.SC170 IN ('-', '0') AND p.SEX = 'F' AND e.Symptoms IS NULL;
SELECT COUNT(DISTINCT p.ID)  FROM Patient AS p JOIN Laboratory AS l ON p.ID = l.ID WHERE l.CENTROMEA IN ('-', '+-') AND l.SSB IN ('-', '+-') AND p.SEX = 'M';
SELECT MIN(P.Birthday) AS Youngest_Birthday  FROM Patient P  JOIN Laboratory L ON P.ID = L.ID  WHERE L.GOT >= 60;
SELECT COUNT(DISTINCT E.ID) AS Positive_Coagulation_Count  FROM Examination E JOIN Laboratory L ON E.ID = L.ID WHERE L.CPK < 250 AND (E.KCT = '+' OR E.RVVT = '+' OR E.LAC = '+');
SELECT l.name AS league_name, SUM(m.home_team_goal  m.away_team_goal) AS total_goals FROM Match m JOIN League l ON m.league_id = l.id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY total_goals DESC LIMIT 1;
SELECT t.team_long_name FROM Match m JOIN Team t ON m.away_team_api_id = t.team_api_id WHERE m.league_id IN (     SELECT l.id     FROM League l     JOIN Country c ON l.country_id = c.id     WHERE l.name = 'Scotland Premier League' ) AND m.season = '2009/2010' AND m.away_team_goal > m.home_team_goal GROUP BY m.away_team_api_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT team.team_long_name, ta.buildUpPlaySpeed AS Attack_Speed FROM Team_Attributes ta JOIN Team team ON ta.team_api_id = team.team_api_id ORDER BY ta.buildUpPlaySpeed DESC LIMIT 4;
SELECT l.name AS league_name FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY SUM(m.home_team_goal = m.away_team_goal) DESC LIMIT 1;
SELECT      p.player_name,     ROUND((julianday('now') - julianday(p.birthday)) / 365.25, 2) AS current_age FROM      Player p JOIN      Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE      pa.sprint_speed >= 97      AND strftime('%Y', pa.date) BETWEEN '2013' AND '2015';
SELECT l.name AS league_name, COUNT(*) AS total_matches FROM Match m JOIN League l ON m.league_id = l.id GROUP BY l.name ORDER BY total_matches DESC LIMIT 1;
SELECT team_fifa_api_id FROM Team_Attributes WHERE buildUpPlaySpeed > 50 AND buildUpPlaySpeed < 60;
SELECT t.team_long_name  FROM Team AS t  JOIN Team_Attributes AS ta ON t.team_api_id = ta.team_api_id  WHERE ta.buildUpPlayPassing > (     SELECT AVG(buildUpPlayPassing)     FROM Team_Attributes     WHERE buildUpPlayPassing IS NOT NULL AND strftime('%Y', date) = '2012' ) AND strftime('%Y', ta.date) = '2012';
SELECT ROUND(CAST(SUM(CASE WHEN pa.preferred_foot = 'left' THEN 1 ELSE 0 END) AS FLOAT) * 100 / COUNT(p.player_api_id), 2) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE STRFTIME('%Y', p.birthday) BETWEEN '1987' AND '1992';
SELECT AVG(pa.long_shots) AS avg_long_shots FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Ahmed Samir Farag';
SELECT p.player_name, AVG(pa.heading_accuracy) AS avg_heading_accuracy FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.height > 180 GROUP BY p.player_name ORDER BY avg_heading_accuracy DESC LIMIT 10;
SELECT l.name AS league_name FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2009/2010' GROUP BY l.name HAVING AVG(m.home_team_goal) > AVG(m.away_team_goal) ORDER BY AVG(m.home_team_goal) DESC;
SELECT * FROM Player WHERE SUBSTR(birthday, 1, 4) = '1970' AND SUBSTR(birthday, 6, 2) = '10';
SELECT pa.overall_rating FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Gabriel Tamas' AND strftime('%Y', pa.date) = '2011';
SELECT AVG(m.home_team_goal) FROM Match m JOIN Country c ON m.country_id = c.id WHERE c.name = 'Poland' AND m.season = '2010/2011';
SELECT p.player_name, AVG(pa.finishing) AS avg_finishing FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.height IN ((SELECT MAX(height) FROM Player), (SELECT MIN(height) FROM Player)) GROUP BY p.player_name ORDER BY avg_finishing DESC LIMIT 1;
SELECT AVG(t2.overall_rating) FROM Player AS t1 JOIN Player_Attributes AS t2 ON t1.player_api_id = t2.player_api_id WHERE t1.height > 170 AND strftime('%Y', t2.date) BETWEEN '2010' AND '2015';
SELECT      AVG(CASE WHEN p.player_name = 'Abdou Diallo' THEN pa.ball_control ELSE NULL END)     - AVG(CASE WHEN p.player_name = 'Aaron Appindangoye' THEN pa.ball_control ELSE NULL END) AS avg_ball_control_difference FROM Player_Attributes pa JOIN Player p ON pa.player_api_id = p.player_api_id;
SELECT p.player_name, p.birthday FROM Player AS p WHERE p.player_name IN ('Aaron Lennon', 'Abdelaziz Barrada') ORDER BY p.birthday ASC;
SELECT player_name, MAX(height) AS max_height   FROM Player;
SELECT COUNT(*)  FROM Player_Attributes WHERE preferred_foot = 'left' AND attacking_work_rate = 'low';
SELECT COUNT(DISTINCT pa.player_api_id) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE strftime('%Y', p.birthday) < '1986' AND pa.defensive_work_rate = 'high';
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.volleys > 70 AND pa.dribbling > 70;
SELECT COUNT(*) AS number_of_matches FROM Match m JOIN League l ON m.league_id = l.id WHERE l.name = 'Belgium Jupiler League' AND SUBSTR(m.date, 1, 7) = '2009-04';
SELECT l.name AS league_name FROM League l JOIN Match m ON l.id = m.league_id WHERE m.season = '2008/2009' GROUP BY l.name ORDER BY COUNT(*) DESC LIMIT 1;
SELECT      ROUND((CAST((pa_borysiuk.overall_rating - pa_puel.overall_rating) AS FLOAT) / pa_puel.overall_rating * 100), 2) FROM      Player p_borysiuk JOIN      Player_Attributes pa_borysiuk ON p_borysiuk.player_api_id = pa_borysiuk.player_api_id AND p_borysiuk.player_name = 'Ariel Borysiuk' CROSS JOIN      Player p_puel JOIN      Player_Attributes pa_puel ON p_puel.player_api_id = pa_puel.player_api_id AND p_puel.player_name = 'Paulin Puel';
SELECT AVG(PA.overall_rating) AS avg_overall_rating FROM Player P JOIN Player_Attributes PA ON P.player_api_id = PA.player_api_id WHERE P.player_name = 'Pietro Marino';
SELECT MAX(TA.chanceCreationPassing) AS Highest_Chance_Creation_Passing_Score, TA.chanceCreationPassingClass FROM Team T JOIN Team_Attributes TA ON T.team_api_id = TA.team_api_id WHERE T.team_long_name = 'Ajax';
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.overall_rating = 77 AND pa.date LIKE '2016-06-23%' ORDER BY p.birthday ASC LIMIT 1;
SELECT pa.overall_rating FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Aaron Mooy' AND pa.date LIKE '2016-02-04%';
SELECT pa.attacking_work_rate FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Francesco Migliore' AND pa.date LIKE '2015-05-01%';
SELECT pa.date FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id WHERE p.player_name = 'Kevin Constant' ORDER BY pa.crossing DESC LIMIT 1;
SELECT ta.buildUpPlayPassingClass FROM Team t JOIN Team_Attributes ta ON t.team_api_id = ta.team_api_id WHERE t.team_long_name = 'FC Lorient' AND ta.date LIKE '2010-02-22%';
SELECT ta.defenceAggressionClass FROM Team t JOIN Team_Attributes ta ON t.team_api_id = ta.team_api_id WHERE t.team_long_name = 'Hannover 96' AND ta.date LIKE '2015-09-10%';
SELECT AVG(overall_rating) AS Average_Overall_Rating FROM Player_Attributes pa JOIN Player p ON pa.player_api_id = p.player_api_id WHERE p.player_name = 'Marko Arnautovic' AND SUBSTR(pa.date, 1, 10) BETWEEN '2007-02-22' AND '2016-04-21';
SELECT ROUND((pld.overall_rating - pjb.overall_rating) * 100.0 / pld.overall_rating, 2) FROM Player_Attributes AS pld JOIN Player AS pl ON pld.player_api_id = pl.player_api_id AND pl.player_name = 'Landon Donovan' CROSS JOIN Player_Attributes AS pjb JOIN Player AS pj ON pjb.player_api_id = pj.player_api_id AND pj.player_name = 'Jordan Bowery' WHERE pld.date = '2013-07-12' AND pjb.date = '2013-07-12';
SELECT player_name FROM Player ORDER BY height DESC LIMIT 1;
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.overall_rating = (SELECT MAX(overall_rating) FROM Player_Attributes)
SELECT p.player_name FROM Player AS p JOIN Player_Attributes AS pa ON p.player_api_id = pa.player_api_id WHERE pa.attacking_work_rate = 'high';
SELECT t.team_short_name   FROM Team AS t   JOIN Team_Attributes AS ta ON t.team_api_id = ta.team_api_id   WHERE ta.chanceCreationPassingClass = 'Safe'
SELECT COUNT(*)  FROM Player  WHERE player_name LIKE 'Aaron%' AND birthday > '1990';
SELECT pa1.jumping - pa2.jumping AS Jumping_Score_Difference FROM Player_Attributes pa1 JOIN Player_Attributes pa2 ON pa1.id <> pa2.id WHERE pa1.id = 6 AND pa2.id = 23;
SELECT player_api_id FROM Player_Attributes WHERE preferred_foot = 'right' ORDER BY potential ASC LIMIT 4;
SELECT COUNT(*) AS count_of_players_with_highest_crossing_potential_and_left_preferred_foot FROM Player_Attributes WHERE crossing = (SELECT MAX(crossing) FROM Player_Attributes) AND preferred_foot = 'left';
SELECT      m.home_team_goal AS Home_Team_Score,     m.away_team_goal AS Away_Team_Score FROM      Match m JOIN      League l ON m.league_id = l.id WHERE      m.date LIKE '2008-09-24%' AND l.name = 'Belgium Jupiler League';
SELECT buildUpPlaySpeedClass FROM Team_Attributes WHERE team_fifa_api_id IN (     SELECT team_fifa_api_id     FROM Team     WHERE team_long_name = 'KSV Cercle Brugge' )
SELECT finishing, curve FROM Player_Attributes pa JOIN Player p ON pa.player_api_id = p.player_api_id WHERE p.weight = (SELECT MAX(weight) FROM Player) LIMIT 1;
SELECT l.name AS league_name, COUNT(*) AS number_of_games FROM Match m JOIN League l ON m.league_id = l.id WHERE m.season = '2015/2016' GROUP BY l.name ORDER BY number_of_games DESC LIMIT 4;
SELECT T.team_long_name AS Full_Name_Away_Team FROM Match M JOIN Team T ON M.away_team_api_id = T.team_api_id WHERE M.away_team_goal = (SELECT MAX(away_team_goal) FROM Match) LIMIT 1;
SELECT player_name FROM Player WHERE player_api_id = (     SELECT player_api_id     FROM Player_Attributes     ORDER BY overall_rating DESC     LIMIT 1 ) LIMIT 1;
SELECT ROUND((CAST(SUM(CASE WHEN height < 180 AND overall_rating > 70 THEN 1 ELSE 0 END) AS FLOAT)/COUNT(*))*100, 2) FROM Player p JOIN Player_Attributes pa ON p.player_api_id = pa.player_api_id;
SELECT d.driverRef  FROM qualifying AS q   JOIN drivers AS d ON q.driverId = d.driverId   WHERE q.raceId = 20  AND q.position IS NULL
SELECT d.surname  FROM drivers AS d  JOIN qualifying AS q ON d.driverId = q.driverId  WHERE q.raceId = 19 AND q.q2 IS NOT NULL  ORDER BY CAST(REPLACE(q.q2, ':', '.') AS DECIMAL) ASC  LIMIT 1;
SELECT r.name  FROM races AS r  JOIN circuits AS c ON r.circuitId = c.circuitId  WHERE c.country = 'Germany';
SELECT      c.lat,      c.lng FROM      circuits AS c JOIN      races AS r ON c.circuitId = r.circuitId WHERE      r.name = 'Australian Grand Prix';
SELECT      c.lat,      c.lng  FROM      circuits AS c  JOIN      races AS r ON c.circuitId = r.circuitId  WHERE      r.name = 'Abu Dhabi Grand Prix';
SELECT q.q1  FROM qualifying AS q  JOIN drivers AS d ON q.driverId = d.driverId  WHERE q.raceId = 354 AND d.forename || ' ' || d.surname = 'Bruno Senna';
SELECT number  FROM qualifying  WHERE raceId = 903 AND q3 LIKE '%0:01:54%';
SELECT COUNT(*)  FROM results r JOIN races ra ON r.raceId = ra.raceId WHERE ra.name = 'Bahrain Grand Prix' AND ra.year = 2007 AND r.time IS NULL;
SELECT d.driverId, d.forename || ' ' || d.surname AS full_name, d.dob  FROM drivers d  JOIN results r ON d.driverId = r.driverId  WHERE r.raceId = 592 AND r.time IS NOT NULL  ORDER BY d.dob ASC  LIMIT 1;
SELECT d.url  FROM lapTimes AS lt  JOIN drivers AS d ON lt.driverId = d.driverId  WHERE lt.raceId = 161 AND lt.time LIKE '%0:01:27%'
SELECT lat, lng  FROM circuits  WHERE circuitId IN (     SELECT circuitId      FROM races      WHERE name = 'Malaysian Grand Prix' );
SELECT c.url  FROM constructors AS c JOIN constructorResults AS cr ON c.constructorId = cr.constructorId WHERE cr.raceId = 9 AND cr.points = (     SELECT MAX(cr2.points)      FROM constructorResults AS cr2      WHERE cr2.raceId = 9 );
SELECT d.code  FROM drivers AS d  JOIN qualifying AS q ON d.driverId = q.driverId  WHERE q.raceId = 45 AND q.q3 LIKE '%0:01:33%';
SELECT s.url  FROM seasons AS s  JOIN races AS r ON s.year = r.year  WHERE r.raceId = 901;
SELECT      d.driverId,      d.forename || ' ' || d.surname AS full_name,      d.dob FROM      results r JOIN      drivers d ON r.driverId = d.driverId WHERE      r.raceId = 872 AND r.time IS NOT NULL ORDER BY      d.dob DESC LIMIT 1;
SELECT d.nationality  FROM drivers AS d  JOIN results AS r ON d.driverId = r.driverId  WHERE r.fastestLapSpeed = (     SELECT MAX(fastestLapSpeed)      FROM results );
SELECT      ((results.fastestLapSpeed - r2.fastestLapSpeed) / results.fastestLapSpeed) * 100 AS percentage_faster FROM      results JOIN      drivers ON results.driverId = drivers.driverId JOIN      results r2 ON r2.raceId = 854 AND r2.driverId = drivers.driverId WHERE      results.raceId = 853  AND      drivers.forename = 'Paul'  AND      drivers.surname = 'di Resta';
SELECT      ROUND((COUNT(CASE WHEN r.time IS NOT NULL THEN r.driverId END) * 1.0 / COUNT(r.driverId)) * 100, 2) AS percentage FROM      results r JOIN      races ra ON r.raceId = ra.raceId WHERE      ra.date = '1983-07-16';
SELECT name  FROM races  WHERE STRFTIME('%Y-%m', date) = (     SELECT MIN(STRFTIME('%Y-%m', date))     FROM races );
SELECT      d.forename || ' ' || d.surname AS "Full Name",     MAX(ds.points) AS Points FROM      driverStandings ds JOIN      drivers d ON ds.driverId = d.driverId;
SELECT      d.forename || ' ' || d.surname AS DriverName,     r.name AS RaceName,     MIN(lt.milliseconds) AS BestLapTime FROM      lapTimes lt JOIN      drivers d ON lt.driverId = d.driverId JOIN      races r ON lt.raceId = r.raceId GROUP BY      d.driverId, r.raceId ORDER BY      BestLapTime ASC LIMIT 1;
SELECT AVG(lt.milliseconds) AS avg_lap_time  FROM lapTimes lt  JOIN drivers d ON lt.driverId = d.driverId  JOIN races r ON lt.raceId = r.raceId  WHERE d.forename || ' ' || d.surname = 'Lewis Hamilton' AND r.year = 2009 AND r.name = 'Malaysian Grand Prix';
SELECT      ROUND((CAST(SUM(CASE WHEN r.position > 1 THEN 1 ELSE 0 END) AS FLOAT) / COUNT(r.resultId)) * 100, 2) as Percentage  FROM      results r  JOIN      drivers d ON r.driverId = d.driverId  JOIN      races ra ON r.raceId = ra.raceId  WHERE      d.surname = 'Hamilton'  AND      ra.year >= 2010;
SELECT      d.forename || ' ' || d.surname AS full_name,     d.nationality,     MAX(ds.points) AS max_points FROM      driverStandings ds JOIN      drivers d ON ds.driverId = d.driverId GROUP BY      ds.driverId ORDER BY      SUM(ds.wins) DESC LIMIT 1;
SELECT      MIN(strftime('%Y', 'now') - strftime('%Y', dob)) AS Age,     forename || ' ' || surname AS FullName FROM      drivers WHERE      nationality = 'Japanese';
SELECT      r.name AS Race_Name, c.name AS Circuit_Name, c.location AS Location FROM      races r JOIN      circuits c ON r.circuitId = c.circuitId WHERE      STRFTIME('%m', r.date) = '09' AND STRFTIME('%Y', r.date) = '2005';
SELECT r.name  FROM races AS r  JOIN results AS res ON r.raceId = res.raceId  JOIN drivers AS d ON res.driverId = d.driverId  WHERE d.forename || ' ' || d.surname = 'Alex Yoong' AND res.position < 20;
SELECT r.name AS RaceName, r.year  FROM results res JOIN races r ON res.raceId = r.raceId JOIN drivers d ON res.driverId = d.driverId WHERE d.forename || ' ' || d.surname = 'Michael Schumacher' ORDER BY res.milliseconds ASC LIMIT 1;
SELECT      r.name AS RaceName,      res.points AS PointsScored FROM      races r JOIN      results res ON r.raceId = res.raceId JOIN      drivers d ON res.driverId = d.driverId WHERE      d.forename || ' ' || d.surname = 'Lewis Hamilton' ORDER BY      r.year ASC LIMIT 1;
SELECT      ROUND((COUNT(CASE WHEN c.country = 'Germany' THEN r.raceId ELSE NULL END) * 1.0 / COUNT(r.raceId)) * 100, 2) AS percentage  FROM      races r  JOIN      circuits c ON r.circuitId = c.circuitId  WHERE      r.name = 'European Grand Prix';
SELECT lat, lng  FROM circuits  WHERE name = 'Silverstone Circuit';
SELECT circuitRef  FROM circuits  WHERE name = 'Marina Bay Street Circuit';
SELECT nationality  FROM drivers  ORDER BY dob ASC  LIMIT 1;
SELECT d.driverRef  FROM results r  JOIN drivers d ON r.driverId = d.driverId  WHERE r.positionOrder = 1 AND r.raceId IN (     SELECT raceId      FROM races      WHERE name = 'Canadian Grand Prix' AND year = 2007 );
SELECT r.name AS RaceName, MIN(res.rank) AS HighestRank   FROM results res  JOIN drivers d ON res.driverId = d.driverId  JOIN races r ON res.raceId = r.raceId  WHERE d.forename || ' ' || d.surname = 'Lewis Hamilton'  GROUP BY r.name  ORDER BY HighestRank ASC  LIMIT 1;
SELECT MAX(results.fastestLapSpeed) FROM results  JOIN races ON results.raceId = races.raceId WHERE races.year = 2009 AND races.name = 'Spanish Grand Prix';
SELECT r.positionOrder  FROM results AS r JOIN drivers AS d ON r.driverId = d.driverId JOIN races AS rc ON r.raceId = rc.raceId WHERE d.forename = 'Lewis' AND d.surname = 'Hamilton' AND rc.year = 2008 AND rc.name = 'Chinese Grand Prix';
SELECT r.time  FROM results AS r  JOIN races AS rc ON r.raceId = rc.raceId  WHERE rc.year = 2008 AND rc.name = 'Chinese Grand Prix' AND r.rank = 2;
SELECT COUNT(DISTINCT d.driverId) AS participating_drivers_count  FROM drivers d JOIN results r ON d.driverId = r.driverId WHERE r.time IS NOT NULL AND r.raceId IN (     SELECT raceId      FROM races      WHERE name='Chinese Grand Prix' AND year=2008 );
WITH Champion AS (     SELECT          time AS champ_time     FROM          results     WHERE          raceId IN (             SELECT                  raceId              FROM                  races              WHERE                  name='Australian Grand Prix' AND year=2008         )          AND position=1 ), LastDriver AS (     SELECT          time AS last_time     FROM          results     WHERE          raceId IN (             SELECT                  raceId              FROM                  races              WHERE                  name='Australian Grand Prix' AND year=2008         )          AND position=(SELECT MAX(position) FROM results WHERE raceId IN (SELECT raceId FROM races WHERE name='Australian Grand Prix' AND year=2008)) ) SELECT      ((STRFTIME('%s.%f',last_time)-STRFTIME('%s.%f',champ_time))/STRFTIME('%s.%f',last_time))*100 AS PercentageFaster FROM      Champion, LastDriver;
SELECT COUNT(*)  FROM circuits  WHERE location = 'Adelaide' AND country = 'Australia';
SELECT MAX(points)  FROM constructorResults  WHERE constructorId IN (     SELECT constructorId      FROM constructors      WHERE nationality='British' );
SELECT c.name  FROM constructors AS c JOIN constructorResults AS cr ON c.constructorId = cr.constructorId WHERE cr.points = 0 AND cr.raceId = 291;
SELECT COUNT(*)  FROM constructors c JOIN constructorResults cr ON c.constructorId = cr.constructorId WHERE c.nationality = 'Japanese' AND cr.points = 0 GROUP BY c.constructorId HAVING COUNT(cr.raceId) = 2;
SELECT      ROUND((SUM(CASE WHEN r.time IS NOT NULL THEN 1 ELSE 0 END)*1.0 / COUNT(r.driverId)) * 100, 2) AS CompletionPercentage  FROM      results r  JOIN      races ra ON r.raceId = ra.raceId
SELECT      ra.year AS Year,              AVG(STRFTIME('%s.%f', r.time)) AS Average_Time_Seconds  FROM        results r  JOIN        races ra ON r.raceId = ra.raceId  WHERE       ra.year < 1975  AND         r.position = 1  AND         r.time IS NOT NULL  GROUP BY    ra.year;
SELECT r.fastestLap  FROM results AS r  JOIN races AS ra ON r.raceId = ra.raceId  WHERE ra.year = 2009 AND r.positionOrder = 1;
SELECT AVG(results.fastestLapSpeed)  FROM results  JOIN races ON results.raceId = races.raceId  WHERE races.name = 'Spanish Grand Prix' AND races.year = 2009;
SELECT      ROUND((CAST(SUM(CASE WHEN strftime('%Y', d.dob) < '1985' AND r.laps > 50 THEN 1 ELSE 0 END) AS FLOAT) /            CAST(COUNT(DISTINCT CASE WHEN ra.year BETWEEN 2000 AND 2005 THEN d.driverId ELSE NULL END) AS FLOAT)) * 100, 2) AS Percentage FROM drivers d  JOIN results r ON d.driverId = r.driverId JOIN races ra ON ra.raceId = r.raceId;
SELECT COUNT(DISTINCT d.driverId) FROM drivers AS d  JOIN lapTimes AS lt ON d.driverId = lt.driverId WHERE d.nationality = 'French' AND lt.milliseconds / 1000 < 120;
SELECT code  FROM drivers  WHERE nationality = 'American';
SELECT COUNT(*) AS netherlands_drivers_count  FROM (     SELECT *      FROM drivers      ORDER BY dob DESC      LIMIT 3 ) AS young_drivers  WHERE nationality = 'Dutch';
SELECT driverRef  FROM drivers  WHERE nationality = 'German'  ORDER BY dob ASC  LIMIT 1;
SELECT DISTINCT d.driverId, d.code   FROM drivers AS d  JOIN results AS r ON d.driverId = r.driverId  WHERE strftime('%Y', d.dob) = '1971' AND r.fastestLapTime IS NOT NULL;
SELECT COUNT(*)  FROM results  WHERE raceId BETWEEN 50 AND 100  AND statusId = 2  AND time IS NOT NULL;
SELECT      COUNT(*) AS total_races_in_austria,     c.location,     c.lat,     c.lng FROM      races r JOIN      circuits c ON r.circuitId = c.circuitId WHERE      c.country = 'Austria' GROUP BY      c.location, c.lat, c.lng;
SELECT      ra.year AS "Year",     dr.forename || ' ' || dr.surname AS "Driver Name",      ra.name AS "Race Name",      ra.date AS "Date",      ra.time AS "Time" FROM      qualifying qu JOIN      races ra ON qu.raceId = ra.raceId JOIN      drivers dr ON qu.driverId = dr.driverId WHERE      dr.dob = (         SELECT MAX(drivers.dob)         FROM qualifying         JOIN drivers ON qualifying.driverId = drivers.driverId     ) ORDER BY      ra.date ASC LIMIT 1;
SELECT      d.forename || ' ' || d.surname AS full_name,     AVG(p.duration) AS avg_pit_stop_duration FROM      drivers d JOIN      pitStops p ON d.driverId = p.driverId WHERE      d.nationality = 'German' AND      STRFTIME('%Y', d.dob) BETWEEN '1980' AND '1985' GROUP BY      d.driverId ORDER BY      avg_pit_stop_duration ASC LIMIT 3;
SELECT      d.forename || ' ' || d.surname AS ChampionName,     r.time AS FinishTime FROM      results r JOIN      drivers d ON r.driverId = d.driverId WHERE      r.position = 1 AND r.raceId IN (         SELECT              raceId          FROM              races          WHERE              name LIKE '%Canadian%' AND year = 2008     );
SELECT c.constructorRef, c.url  FROM constructors AS c  JOIN constructorStandings AS cs ON c.constructorId = cs.constructorId  WHERE cs.position = 1 AND cs.raceId IN (     SELECT r.raceId      FROM races AS r      WHERE r.name LIKE '%Singapore%' AND r.year = 2009 );
SELECT sp.power_name  FROM superpower AS sp JOIN hero_power AS hp ON sp.id = hp.power_id JOIN superhero AS sh ON hp.hero_id = sh.id WHERE sh.superhero_name = '3-D Man';
SELECT      MAX(cs.points) AS total_points,     c.name AS constructor_name,     c.nationality AS constructor_nationality FROM      constructorStandings cs JOIN      constructors c ON cs.constructorId = c.constructorId JOIN      races r ON cs.raceId = r.raceId WHERE      r.year BETWEEN 1980 AND 2010 AND      r.name LIKE '%Monaco%' GROUP BY      cs.constructorId;
SELECT d.forename || ' ' || d.surname AS FullName  FROM qualifying q  JOIN drivers d ON q.driverId = d.driverId  WHERE q.position = 1 AND q.q3 = (     SELECT MIN(q3)      FROM qualifying      WHERE raceId IN (         SELECT r.raceId          FROM races r          JOIN circuits c ON r.circuitId = c.circuitId          WHERE r.year = 2008 AND c.name = 'Marina Bay Street Circuit'     ) );
SELECT      d.forename || ' ' || d.surname AS FullName,     d.nationality,     r.name AS FirstRace FROM      drivers d JOIN (     SELECT          driverId,          MIN(raceId) as min_race_id     FROM          results     GROUP BY          driverId ) res ON d.driverId = res.driverId JOIN      races r ON res.min_race_id = r.raceId WHERE      d.dob = (SELECT MAX(dob) FROM drivers) LIMIT 1;
SELECT COUNT(*) AS accident_count  FROM results  WHERE statusId = 3 AND raceId IN (     SELECT raceId      FROM races      WHERE name LIKE '%Canadian%' ) AND driverId = (     SELECT driverId      FROM results      WHERE statusId = 3 AND raceId IN (         SELECT raceId          FROM races          WHERE name LIKE '%Canadian%'     )      GROUP BY driverId      ORDER BY COUNT(*) DESC      LIMIT 1 );
SELECT      d.forename || ' ' || d.surname AS FullName,     LT.time AS ShortestLapTime FROM      lapTimes LT JOIN      drivers d ON LT.driverId = d.driverId ORDER BY      LT.time ASC LIMIT 20;
SELECT      c.name AS circuit_name,     lt.lap,     MIN(lt.time) AS fastest_lap_time FROM      lapTimes lt JOIN      races r ON lt.raceId = r.raceId JOIN      circuits c ON r.circuitId = c.circuitId WHERE      c.country = 'Italy' GROUP BY      c.name, lt.lap;
SELECT COUNT(*)  FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sp.power_name = 'Super Strength' AND s.height_cm > 200;
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id AND c.colour = 'Blue' JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id AND sp.power_name = 'Agility';
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c_eyes ON s.eye_colour_id = c_eyes.id AND c_eyes.colour = 'Blue' JOIN colour AS c_hair ON s.hair_colour_id = c_hair.id AND c_hair.colour = 'Blond';
SELECT      s.superhero_name AS name,     s.height_cm AS height FROM      superhero s JOIN      publisher p ON s.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics' ORDER BY      s.height_cm DESC;
SELECT      c.colour AS eye_color,     COUNT(sh.id) AS number_of_superheroes FROM      superhero sh JOIN      colour c ON sh.eye_colour_id = c.id JOIN      publisher p ON sh.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics' GROUP BY      c.colour ORDER BY      number_of_superheroes DESC;
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Super Strength' AND s.publisher_id IN (     SELECT p.id      FROM publisher AS p      WHERE p.publisher_name = 'Marvel Comics' );
SELECT p.publisher_name  FROM publisher AS p JOIN superhero AS s ON p.id = s.publisher_id JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Speed' ) ORDER BY ha.attribute_value ASC LIMIT 1;
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.eye_colour_id = c.id JOIN publisher p ON s.publisher_id = p.id WHERE c.colour = 'Gold' AND p.publisher_name = 'Marvel Comics';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id JOIN attribute AS at ON ha.attribute_id = at.id WHERE at.attribute_name = 'Intelligence' ORDER BY ha.attribute_value ASC LIMIT 1;
SELECT r.race  FROM superhero s  JOIN race r ON s.race_id = r.id  WHERE s.superhero_name = 'Copycat';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Durability' ) AND ha.attribute_value < 50;
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Death Touch';
SELECT COUNT(*)  FROM superhero s JOIN hero_attribute ha ON s.id = ha.hero_id JOIN attribute a ON ha.attribute_id = a.id WHERE s.gender_id IN (     SELECT g.id      FROM gender g      WHERE g.gender = 'Female' ) AND a.attribute_name = 'Strength' AND ha.attribute_value = 100;
SELECT      COUNT(CASE WHEN s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END) AS bad_superheroes_count,     ROUND((CAST(COUNT(CASE WHEN s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END) AS REAL) / COUNT(s.id)) * 100, 2) AS percentage_of_bad_superheroes,     COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' AND s.alignment_id = a.id AND a.alignment = 'Bad' THEN 1 END) AS marvel_comics_bad_superheroes_count FROM      superhero s JOIN      alignment a ON s.alignment_id = a.id LEFT JOIN      publisher p ON s.publisher_id = p.id;
SELECT      (         COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) -          COUNT(CASE WHEN p.publisher_name = 'DC Comics' THEN s.id END)     ) AS Difference_in_Superheroes FROM superhero s JOIN publisher p ON s.publisher_id = p.id;
SELECT id  FROM publisher  WHERE publisher_name = 'Star Trek';
SELECT COUNT(*)  FROM superhero  WHERE full_name IS NULL;
SELECT AVG(sh.weight_kg) AS avg_weight  FROM superhero sh  JOIN gender g ON sh.gender_id = g.id  WHERE g.gender = 'Female';
SELECT DISTINCT sp.power_name  FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.gender_id IN (     SELECT g.id      FROM gender g      WHERE g.gender = 'Male' ) LIMIT 5;
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c ON s.eye_colour_id = c.id WHERE s.height_cm BETWEEN 170 AND 190 AND c.colour = 'No Colour';
SELECT c.colour AS hair_colour  FROM superhero s JOIN colour c ON s.hair_colour_id = c.id WHERE s.height_cm = 185 AND s.race_id IN (     SELECT r.id      FROM race r      WHERE r.race = 'Human' );
SELECT      ROUND((COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) * 100.0 / COUNT(*)), 2) AS marvel_percentage FROM      superhero s JOIN      publisher p ON s.publisher_id = p.id WHERE      s.height_cm BETWEEN 150 AND 180;
SELECT s.superhero_name  FROM superhero AS s JOIN gender AS g ON s.gender_id = g.id WHERE g.gender = 'Male' AND s.weight_kg > (     SELECT AVG(weight_kg)*0.79      FROM superhero )
SELECT sp.power_name  FROM hero_power hp JOIN superpower sp ON hp.power_id = sp.id WHERE hp.hero_id = 1
SELECT COUNT(DISTINCT hp.hero_id) FROM hero_power AS hp JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Stealth';
SELECT s.full_name  FROM superhero AS s  JOIN hero_attribute AS ha ON s.id = ha.hero_id  WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Strength' ) AND ha.attribute_value = (     SELECT MAX(attribute_value)      FROM hero_attribute      JOIN attribute ON hero_attribute.attribute_id = attribute.id      WHERE attribute.attribute_name = 'Strength' );
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id JOIN attribute AS at ON ha.attribute_id = at.id JOIN publisher AS p ON s.publisher_id = p.id WHERE at.attribute_name = 'Durability' AND p.publisher_name = 'Dark Horse Comics' ORDER BY ha.attribute_value DESC LIMIT 1;
SELECT      c1.colour AS eye_color,     c2.colour AS hair_color,     c3.colour AS skin_color FROM      superhero s JOIN      gender g ON s.gender_id = g.id AND g.gender = 'Female' JOIN      publisher p ON s.publisher_id = p.id AND p.publisher_name = 'Dark Horse Comics' LEFT JOIN      colour c1 ON s.eye_colour_id = c1.id LEFT JOIN      colour c2 ON s.hair_colour_id = c2.id LEFT JOIN      colour c3 ON s.skin_colour_id = c3.id;
SELECT s.superhero_name, p.publisher_name  FROM superhero AS s JOIN publisher AS p ON s.publisher_id = p.id WHERE s.hair_colour_id = s.skin_colour_id  AND s.hair_colour_id = s.eye_colour_id;
SELECT      ROUND(CAST(SUM(CASE WHEN c.colour = 'Blue' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*) * 100, 2) AS percentage FROM      superhero s JOIN      gender g ON s.gender_id = g.id JOIN      colour c ON s.skin_colour_id = c.id WHERE      g.gender = 'Female';
SELECT COUNT(*)  FROM hero_power hp JOIN superhero s ON hp.hero_id = s.id WHERE s.superhero_name = 'Amazo';
SELECT s.height_cm  FROM superhero AS s JOIN colour AS c ON s.eye_colour_id = c.id WHERE c.colour = 'Amber';
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c ON s.eye_colour_id = c.id AND s.hair_colour_id = c.id WHERE c.colour = 'Black';
SELECT s.superhero_name  FROM superhero AS s JOIN alignment AS a ON s.alignment_id = a.id WHERE a.alignment = 'Neutral';
SELECT COUNT(*)  FROM hero_attribute ha JOIN attribute a ON ha.attribute_id = a.id WHERE a.attribute_name = 'Strength' AND ha.attribute_value = (     SELECT MAX(attribute_value)      FROM hero_attribute haa     JOIN attribute aa ON haa.attribute_id = aa.id     WHERE aa.attribute_name = 'Strength' );
SELECT      ROUND((COUNT(CASE WHEN g.gender = 'Female' THEN s.id END) * 1.0 / COUNT(*)) * 100, 2) AS percentage_female_heroes FROM      superhero s JOIN      gender g ON s.gender_id = g.id JOIN      publisher p ON s.publisher_id = p.id WHERE      p.publisher_name = 'Marvel Comics';
SELECT      (         COALESCE((SELECT weight_kg FROM superhero WHERE full_name = 'Emil Blonsky'), 0) -          COALESCE((SELECT weight_kg FROM superhero WHERE full_name = 'Charles Chandler'), 0)     ) AS weight_difference;
SELECT AVG(height_cm) AS average_height  FROM superhero;
SELECT sp.power_name  FROM superhero sh JOIN hero_power hp ON sh.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id WHERE sh.superhero_name = 'Abomination';
SELECT s.superhero_name  FROM superhero AS s JOIN hero_attribute AS ha ON s.id = ha.hero_id WHERE ha.attribute_id IN (     SELECT id      FROM attribute      WHERE attribute_name = 'Speed' ) ORDER BY ha.attribute_value DESC LIMIT 1;
SELECT      attribute.attribute_name AS Attribute,     hero_attribute.attribute_value AS Value FROM      hero_attribute JOIN      attribute ON hero_attribute.attribute_id = attribute.id WHERE      hero_attribute.hero_id IN (         SELECT              id          FROM              superhero          WHERE              superhero_name = '3-D Man'     );
SELECT s.superhero_name  FROM superhero AS s JOIN colour AS c_eyes ON s.eye_colour_id = c_eyes.id AND c_eyes.colour = 'Blue' JOIN colour AS c_hair ON s.hair_colour_id = c_hair.id AND c_hair.colour = 'Brown';
SELECT      s.superhero_name, p.publisher_name FROM      superhero AS s JOIN      publisher AS p ON s.publisher_id = p.id WHERE      s.superhero_name IN ('Hawkman', 'Karate Kid', 'Speedy');
SELECT      ROUND((COUNT(*) * 100.0 / (SELECT COUNT(*) FROM superhero)), 2) AS percentage FROM      superhero s JOIN      colour c ON s.eye_colour_id = c.id WHERE      c.colour = 'Blue';
SELECT      COUNT(CASE WHEN g.gender = 'Female' THEN s.id END) AS males_count,     COUNT(CASE WHEN g.gender = 'Male' THEN s.id END) AS females_count,     CASE          WHEN COUNT(CASE WHEN g.gender = 'Male' THEN s.id END) > 0          THEN ROUND(CAST(COUNT(CASE WHEN g.gender = 'Female' THEN s.id END) AS numeric) /                   CAST(COUNT(CASE WHEN g.gender = 'Male' THEN s.id END) AS numeric), 2)         ELSE NULL     END AS ratio FROM superhero s JOIN gender g ON s.gender_id = g.id;
SELECT c.colour AS eye_colour  FROM superhero s  JOIN colour c ON s.eye_colour_id = c.id  WHERE s.full_name = 'Karen Beecher-Duncan';
SELECT      COUNT(CASE WHEN s.eye_colour_id = 7 THEN 1 END) -      COUNT(CASE WHEN s.eye_colour_id = 1 THEN 1 END) AS difference FROM superhero s WHERE (s.weight_kg IS NULL OR s.weight_kg = 0);
SELECT COUNT(*)  FROM superhero s JOIN colour c ON s.skin_colour_id = c.id WHERE c.colour = 'Green' AND s.alignment_id IN (     SELECT id FROM alignment WHERE alignment = 'Bad' );
SELECT s.superhero_name  FROM superhero AS s JOIN hero_power AS hp ON s.id = hp.hero_id JOIN superpower AS sp ON hp.power_id = sp.id WHERE sp.power_name = 'Wind Control' ORDER BY s.superhero_name ASC;
SELECT g.gender  FROM superhero s JOIN hero_power hp ON s.id = hp.hero_id JOIN superpower sp ON hp.power_id = sp.id JOIN gender g ON s.gender_id = g.id WHERE sp.power_name = 'Phoenix Force';
SELECT      COUNT(CASE WHEN p.publisher_name = 'DC Comics' THEN s.id END) AS dc_count,     COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) AS marvel_count,     COUNT(CASE WHEN p.publisher_name = 'DC Comics' THEN s.id END) - COUNT(CASE WHEN p.publisher_name = 'Marvel Comics' THEN s.id END) AS difference FROM superhero s JOIN publisher p ON s.publisher_id = p.id;
SELECT MAX(Reputation), DisplayName  FROM users  WHERE DisplayName IN ('Harlan', 'Jarrod Dixon')  GROUP BY DisplayName  ORDER BY MAX(Reputation) DESC  LIMIT 1
SELECT DisplayName  FROM users  WHERE strftime('%Y', CreationDate) = '2011';
SELECT COUNT(*)  FROM users  WHERE LastAccessDate > '2014-09-01';
SELECT p.OwnerDisplayName  FROM posts p  WHERE p.Title = 'Eliciting priors from experts';
SELECT COUNT(*)  FROM posts  WHERE OwnerDisplayName = 'csgillespie';
SELECT u.DisplayName  FROM posts p  JOIN users u ON p.LastEditorUserId = u.Id  WHERE p.Title = 'Examples for teaching: Correlation does not mean causation';
SELECT COUNT(*)  FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.Age > 65 AND p.Score >= 20;
SELECT p.Body  FROM posts AS p JOIN tags AS t ON p.Id = t.ExcerptPostId WHERE t.TagName = 'bayesian';
SELECT AVG(p.Score) AS AverageScore  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE u.DisplayName = 'csgillespie';
SELECT      ROUND((COUNT(CASE WHEN u.Age > 65 THEN p.Id END) * 1.0 / NULLIF(COUNT(p.Id), 0)) * 100, 2) AS ElderOwnershipPercentage  FROM      posts p  JOIN      users u ON p.OwnerUserId = u.Id  WHERE      p.Score > 5;
SELECT p.FavoriteCount  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE c.UserId = 3025 AND c.CreationDate = '2014-04-23 20:29:39';
SELECT      CASE WHEN p.ClosedDate IS NOT NULL THEN 'Well-finished' ELSE 'Not Well-finished' END AS Status FROM      comments c JOIN      posts p ON c.PostId = p.Id WHERE      c.UserId = 23853 AND c.CreationDate = '2013-07-12 09:08:18';
SELECT COUNT(*)  FROM posts  WHERE OwnerDisplayName = 'Tiago Pasqualini';
SELECT u.DisplayName  FROM votes v JOIN users u ON v.UserId = u.Id WHERE v.Id = 6347;
SELECT      COUNT(p.Id) / CAST(COUNT(v.Id) AS FLOAT) AS PostsToVotesRatio FROM      posts p LEFT JOIN      votes v ON p.OwnerUserId = v.UserId AND p.Id = v.PostId WHERE      p.OwnerUserId = 24;
SELECT ViewCount  FROM posts  WHERE Title = 'Integration of Weka and/or RapidMiner into Informatica PowerCenter/Developer';
SELECT Text  FROM comments  WHERE Score = 17;
SELECT u.DisplayName  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Text = 'thank you user93!';
SELECT      p.Title AS PostTitle,     u.DisplayName AS UserName,     u.Reputation AS UserReputation FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      p.Title = 'Understanding what Dassault iSight is doing?'
SELECT u.DisplayName  FROM posts p  JOIN users u ON p.OwnerUserId = u.Id  WHERE p.Title = 'Open source tools for visualizing multi-dimensional data';
SELECT c.Text  FROM comments AS c JOIN posts AS p ON c.PostId = p.Id WHERE p.Title = 'Why square the difference instead of taking the absolute value in standard deviation?' AND EXISTS (     SELECT 1      FROM postHistory AS ph      WHERE ph.UserId = c.UserId AND ph.PostId = p.Id );
SELECT u.DisplayName  FROM users AS u  JOIN votes AS v ON u.Id = v.UserId  JOIN posts AS p ON v.PostId = p.Id  WHERE v.BountyAmount = 50 AND p.Title LIKE '%variance%';
SELECT      p.Title AS PostTitle,     c.Text AS CommentText,     AVG(p.ViewCount) AS AverageViewCount FROM      posts p JOIN      comments c ON p.Id = c.PostId WHERE      p.Tags LIKE '%<humor>%' GROUP BY      p.Title, c.Text;
SELECT COUNT(*) AS NumberOfUsers  FROM (     SELECT UserId      FROM badges      GROUP BY UserId      HAVING COUNT(Name) > 5 ) AS BadgedUsers;
SELECT ph.UserId   FROM postHistory AS ph  JOIN posts AS p ON ph.PostId = p.Id  WHERE p.ViewCount >= 1000  GROUP BY ph.UserId, ph.PostId  HAVING COUNT(*) = 1;
SELECT      (         COUNT(CASE WHEN strftime('%Y', b.Date) = '2010' THEN 1 END) / CAST(COUNT(*) AS FLOAT) * 100 -         COUNT(CASE WHEN strftime('%Y', b.Date) = '2011' THEN 1 END) / CAST(COUNT(*) AS FLOAT) * 100     ) AS PercentageDifference FROM badges b WHERE b.Name = 'Student';
SELECT      AVG(u.UpVotes) AS Average_Up_Votes,     AVG(u.Age) AS Average_User_Age FROM      users u JOIN (     SELECT          p.OwnerUserId, COUNT(*) AS NumPosts     FROM          posts p     GROUP BY          p.OwnerUserId     HAVING          COUNT(*) > 10 ) AS post_counts ON u.Id = post_counts.OwnerUserId;
SELECT      CAST(SUM(CASE WHEN STRFTIME('%Y', CreationDate) = '2010' THEN 1 ELSE 0 END) AS FLOAT) /     SUM(CASE WHEN STRFTIME('%Y', CreationDate) = '2011' THEN 1 ELSE 0 END) AS Ratio FROM votes;
SELECT p.Id  FROM posts AS p WHERE p.OwnerDisplayName = 'slashnick' ORDER BY p.AnswerCount DESC LIMIT 1;
SELECT      p.OwnerDisplayName AS Author,     SUM(p.ViewCount) AS TotalViews FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      u.DisplayName IN ('Harvey Motulsky', 'Noah Snyder') GROUP BY      p.OwnerDisplayName;
SELECT DISTINCT p.Tags  FROM posts AS p  WHERE p.OwnerDisplayName = 'Mark Meckes' AND p.CommentCount = 0;
SELECT      ROUND((COUNT(CASE WHEN p.Tags LIKE '%<r>%' THEN p.Id END) * 100.0 / COUNT(p.Id)), 2) AS percentage FROM posts p JOIN users u ON p.OwnerUserId = u.Id WHERE u.DisplayName = 'Community';
SELECT      (         SELECT SUM(p.ViewCount)          FROM posts p          JOIN users u ON p.OwnerUserId = u.Id          WHERE u.DisplayName = 'Mornington'     ) - (         SELECT SUM(p.ViewCount)          FROM posts p          JOIN users u ON p.OwnerUserId = u.Id          WHERE u.DisplayName = 'Amos'     ) AS DifferenceInViewCount;
SELECT AVG(monthly_count) AS avg_monthly_links_created FROM (     SELECT COUNT(*) / 12.0 AS monthly_count      FROM postLinks pl     JOIN posts p ON pl.PostId = p.Id     WHERE STRFTIME('%Y', pl.CreationDate) = '2010' AND p.AnswerCount <= 2 ) subquery;
SELECT MIN(votes.CreationDate)  FROM votes  JOIN users ON votes.UserId = users.Id  WHERE users.DisplayName = 'chl';
SELECT u.DisplayName  FROM users AS u  JOIN badges AS b ON u.Id = b.UserId  WHERE b.Name = 'Autobiographer'  ORDER BY b.Date ASC  LIMIT 1;
SELECT COUNT(DISTINCT u.Id) FROM users AS u  JOIN posts AS p ON u.Id = p.OwnerUserId WHERE u.Location = 'United Kingdom' AND p.FavoriteCount >= 4;
SELECT p.Id, p.Title  FROM posts AS p  JOIN users AS u ON p.OwnerUserId = u.Id  WHERE u.DisplayName = 'Harvey Motulsky'  ORDER BY p.ViewCount DESC  LIMIT 1;
SELECT p.Id AS PostId, u.DisplayName  FROM posts p   JOIN users u ON p.OwnerUserId = u.Id  WHERE strftime('%Y', p.CreaionDate) = '2010'  ORDER BY p.FavoriteCount DESC  LIMIT 1;
SELECT      ROUND(         (             SUM(CASE WHEN STRFTIME('%Y', p.CreaionDate) = '2011' AND u.Reputation > 1000 THEN 1 ELSE 0 END)              /             CAST(NULLIF(COUNT(p.Id), 0) AS FLOAT)         ) * 100,          2     ) AS Percentage FROM posts p JOIN users u ON p.OwnerUserId = u.Id;
SELECT p.ViewCount AS TotalViews, u.DisplayName  FROM posts p  JOIN users u ON p.LastEditorUserId = u.Id  WHERE p.Title = 'Computer Game Datasets';
SELECT COUNT(*)  FROM comments  WHERE PostId = (     SELECT Id      FROM posts      ORDER BY Score DESC      LIMIT 1 );
SELECT c.Text AS CommentText, u.DisplayName  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.PostId IN (     SELECT p.Id      FROM posts p      WHERE p.Title = 'Analysing wind data with R' ) ORDER BY c.CreationDate DESC LIMIT 10;
SELECT      ROUND((SUM(CASE WHEN p.Score > 50 THEN 1 ELSE 0 END) * 100.0 / NULLIF(COUNT(p.Id), 0)), 2) AS PercentageAbove50Score FROM      posts p JOIN      users u ON p.OwnerUserId = u.Id WHERE      u.Reputation = (         SELECT MAX(Reputation)          FROM users     );
SELECT      ExcerptPostId,      WikiPostId  FROM      tags  WHERE      TagName = 'sample';
SELECT u.Reputation, u.UpVotes  FROM comments c JOIN users u ON c.UserId = u.Id WHERE c.Text = 'fine, you win :)';
SELECT c.Text  FROM comments AS c  JOIN posts AS p ON c.PostId = p.Id  WHERE p.ViewCount BETWEEN 100 AND 150  ORDER BY c.Score DESC  LIMIT 1;
SELECT COUNT(*)  FROM comments c JOIN posts p ON c.PostId = p.Id WHERE p.CommentCount = 1 AND c.Score = 0;
SELECT      COUNT(CASE WHEN u.UpVotes = 0 THEN c.UserId END)*100.0 / COUNT(c.UserId) AS Percentage FROM      comments c JOIN      users u ON c.UserId = u.Id WHERE      c.Score BETWEEN 5 AND 10;
SELECT * FROM cards  WHERE cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL;
SELECT * FROM cards  WHERE borderColor = 'borderless' AND (cardKingdomFoilId IS NULL OR cardKingdomId IS NULL);
SELECT      cards.name AS card_name,     cards.rarity AS card_rarity,     legalities.status AS ban_status,     legalities.format AS format_type FROM      cards JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.rarity = 'mythic' AND      legalities.status = 'Banned' AND      legalities.format = 'gladiator';
SELECT      cards.name AS card_name,     legalities.status AS legal_status FROM      cards JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.types = 'Artifact' AND      cards.side IS NULL AND      legalities.format = 'vintage';
SELECT c.id, c.artist  FROM cards AS c JOIN legalities AS l ON c.uuid = l.uuid WHERE (c.power = '*' OR c.power IS NULL) AND l.format = 'commander' AND l.status = 'Legal';
SELECT      c.id AS card_id,     c.text AS ruling_text,     CASE WHEN c.hasContentWarning = 1 THEN 'Yes' ELSE 'No' END AS has_missing_or_degraded_properties FROM      cards c WHERE      c.artist = 'Stephen Daniel';
SELECT      cards.name AS card_name,     cards.artist AS artist_name,     COUNT(rulings.id) AS num_rulings,     cards.isPromo AS is_promotional_printing FROM      cards JOIN      rulings ON cards.uuid = rulings.uuid GROUP BY      cards.uuid ORDER BY      num_rulings DESC LIMIT 1;
SELECT      ROUND((COUNT(foreign_data.id) / CAST((SELECT COUNT(*) FROM cards) AS FLOAT)) * 100, 2) AS percentage FROM      foreign_data WHERE      foreign_data.language = 'Chinese Simplified';
SELECT COUNT(*)  FROM cards  WHERE power='*';
SELECT borderColor  FROM cards  WHERE name='Ancestor''s Chosen';
SELECT      c.text AS RuleOfPlayingCard FROM      cards c WHERE      c.name = 'Benalish Knight';
SELECT      ROUND((COUNT(CASE WHEN borderColor='borderless' THEN id END)*1.0 / COUNT(id))*100, 2) AS PercentageBorderless FROM cards;
SELECT      ROUND((COUNT(foreign_data.id) * 100.0 / COUNT(cards.id)), 2) AS percentage FROM      cards LEFT JOIN      foreign_data ON cards.uuid = foreign_data.uuid WHERE      cards.isStorySpotlight = 1 AND      foreign_data.language = 'French' OR      cards.isStorySpotlight = 1;
SELECT COUNT(*)  FROM cards  WHERE originalType = 'Summon - Angel' AND subtypes != 'Angel';
SELECT id  FROM cards  WHERE duelDeck = 'a';
SELECT COUNT(*)  FROM cards  WHERE uuid IN (     SELECT uuid      FROM legalities      WHERE status = 'Banned' ) AND borderColor = 'white';
SELECT      c.name AS card_name,     fd.language AS translated_language FROM      cards c JOIN      foreign_data fd ON c.uuid = fd.uuid WHERE      c.originalType = 'Artifact' AND      c.colors LIKE '%B%' AND      fd.language IS NOT NULL;
SELECT manaCost  FROM cards  WHERE layout='normal' AND frameVersion='2003' AND borderColor='black' AND availability='mtgo,paper';
SELECT      ROUND((SUM(CASE WHEN isStorySpotlight = 1 AND isTextless = 0 THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) AS percentage_without_text_box,     id AS story_spotlight_id FROM cards WHERE isStorySpotlight = 1 GROUP BY id HAVING isTextless = 0;
SELECT COUNT(*)  FROM set_translations st JOIN sets s ON st.setCode = s.code WHERE st.language = 'Portuguese (Brasil)' AND s.block = 'Commander';
SELECT DISTINCT      fd.type AS German_Type,     c.subtypes AS Subtypes,     c.supertypes AS Supertypes FROM      foreign_data fd JOIN      cards c ON fd.uuid = c.uuid WHERE      fd.language = 'German' AND      c.subtypes IS NOT NULL AND      c.supertypes IS NOT NULL;
SELECT COUNT(*)  FROM cards  WHERE (power IS NULL OR power = '*') AND text LIKE '%triggered ability%';
SELECT COUNT(*)  FROM cards  WHERE uuid IN (     SELECT uuid      FROM rulings      WHERE text LIKE '%This is a triggered mana ability.%' ) AND uuid IN (     SELECT uuid      FROM legalities      WHERE format='premodern' ) AND side IS NULL;
SELECT fd.name  FROM cards AS c JOIN foreign_data AS fd ON c.uuid = fd.uuid WHERE fd.language = 'French' AND c.type LIKE '%Creature%' AND c.layout = 'normal' AND c.borderColor = 'black' AND c.artist = 'Matthew D. Wilson';
SELECT st.language  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE s.baseSetSize = 180 AND s.block = 'Ravnica';
SELECT      ROUND((COUNT(CASE WHEN c.hasContentWarning = 0 THEN 1 END) / COUNT(c.id)) * 100, 2) AS Percentage FROM      cards c JOIN      legalities l ON c.uuid = l.uuid WHERE      l.format = 'commander'  AND      l.status = 'legal';
SELECT      ROUND((         COUNT(CASE              WHEN fd.language = 'French' AND (c.power IS NULL OR c.power = '*')             THEN 1          END) /         CAST(COUNT(CASE              WHEN c.power IS NULL OR c.power = '*'             THEN 1          END) AS FLOAT)     ) * 100, 2) AS Percentage FROM foreign_data fd JOIN cards c ON fd.uuid = c.uuid;
SELECT language  FROM foreign_data  WHERE multiverseid = 149934
SELECT      ROUND((CAST(SUM(CASE WHEN isTextless = 1 AND layout = 'normal' THEN 1 ELSE 0 END) AS FLOAT) / COUNT(*) * 100), 2) AS Proportion FROM cards;
SELECT DISTINCT st.language  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE s.mcmName = 'Archenemy' AND s.code = 'ARC';
SELECT      fd.language FROM      foreign_data AS fd WHERE      fd.name = 'A Pedra Fellwar';
SELECT      CASE WHEN ca.convertedManaCost > ck.convertedManaCost THEN 'Serra Angel'          ELSE 'Shrine Keeper' END AS MoreExpensiveCard FROM (     SELECT convertedManaCost      FROM cards      WHERE name = 'Serra Angel' ) ca CROSS JOIN (     SELECT convertedManaCost      FROM cards      WHERE name = 'Shrine Keeper' ) ck;
SELECT st.translation  FROM set_translations AS st JOIN sets AS s ON st.setCode = s.code WHERE st.language = 'Italian' AND EXISTS (     SELECT 1      FROM cards      WHERE cards.name = 'Ancestor''s Chosen' AND cards.setCode = s.code );
SELECT      fd.name AS korean_name FROM      cards c JOIN      foreign_data fd ON c.uuid = fd.uuid WHERE      c.name = 'Ancestor''s Chosen' AND      fd.language = 'Korean'
SELECT COUNT(*)  FROM cards  WHERE artist = 'Adam Rex' AND setCode IN (     SELECT code      FROM sets      JOIN set_translations ON sets.code = set_translations.setCode      WHERE set_translations.translation = 'Hauptset Zehnte Edition' );
SELECT st.translation  FROM set_translations AS st  JOIN sets AS s ON st.setCode = s.code  WHERE s.name = 'Eighth Edition' AND st.language = 'Chinese Simplified';
SELECT      s.mtgoCode IS NOT NULL AS appeared_on_mtgo FROM      cards c JOIN      sets s ON c.setCode = s.code WHERE      c.name = 'Angel of Mercy';
SELECT COUNT(DISTINCT st.setCode) FROM sets s  JOIN set_translations st ON s.code = st.setCode WHERE s.block = 'Ice Age' AND st.language = 'Italian' AND st.translation IS NOT NULL;
SELECT      CASE WHEN EXISTS (         SELECT 1          FROM cards          JOIN sets ON cards.setCode = sets.code          WHERE cards.name = 'Adarkar Valkyrie' AND sets.isForeignOnly = 1     ) THEN 'Yes' ELSE 'No' END AS Result;
SELECT COUNT(*)  FROM sets s JOIN set_translations st ON s.code = st.setCode WHERE st.language = 'Italian' AND st.translation IS NOT NULL AND s.baseSetSize < 100;
SELECT DISTINCT artist  FROM cards  WHERE setCode='CNS' AND artist IN ('Jeremy Jarvis', 'Aaron Miller', 'Chippy');
SELECT COUNT(*)  FROM cards AS T1 JOIN sets AS T2 ON T1.setCode = T2.code WHERE T2.name = 'Coldsnap' AND T1.convertedManaCost > 5 AND (T1.power = '*' OR T1.power IS NULL);
SELECT fd.flavorText  FROM foreign_data AS fd  JOIN cards AS c ON fd.uuid = c.uuid  WHERE fd.language = 'Italian' AND c.name = 'Ancestor''s Chosen';
SELECT fd.text  FROM foreign_data AS fd JOIN cards AS c ON fd.uuid = c.uuid WHERE fd.language = 'Italian' AND c.name IN (     SELECT s.name      FROM sets AS s      JOIN cards AS c ON s.code = c.setCode      WHERE s.name = 'Coldsnap' );
SELECT fd.name  FROM foreign_data AS fd JOIN cards AS c ON fd.uuid = c.uuid WHERE fd.language = 'Italian' AND c.setCode IN (     SELECT s.code      FROM sets AS s      WHERE s.name = 'Coldsnap' ) AND c.convertedManaCost = (     SELECT MAX(c2.convertedManaCost)      FROM cards AS c2      JOIN sets AS s2 ON c2.setCode = s2.code      WHERE s2.name = 'Coldsnap' );
SELECT      ROUND((COUNT(CASE WHEN convertedManaCost = 7 THEN 1 END) * 100.0 / COUNT(*)), 2) AS Percentage FROM cards WHERE setCode IN (     SELECT code      FROM sets      WHERE name = 'Coldsnap' );
SELECT      ROUND(CAST(SUM(CASE WHEN cardKingdomFoilId IS NOT NULL AND cardKingdomId IS NOT NULL THEN 1 ELSE 0 END) AS FLOAT) /            CAST(COUNT(*) AS FLOAT) * 100, 2) AS percentage_of_powerful_cards  FROM cards  WHERE setCode='CNS';
SELECT      format AS play_format,      GROUP_CONCAT(c.name) AS card_names FROM      legalities l JOIN      cards c ON l.uuid = c.uuid WHERE      status = 'Banned' GROUP BY      format ORDER BY      COUNT(*) DESC LIMIT 1;
SELECT      cards.name AS card_name,     legalities.format AS banned_format FROM      cards JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.edhrecRank = 1 AND legalities.status = 'Banned';
SELECT      c.name AS card_name,     l.format AS legal_format FROM      cards c JOIN      sets s ON c.setCode = s.code JOIN      legalities l ON c.uuid = l.uuid WHERE      s.name = 'Hour of Devastation' AND l.status = 'Legal';
SELECT DISTINCT s.name  FROM sets AS s JOIN set_translations AS st ON s.code = st.setCode WHERE st.language = 'Korean' AND NOT EXISTS (     SELECT 1      FROM set_translations AS st_jap      WHERE st_jap.setCode = s.code AND st_jap.language LIKE '%Japanese%' );
SELECT DISTINCT      cards.frameVersion AS Frame_Style,     cards.name AS Card_Name,     legalities.status AS Legal_Status FROM      cards LEFT JOIN      legalities ON cards.uuid = legalities.uuid WHERE      cards.artist = 'Allen Williams' ORDER BY      Frame_Style;
SELECT bond_type  FROM bond  GROUP BY bond_type  ORDER BY COUNT(*) DESC  LIMIT 1;
SELECT      AVG(oxygen_count) AS avg_oxygen_atoms_per_molecule FROM (     SELECT          a.molecule_id,         COUNT(*) AS oxygen_count     FROM          atom a     JOIN          connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2     JOIN          bond b ON c.bond_id = b.bond_id AND b.bond_type = '-'     WHERE          a.element = 'o'     GROUP BY          a.molecule_id ) subquery;
SELECT AVG(single_bonds_per_mol) AS avg_single_bonds  FROM (     SELECT m.molecule_id, COUNT(*) as single_bonds_per_mol     FROM bond b     JOIN molecule m ON b.molecule_id = m.molecule_id     WHERE m.label = '+' AND b.bond_type = '-'     GROUP BY m.molecule_id ) subquery;
SELECT DISTINCT m.molecule_id  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '#' AND m.label = '+';
SELECT      SUM(CASE WHEN a.element = 'c' THEN 1 ELSE 0 END) * 100.0 / COUNT(*) AS percentage_of_carbon_in_double_bonds FROM      atom a JOIN      connected c ON a.atom_id IN (c.atom_id, c.atom_id2) JOIN      bond b ON c.bond_id = b.bond_id AND b.bond_type = '=';
SELECT DISTINCT a.element  FROM connected AS c JOIN atom AS a ON (a.atom_id = c.atom_id OR a.atom_id = c.atom_id2) WHERE c.bond_id = 'TR004_8_9';
SELECT DISTINCT a.element  FROM atom AS a JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond AS b ON c.bond_id = b.bond_id WHERE b.bond_type = '=';
SELECT a.element, m.label, COUNT(*) AS count  FROM atom a  JOIN molecule m ON a.molecule_id = m.molecule_id  WHERE a.element = 'h'  GROUP BY m.label  ORDER BY count DESC  LIMIT 1;
SELECT a.element  FROM atom AS a JOIN molecule AS m ON a.molecule_id = m.molecule_id WHERE m.label = '-' GROUP BY a.element ORDER BY COUNT(a.atom_id) ASC LIMIT 1;
SELECT bond.bond_type  FROM connected  JOIN bond ON connected.bond_id = bond.bond_id  WHERE (connected.atom_id = 'TR004_8' AND connected.atom_id2 = 'TR004_20')  OR (connected.atom_id = 'TR004_20' AND connected.atom_id2 = 'TR004_8');
SELECT COUNT(DISTINCT a.atom_id) AS count_atoms FROM atom a  JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE (a.element = 'i' OR a.element = 's') AND b.bond_type = '-';
SELECT      (COUNT(DISTINCT CASE WHEN a.element != 'f' THEN m.molecule_id END) * 100.0 /      COUNT(DISTINCT m.molecule_id)) AS percentage_without_fluorine FROM      molecule m JOIN      atom a ON m.molecule_id = a.molecule_id WHERE      m.label = '+';
SELECT      (COUNT(CASE WHEN bond.bond_type = '#' THEN 1 END) * 100.0 / COUNT(bond.bond_id)) AS percent FROM      bond JOIN      molecule ON bond.molecule_id = molecule.molecule_id WHERE      molecule.label = '+';
SELECT element  FROM atom  WHERE molecule_id = 'TR000'  ORDER BY element ASC  LIMIT 3;
SELECT      ROUND(         (COUNT(CASE WHEN bond.bond_type = '=' THEN 1 END) * 100.0 /          COUNT(bond.bond_id)),          5     ) AS percent FROM bond WHERE bond.molecule_id = 'TR008';
SELECT      ROUND(         (COUNT(CASE WHEN m.label = '+' THEN 1 END) * 100.0 / COUNT(*)),          3     ) AS percent FROM molecule m;
SELECT      ROUND(COUNT(CASE WHEN element = 'h' THEN 1 END) * 100.0 / COUNT(*), 4) AS percent_hydrogen FROM      atom WHERE      molecule_id = 'TR206';
SELECT a.element, m.label  FROM atom AS a  JOIN molecule AS m ON a.molecule_id = m.molecule_id  WHERE m.molecule_id = 'TR060';
SELECT      bond.bond_type AS Bond_Type,     COUNT(*) AS Count_Bonds,     molecule.label AS Carcinogenic_Status FROM      bond JOIN      molecule ON bond.molecule_id = molecule.molecule_id WHERE      bond.molecule_id = 'TR010' GROUP BY      bond.bond_type ORDER BY      Count_Bonds DESC LIMIT 1;
SELECT DISTINCT m.molecule_id  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '-' AND m.label = '-' ORDER BY m.molecule_id ASC LIMIT 3;
SELECT COUNT(*)  FROM connected  WHERE (atom_id = 'TR009_12' OR atom_id2 = 'TR009_12') AND bond_id IN (     SELECT bond_id      FROM bond      WHERE molecule_id = 'TR009' )
SELECT      bond.bond_type AS Bond_Type,     connected.atom_id AS Atom_ID1,     connected.atom_id2 AS Atom_ID2 FROM      bond JOIN      connected ON bond.bond_id = connected.bond_id WHERE      bond.bond_id = 'TR001_6_9';
SELECT COUNT(*)  FROM connected  WHERE atom_id = 'TR%_19' OR atom_id2 = 'TR%_19';
SELECT DISTINCT a.element  FROM atom AS a  WHERE a.molecule_id = 'TR004';
SELECT DISTINCT m.molecule_id  FROM atom a  JOIN molecule m ON a.molecule_id = m.molecule_id  WHERE SUBSTR(a.atom_id, 7, 2) BETWEEN '21' AND '25'  AND m.label = '+';
SELECT DISTINCT bond.bond_id  FROM bond JOIN connected ON bond.bond_id = connected.bond_id JOIN atom AS a1 ON connected.atom_id = a1.atom_id AND a1.element = 'p' JOIN atom AS a2 ON connected.atom_id2 = a2.atom_id AND a2.element = 'n';
SELECT m.label  FROM molecule AS m JOIN bond AS b ON m.molecule_id = b.molecule_id WHERE b.bond_type = '=' GROUP BY m.molecule_id ORDER BY COUNT(*) DESC LIMIT 1;
SELECT AVG(num_bonds) AS avg_num_bonds  FROM (     SELECT a.atom_id, COUNT(c.bond_id) as num_bonds     FROM atom a     LEFT JOIN connected c ON a.atom_id = c.atom_id     WHERE a.element = 'i'     GROUP BY a.atom_id ) subquery;
SELECT DISTINCT a.element  FROM atom AS a  WHERE a.atom_id NOT IN (SELECT atom_id FROM connected) OR a.atom_id NOT IN (SELECT atom_id2 FROM connected) ORDER BY a.element;
SELECT a.atom_id  FROM atom AS a JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond AS b ON c.bond_id = b.bond_id WHERE b.molecule_id = 'TR041' AND b.bond_type = '#';
SELECT a.element  FROM atom AS a  JOIN connected AS c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2  WHERE c.bond_id = 'TR144_8_19';
SELECT DISTINCT a.element  FROM bond AS b JOIN connected AS c ON b.bond_id = c.bond_id JOIN atom AS a ON (a.atom_id = c.atom_id OR a.atom_id = c.atom_id2) WHERE b.bond_type = '#';
SELECT      ROUND(         (SUM(CASE WHEN m.label = '+' THEN 1 ELSE 0 END) * 100.0) /         COUNT(b.bond_id),          5     ) AS ProportionOfSingleBondsCarcinogenic FROM      bond b JOIN      molecule m ON b.molecule_id = m.molecule_id WHERE      b.bond_type = '-';
SELECT COUNT(DISTINCT a.atom_id) AS total_atoms FROM atom a  JOIN connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN bond b ON c.bond_id = b.bond_id WHERE (a.element = 'p' OR a.element = 'br') AND b.bond_type = '#';
SELECT      (COUNT(CASE WHEN a.element = 'cl' THEN 1 END) * 100.0 / COUNT(a.atom_id)) AS percent_cl_in_single_bonds FROM      atom a JOIN      connected c ON a.atom_id = c.atom_id OR a.atom_id = c.atom_id2 JOIN      bond b ON c.bond_id = b.bond_id WHERE      b.bond_type = '-';
SELECT a.element AS element1, a2.element AS element2  FROM connected c JOIN atom a ON c.atom_id = a.atom_id JOIN atom a2 ON c.atom_id2 = a2.atom_id WHERE c.bond_id = 'TR001_10_11';
SELECT      (COUNT(CASE WHEN a.element = 'cl' THEN 1 END) * 100.0 / COUNT(DISTINCT m.molecule_id)) AS percentage FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id WHERE      m.label = '+';
SELECT      a.element AS toxicology_element FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id WHERE      m.label = '+' AND SUBSTR(a.atom_id, 7, 1) = '4';
SELECT      m.label AS Label,     SUM(CASE WHEN a.element = 'h' THEN 1 ELSE 0 END) * 1.0 / COUNT(a.atom_id) AS Ratio FROM      atom a JOIN      molecule m ON a.molecule_id = m.molecule_id WHERE      a.molecule_id = 'TR006' GROUP BY      m.label;
SELECT m.molecule_id  FROM molecule AS m JOIN atom AS a ON m.molecule_id = a.molecule_id WHERE m.label = '-' GROUP BY m.molecule_id HAVING COUNT(a.atom_id) > 5;
SELECT COUNT(*)  FROM satscores ss JOIN schools sc ON ss.cds = sc.CDSCode WHERE sc.Virtual = 'F' AND ss.AvgScrMath > 400;
SELECT CDSCode   FROM frpm   WHERE (`Enrollment (K-12)`  `Enrollment (Ages 5-17)`) > 500;
SELECT MAX(f.`Percent (%) Eligible Free (Ages 5-17)`) AS max_eligible_free_rate_ages_5_17 FROM satscores s JOIN frpm f ON s.cds = f.CDSCode WHERE (CAST(s.NumGE1500 AS REAL)/s.NumTstTakr > 0.3);
SELECT      s.CDSCode AS School_Code,     s.CharterNum AS Charter_Number,     ss.AvgScrWrite AS Average_Writing_Score FROM      schools s JOIN      satscores ss ON s.CDSCode = ss.cds WHERE      ss.AvgScrWrite > 499      AND s.CharterNum IS NOT NULL ORDER BY      ss.AvgScrWrite DESC;
SELECT      f.`School Name`,      s.Street || ', ' || s.City AS Full_Street_Address FROM      frpm f JOIN      schools s ON f.CDSCode = s.CDSCode WHERE      ABS(f.`Enrollment (K-12)` - f.`Enrollment (Ages 5-17)`) > 30;
SELECT      f."School Name"  FROM        frpm f  JOIN        satscores s  ON          f.CDSCode = s.cds  WHERE       (f."Free Meal Count (K-12)" / f."Enrollment (K-12)") > 0.1  AND         s.NumGE1500 >= 1;
SELECT      schools.School AS "School Name",      schools.FundingType AS "Funding Type" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.County = 'Riverside' GROUP BY      schools.School, schools.FundingType HAVING      AVG(satscores.AvgScrMath) > 400;
SELECT      schools.School AS "School Name",     COALESCE(schools.Street, '') || ', ' || COALESCE(schools.City, '') || ', ' || COALESCE(schools.State, '') || ', ' || COALESCE(schools.Zip, '') AS "Full Communication Address" FROM      schools  JOIN      frpm ON schools.CDSCode = frpm.CDSCode WHERE      schools.County = 'Monterey'  AND      schools.SOC IN ('66','67')  AND      frpm."Free Meal Count (Ages 5-17)" > 800;
SELECT      schools.School AS "School Name",     satscores.AvgScrWrite AS "Average Writing Score",     schools.Phone AS "Communication Number" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.OpenDate > '1991-12-31' OR schools.ClosedDate < '2000-01-01';
SELECT      s.School AS "School Name",     s.DOCType AS "DOC Type" FROM      frpm f JOIN      schools s ON f.CDSCode = s.CDSCode WHERE      s.FundingType = 'Locally funded' AND (     f."Enrollment (K-12)" - f."Enrollment (Ages 5-17)" ) > (     SELECT AVG(f2."Enrollment (K-12)" - f2."Enrollment (Ages 5-17)")     FROM frpm f2     JOIN schools s2 ON f2.CDSCode = s2.CDSCode     WHERE s2.FundingType = 'Locally funded' ) ORDER BY      f."Enrollment (K-12)" - f."Enrollment (Ages 5-17)" DESC;
SELECT      "School Name",      ("Free Meal Count (K-12)" / "Enrollment (K-12)") AS "Eligible Free Rate" FROM      frpm ORDER BY      "Enrollment (K-12)" DESC LIMIT 11 OFFSET 9;
SELECT       f."School Name" AS "School Name",     ROUND((f."FRPM Count (K-12)" / f."Enrollment (K-12)") * 100, 2) AS "Eligible Free or Reduced Price Meal Rate (%)" FROM         frpm f JOIN         schools s ON f.CDSCode = s.CDSCode WHERE        s.SOC = '66' ORDER BY     f."FRPM Count (K-12)" DESC LIMIT 5;
SELECT      schools.Street AS Street,     schools.City AS City,     schools.State AS State,     schools.Zip AS Zip FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds ORDER BY      CAST(satscores.NumGE1500 AS REAL)/satscores.NumTstTakr ASC LIMIT 1;
SELECT      s.AdmFName1 || ' ' || s.AdmLName1 AS Full_Name_Admin_1,     s.AdmFName2 || ' ' || s.AdmLName2 AS Full_Name_Admin_2,     s.AdmFName3 || ' ' || s.AdmLName3 AS Full_Name_Admin_3 FROM      satscores ss JOIN      schools s ON ss.cds = s.CDSCode ORDER BY      ss.NumGE1500 DESC LIMIT 1;
SELECT AVG(ss.NumTstTakr) AS AverageTestTakers  FROM satscores ss  JOIN schools sc ON ss.cds = sc.CDSCode  WHERE sc.County = 'Fresno' AND strftime('%Y', sc.OpenDate) = '1980';
SELECT      schools.Phone FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.District = 'Fresno Unified' ORDER BY      satscores.AvgScrRead ASC LIMIT 1;
SELECT      s.School AS "School Name",     ss.AvgScrRead AS "Average Reading Score" FROM      schools s JOIN      satscores ss ON s.CDSCode = ss.cds WHERE      s.Virtual = 'F' ORDER BY      s.County,      ss.AvgScrRead DESC LIMIT (     SELECT COUNT(DISTINCT County) * 5      FROM schools );
SELECT      schools.School AS "School",     AVG(satscores.AvgScrWrite) AS "Average Writing Score" FROM      schools JOIN      satscores ON schools.CDSCode = satscores.cds WHERE      schools.AdmFName1 = 'Ricci' AND schools.AdmLName1 = 'Ulrich' GROUP BY      schools.School;
SELECT      schools.School AS "School Name",      schools.County AS "County",     frpm."Enrollment (K-12)" AS "Total Enrollment" FROM        schools JOIN frpm ON schools.CDSCode = frpm.CDSCode WHERE       schools.DOC = '31' AND schools.GSserved LIKE '%K-12%' ORDER BY    frpm."Enrollment (K-12)" DESC LIMIT       1;
SELECT COUNT(*) * 1.0 / 12 AS avg_monthly_openings  FROM schools  WHERE County='Alameda' AND DOC='52' AND strftime('%Y',OpenDate)='1980';
SELECT      SUM(CASE WHEN doc = '54' THEN 1 ELSE 0 END) AS unified_school_district_count,     SUM(CASE WHEN doc = '52' THEN 1 ELSE 0 END) AS elementary_school_district_count,     CAST(SUM(CASE WHEN doc = '54' THEN 1 ELSE 0 END) AS FLOAT) /         NULLIF(SUM(CASE WHEN doc = '52' THEN 1 ELSE 0 END), 0) AS ratio_unified_to_elementary FROM schools WHERE county = 'Orange';
SELECT      sch.School AS "School Name",     sch.MailStreet AS "Postal Street Address" FROM      satscores ss JOIN      schools sch ON ss.cds = sch.CDSCode ORDER BY      ss.AvgScrMath DESC LIMIT 1 OFFSET 6;
SELECT COUNT(*)  FROM frpm f JOIN schools s ON f.CDSCode = s.CDSCode WHERE s.County = 'Los Angeles' AND s.Charter = 0 AND (`Free Meal Count (K-12)` * 100 / `Enrollment (K-12)`) < 0.18;
SELECT "Enrollment (Ages 5-17)" AS total_enrolled_students_ages_5_to_17 FROM frpm WHERE "Academic Year" = '2014-2015' AND EXISTS (     SELECT 1     FROM schools     WHERE schools.CDSCode = frpm.CDSCode     AND schools.EdOpsCode = 'SSS'     AND schools.City = 'Fremont' );
SELECT      f.`School Name`,      ROUND((f.`FRPM Count (Ages 5-17)` / f.`Enrollment (Ages 5-17)`) * 100, 2) AS "Percent (%) Eligible FRPM (Ages 5-17)" FROM      frpm f JOIN      schools s ON f.`CDSCode` = s.CDSCode WHERE      s.County = 'Los Angeles' AND      s.GSserved = 'K-9';
SELECT      County AS "County", COUNT(*) AS "Amount" FROM      schools WHERE      County IN ('San Diego', 'Santa Barbara') AND Virtual = 'F' GROUP BY      County ORDER BY      Amount DESC LIMIT 1;
SELECT      GSoffered FROM      schools ORDER BY      ABS(Longitude) DESC LIMIT 1;
SELECT COUNT(DISTINCT City) AS num_cities, COUNT(*) AS total_schools FROM schools sch JOIN frpm f ON sch.CDSCode = f.CDSCode WHERE sch.Magnet = 1 AND sch.GSserved = 'K-8' AND f.`NSLP Provision Status` = 'Multiple Provision Types';
SELECT      f.`Percent (%) Eligible Free (K-12)`,      s.District FROM      frpm AS f JOIN      schools AS s ON f.CDSCode = s.CDSCode WHERE      s.AdmFName1 = 'Alusine';
SELECT AdmEmail1  FROM schools  WHERE County='San Bernardino' AND District='San Bernardino City Unified' AND ((SOC='62') OR (DOC='54')) AND OpenDate BETWEEN '2009-01-01' AND '2010-12-31';
SELECT COUNT(*)  FROM account  WHERE frequency = 'POPLATEK PO OBRATU' AND district_id IN (     SELECT district_id      FROM district      WHERE A3 = 'East Bohemia' );
SELECT COUNT(DISTINCT d.district_id) AS num_districts FROM district d JOIN client c ON d.district_id = c.district_id WHERE c.gender = 'F' AND d.A11 > 6000 AND d.A11 < 10000;
SELECT COUNT(*) AS count_male_customers FROM client c JOIN district d ON c.district_id = d.district_id WHERE c.gender = 'M' AND d.A3 = 'North Bohemia' AND d.A11 > 8000;
WITH ranked_clients AS (     SELECT         a.account_id AS Account_Number,         di.A11 AS Average_Salary,         ROW_NUMBER() OVER (ORDER BY c.birth_date ASC, di.A11 ASC) AS rn     FROM client c     JOIN disp d ON c.client_id = d.client_id     JOIN account a ON d.account_id = a.account_id     JOIN district di ON c.district_id = di.district_id     WHERE c.gender = 'F' ), min_max_salaries AS (     SELECT         MIN(Average_Salary) AS Min_Avg_Salary,         MAX(Average_Salary) AS Max_Avg_Salary     FROM ranked_clients ) SELECT     rc.Account_Number,     mms.Max_Avg_Salary - mms.Min_Avg_Salary AS Salary_Gap FROM ranked_clients rc CROSS JOIN min_max_salaries mms WHERE rc.rn = 1 LIMIT 1;
SELECT a.account_id FROM account a JOIN disp d ON a.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE c.birth_date = (     SELECT MAX(c2.birth_date)     FROM client c2 ) AND c.district_id IN (     SELECT district_id     FROM district     ORDER BY A11 DESC     LIMIT 1 );
SELECT acc.* FROM account AS acc JOIN loan AS l ON acc.account_id = l.account_id WHERE STRFTIME('%Y', l.date) = '1997' AND acc.frequency = 'POPLATEK TYDNE' AND l.amount = (     SELECT MIN(l2.amount)     FROM loan AS l2     WHERE STRFTIME('%Y', l2.date) = '1997' );
SELECT l.account_id, MAX(l.amount) AS max_amount FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.duration > 12 AND STRFTIME('%Y', a.date) = '1993' GROUP BY l.account_id ORDER BY max_amount DESC;
SELECT COUNT(DISTINCT c.client_id)  FROM client AS c  JOIN district AS d ON c.district_id = d.district_id  WHERE c.gender = 'F'  AND c.birth_date < '1950-01-01'  AND d.A2 = 'Sokolov';
SELECT d.A2 AS District_Name FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.account_id IN (     SELECT ac.account_id     FROM account ac     JOIN disp dp ON ac.account_id = dp.account_id     JOIN client cl ON dp.client_id = cl.client_id     WHERE cl.gender = 'F' AND cl.birth_date = '1976-01-29' );
SELECT ROUND((SUM(CASE WHEN gender='M' THEN 1 ELSE 0 END) * 100.0 / COUNT(*)), 2) AS male_percentage FROM client c JOIN district d ON c.district_id = d.district_id WHERE d.A3 = 'South Bohemia' ORDER BY CAST(d.A4 AS INT) DESC LIMIT 1;
WITH FirstLoanClient AS (     SELECT l.account_id, c.client_id     FROM loan l     JOIN disp d ON l.account_id = d.account_id     JOIN client c ON d.client_id = c.client_id     WHERE l.date = '1993-07-05' ), BalanceDates AS (     SELECT t.balance, t.date     FROM trans t     JOIN FirstLoanClient f ON t.account_id = f.account_id     WHERE t.date IN ('1993-03-22', '1998-12-27') ) SELECT      CASE          WHEN MIN(CASE WHEN date='1993-03-22' THEN balance END) <> 0 THEN             ((MAX(CASE WHEN date='1998-12-27' THEN balance END) - MIN(CASE WHEN date='1993-03-22' THEN balance END)) /              MIN(CASE WHEN date='1993-03-22' THEN balance END)) * 100         ELSE NULL     END AS increase_rate FROM BalanceDates;
SELECT      ROUND((SUM(CASE WHEN status='A' THEN amount ELSE 0 END)/SUM(amount)) * 100, 2) AS percentage_paid_no_issue FROM loan;
SELECT      ROUND(         (             CAST(SUM(CASE WHEN l.amount < 100000 AND l.status = 'C' THEN 1 ELSE 0 END) AS FLOAT) /             NULLIF(CAST(SUM(CASE WHEN l.amount < 100000 THEN 1 ELSE 0 END) AS FLOAT), 0)         ) * 100,          2     ) AS percentage_running_no_issue  FROM loan l;
SELECT d.A2 AS district,         ((d.A13 - d.A12) / d.A12) * 100 AS unemployment_increment_rate_percentage FROM loan l JOIN account a ON l.account_id = a.account_id JOIN disp dp ON a.account_id = dp.account_id JOIN client c ON dp.client_id = c.client_id JOIN district d ON c.district_id = d.district_id WHERE l.status = 'D';
SELECT d.A2 AS District_Name, COUNT(c.client_id) AS Number_of_Female_Account_Holders FROM district d JOIN client c ON d.district_id = c.district_id WHERE c.gender = 'F' GROUP BY d.A2 ORDER BY Number_of_Female_Account_Holders DESC LIMIT 9;
SELECT COUNT(*) AS total_loans FROM loan l JOIN account a ON l.account_id = a.account_id WHERE l.date BETWEEN '1995-01-01' AND '1997-12-31' AND l.amount >= 250000 AND a.frequency = 'POPLATEK MESICNE';
SELECT d.A2 AS district_name, t.amount FROM trans t JOIN account a ON t.account_id = a.account_id JOIN district d ON a.district_id = d.district_id WHERE t.type = 'VYDAJ' AND t.date LIKE '1996-01%' ORDER BY t.amount DESC LIMIT 10;
SELECT COUNT(DISTINCT l.account_id) FROM loan AS l JOIN account AS a ON l.account_id = a.account_id WHERE l.status IN ('C','D') AND a.district_id = 1;
SELECT COUNT(*) AS num_male_clients FROM client WHERE gender = 'M' AND district_id IN (     SELECT district_id     FROM district     ORDER BY A15 DESC     LIMIT 1 OFFSET 1 );
SELECT DISTINCT d.client_id AS account_holder_identification_number  FROM disp d  JOIN card c ON d.disp_id = c.disp_id  JOIN trans t ON d.account_id = t.account_id  WHERE t.operation = 'VYBER KARTOU'  AND strftime('%Y', t.date) = '1998'  AND t.amount < (     SELECT AVG(amount)      FROM trans      WHERE operation = 'VYBER KARTOU'      AND strftime('%Y', date) = '1998' )
SELECT DISTINCT d.A3 AS District_Region, a.frequency AS Account_Type FROM account a JOIN district d ON a.district_id = d.district_id WHERE a.account_id NOT IN (     SELECT l.account_id     FROM loan l     JOIN disp dp ON l.account_id = dp.account_id AND dp.type = 'OWNER' ) AND d.A11 BETWEEN 8000 AND 9000;
SELECT AVG(d.A15) AS avg_crimes_1995 FROM district d JOIN account a ON d.district_id = a.district_id WHERE d.A15 > 4000 AND STRFTIME('%Y', a.date) >= '1997';
SELECT t.trans_id, t.date, t.amount, t.balance FROM trans AS t JOIN disp ON t.account_id = disp.account_id WHERE disp.client_id = 3356 AND t.operation = 'VYBER';
SELECT ROUND((COUNT(CASE WHEN c.gender='F' THEN 1 END)*100.0)/COUNT(*), 2) AS percentage_female_clients FROM client c JOIN account a ON c.client_id = (     SELECT d.client_id      FROM disp d      WHERE d.account_id=a.account_id AND d.type='OWNER' ) JOIN district d ON c.district_id=d.district_id WHERE d.A11 > 10000;
SELECT ((SUM(CASE WHEN l.date BETWEEN '1997-01-01' AND '1997-12-31' THEN l.amount ELSE 0 END) -          SUM(CASE WHEN l.date BETWEEN '1996-01-01' AND '1996-12-31' THEN l.amount ELSE 0 END)) /         NULLIF(SUM(CASE WHEN l.date BETWEEN '1996-01-01' AND '1996-12-31' THEN l.amount ELSE 0 END), 0)) * 100 AS growth_rate FROM loan l JOIN disp d ON l.account_id = d.account_id JOIN client c ON d.client_id = c.client_id WHERE c.gender = 'M';
SELECT      COUNT(*) AS Frequency_Of_Statements,     t.k_symbol AS Purpose_of_Payment FROM      trans t WHERE      t.account_id = 3 AND      t.amount = 3539 GROUP BY      t.k_symbol;
SELECT ROUND((COUNT(CASE WHEN c.gender='M' THEN 1 ELSE NULL END)*1.0/NULLIF(COUNT(*),0))*100,2) AS percentage_male_clients_weekly_statements  FROM account a  JOIN disp d ON a.account_id=d.account_id  JOIN client c ON d.client_id=c.client_id  WHERE a.frequency='POPLATEK TYDNE';
SELECT DISTINCT account.account_id  FROM account  JOIN disp ON account.account_id = disp.account_id  JOIN client ON disp.client_id = client.client_id  WHERE client.gender = 'F'  AND client.district_id IN (     SELECT district_id      FROM district      ORDER BY A11 ASC      LIMIT 1 )  ORDER BY client.birth_date ASC  LIMIT 1;
SELECT AVG(l.amount) AS avg_loan_amount FROM loan l JOIN trans t ON l.account_id = t.account_id WHERE l.status IN ('C', 'D') AND t.operation = 'POPLATEK PO OBRATU';
SELECT c.client_id,         (strftime('%Y', 'now') - strftime('%Y', c.birth_date)) -        (strftime('%m-%d', 'now') < strftime('%m-%d', c.birth_date)) AS age FROM client c JOIN disp d ON c.client_id = d.client_id AND d.type = 'OWNER' JOIN card ca ON d.disp_id = ca.disp_id AND ca.type = 'gold';
SELECT acc.account_id, dis.A2 AS district_name, dis.A3 AS district_region FROM account acc JOIN district dis ON acc.district_id = dis.district_id WHERE acc.date >= '1993-01-01' AND acc.date <= '1993-12-31' AND acc.frequency = 'POPLATEK PO OBRATU';
SELECT DISTINCT account.account_id, account.frequency FROM account JOIN disp ON account.account_id = disp.account_id JOIN client ON disp.client_id = client.client_id WHERE client.district_id IN (     SELECT district_id      FROM district      WHERE A3 LIKE '%vchodn echy%' ) AND account.date BETWEEN '1995-01-01' AND '2000-12-31' AND disp.type = 'OWNER';
